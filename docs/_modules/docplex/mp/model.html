<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>docplex.mp.model &mdash; DOcplex Preview 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="DOcplex Preview 1.0 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DOcplex Preview 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for docplex.mp.model</h1><div class="highlight"><pre>
<span class="c"># pylint: disable=too-many-lines</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="kn">from</span> <span class="nn">docplex.mp.lp_printer</span> <span class="kn">import</span> <span class="n">LPModelPrinter</span>
<span class="kn">from</span> <span class="nn">docplex.mp.mprinter</span> <span class="kn">import</span> <span class="n">ModelPrettyPrinter</span>
<span class="kn">from</span> <span class="nn">docplex.mp.environment</span> <span class="kn">import</span> <span class="n">get_configured_env</span>
<span class="kn">from</span> <span class="nn">docplex.mp.error_handler</span> <span class="kn">import</span> <span class="n">DefaultErrorHandler</span><span class="p">,</span> <span class="n">InfoLevel</span>
<span class="kn">from</span> <span class="nn">docplex.mp.progress</span> <span class="kn">import</span> <span class="n">ProgressListener</span>
<span class="kn">from</span> <span class="nn">docplex.mp.params.parameter_hierarchy</span> <span class="kn">import</span> <span class="n">root_params_make</span>
<span class="kn">from</span> <span class="nn">docloud.status</span> <span class="kn">import</span> <span class="n">JobSolveStatus</span>
<span class="kn">from</span> <span class="nn">docplex.mp.docloud_engine</span> <span class="kn">import</span> <span class="n">DOcloudEngine</span>

<span class="c"># from docplex.Utils import MyTimer</span>


<span class="kn">from</span> <span class="nn">docplex.mp.linear</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">docplex.mp.utils</span> <span class="kn">import</span> <span class="n">fast_range</span>

<span class="kn">from</span> <span class="nn">docplex.mp.engine_factory</span> <span class="kn">import</span> <span class="n">EngineFactory</span>
<span class="kn">from</span> <span class="nn">docplex.mp.format</span> <span class="kn">import</span> <span class="n">LP_format</span>

<span class="kn">from</span> <span class="nn">docplex.mp.kpi</span> <span class="kn">import</span> <span class="n">DecisionKPI</span>

<span class="kn">from</span> <span class="nn">docplex.mp.params.parameters</span> <span class="kn">import</span> <span class="n">Parameter</span>

<span class="kn">from</span> <span class="nn">docplex.mp.worker.worker_env</span> <span class="kn">import</span> <span class="n">__solve_hook</span> <span class="k">as</span> <span class="n">worker_hook</span>


<span class="k">class</span> <span class="nc">_SolveHook</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c"># INTERNAL</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>  <span class="c"># pragma : no cover</span>

    <span class="k">def</span> <span class="nf">notify_start_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Notifies the start of a solve.</span>

<span class="sd">        Args:</span>
<span class="sd">            attributes: A dictionary of string-&gt;values with various data attributes of the model.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>  <span class="c"># pragma : no cover</span>

    <span class="k">def</span> <span class="nf">notify_end_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">has_solution</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">var_value_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Notifies the end of a solve.</span>

<span class="sd">        Args:</span>
<span class="sd">            has_solution: Boolean, True if solve returned a solution.</span>
<span class="sd">            status: An enumerated value of type JobSolveStatus.</span>
<span class="sd">            obj: The objective value if solved ok, else irrelevant.</span>
<span class="sd">            attributes: A dictionary of variable names to values in the solution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>  <span class="c"># pragma : no cover</span>


<span class="k">class</span> <span class="nc">TraceSolveHook</span><span class="p">(</span><span class="n">_SolveHook</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">notify_start_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributes</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;-&gt; start solve&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">attributes</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;   {0:s} = {1!s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">notify_end_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">has_solution</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">var_value_dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">has_solution</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;&lt;- solve succeeds, status={0}, obj={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">obj</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">vn</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">var_value_dict</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;  - var </span><span class="se">\&quot;</span><span class="s">{0:s}</span><span class="se">\&quot;</span><span class="s"> = {1!s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vn</span><span class="p">,</span> <span class="n">vv</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;&lt;- solve fails, status={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">_ToleranceScheme</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        INTERNAL</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">absolute</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">absolute</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="n">relative</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_absolute_tolerance</span> <span class="o">=</span> <span class="n">absolute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_relative_tolerance</span> <span class="o">=</span> <span class="n">relative</span>

    <span class="k">def</span> <span class="nf">compute_tolerance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">abs_obj</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_absolute_tolerance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relative_tolerance</span> <span class="o">*</span> <span class="n">abs_obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;tolerance(abs=</span><span class="si">%f</span><span class="s">,rel=</span><span class="si">%f</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_absolute_tolerance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relative_tolerance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>  <span class="c"># pragma: no cover</span>


<span class="k">class</span> <span class="nc">_SolveAttribute</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c"># A generic descriptor class for engine solve attributes (e.g. dual values, reduced costs).</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">is_for_vars</span><span class="p">,</span> <span class="n">requires_solve</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_for_vars</span> <span class="o">=</span> <span class="n">is_for_vars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_requires_solved</span> <span class="o">=</span> <span class="n">requires_solve</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_for_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_for_vars</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires_solved</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_requires_solved</span>


<span class="k">class</span> <span class="nc">_VariableContainer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">key_seq</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vartype</span> <span class="o">=</span> <span class="n">vartype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span> <span class="o">=</span> <span class="n">key_seq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lb</span> <span class="o">=</span> <span class="n">lb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ub</span> <span class="o">=</span> <span class="n">ub</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_namer</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_model</span><span class="p">):</span>
        <span class="n">copied_ctn</span> <span class="o">=</span> <span class="n">_VariableContainer</span><span class="p">(</span><span class="n">target_model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vartype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ub</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_ctn</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vartype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vartype</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nb_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">namer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namer</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lb</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ub</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ub</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Try to extract a name string from a naming function.</span>
<span class="sd">        :return: A string or None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_namer</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">raw_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namer</span>
            <span class="c"># drop opl-style formats</span>
            <span class="n">raw_name</span> <span class="o">=</span> <span class="n">raw_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;({</span><span class="si">%s</span><span class="s">})&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="c"># purge fields</span>
            <span class="n">pos_pct</span> <span class="o">=</span> <span class="n">raw_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;%&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pos_pct</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">raw_name</span><span class="p">[:</span><span class="n">pos_pct</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">raw_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;{&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">raw_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;{&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">raw_name</span><span class="p">[:</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">raw_name</span>

    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim_index</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_keys</span><span class="p">[</span><span class="n">dim_index</span><span class="p">])</span> <span class="k">if</span> <span class="n">dim_index</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_dimensions</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dimension_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dim_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_dimensions</span><span class="p">)]</span>
        <span class="n">dim_string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">&quot;[</span><span class="si">%d</span><span class="s">]&quot;</span> <span class="o">%</span> <span class="n">sz</span> <span class="k">for</span> <span class="n">sz</span> <span class="ow">in</span> <span class="n">dim_sizes</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">dim_string</span>

    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># dvar xxx</span>
        <span class="n">dim_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension_string</span>
        <span class="n">ctname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_namer</span> <span class="ow">or</span> <span class="s">&#39;x&#39;</span>
        <span class="k">return</span> <span class="s">&quot;dvar {0} {1} {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vartype</span><span class="o">.</span><span class="n">short_name</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">dim_string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">_SymbolGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    INTERNAL class</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Initialize the counter and the pattern.</span>
<span class="sd">            Fixes the pattern by suffixing &#39;%d&#39; if necessary.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pattern</span> <span class="o">=</span> <span class="n">pattern</span>
        <span class="c"># add offset to counter. this is to avoid 0 in names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__offset</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__pattern</span> <span class="o">=</span> <span class="n">pattern</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__pattern</span> <span class="o">=</span> <span class="n">pattern</span> <span class="o">+</span> <span class="s">&#39;</span><span class="si">%d</span><span class="s">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">last_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_index</span>

    <span class="k">def</span> <span class="nf">notify_new_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notifies that a new index has been allocated.</span>
<span class="sd">        :param new_index:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_index</span><span class="p">,</span> <span class="n">new_index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">new_symbol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates and returns a new symbol.</span>
<span class="sd">        Guess a new (yet) unallocated index, then use the pattern.</span>
<span class="sd">        Note that we use the offset of 1 to generate the name so x1 has index 0, x3 has index 2, etc.</span>
<span class="sd">        :return: A symbol string, suposedly not yet allocated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">guessed_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_index</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">coined_symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pattern</span> <span class="o">%</span> <span class="p">(</span><span class="n">guessed_index</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify_new_index</span><span class="p">(</span><span class="n">guessed_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coined_symbol</span>


<div class="viewcode-block" id="ModelStatistics"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.ModelStatistics">[docs]</a><span class="k">class</span> <span class="nc">ModelStatistics</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;ModelStatistics()</span>

<span class="sd">    This class gathers statistics from the model.</span>

<span class="sd">    Instances of this class are returned by method &#39;get_statistics()&#39; on a Model.</span>

<span class="sd">    The class contains counters on the various types of variables and constraints</span>
<span class="sd">    in the model.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_binary_variables</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_integer_variables</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_continuous_variables</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_le_constraints</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_ge_constraints</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_eq_constraints</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_range_constraints</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_indicator_constraints</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">equal_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ModelStatistics</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_binary_variables</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">number_of_binary_variables</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_integer_variables</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">number_of_integer_variables</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_continuous_variables</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">number_of_continuous_variables</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_linear_constraints</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">number_of_linear_constraints</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_le_constraints</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">number_of_le_constraints</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_eq_constraints</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">number_of_eq_constraints</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_ge_constraints</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">number_of_ge_constraints</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_range_constraints</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">number_of_range_constraints</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_indicator_constraints</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">_number_of_indicator_constraints</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="c"># ok all counts are ok.</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">equal_stats</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_make_new_stats</span><span class="p">(</span><span class="n">mdl</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">ModelStatistics</span><span class="p">()</span>
        <span class="n">vartype_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">dv</span><span class="o">.</span><span class="n">vartype</span> <span class="k">for</span> <span class="n">dv</span> <span class="ow">in</span> <span class="n">mdl</span><span class="o">.</span><span class="n">iter_variables</span><span class="p">())</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">_number_of_binary_variables</span> <span class="o">=</span> <span class="n">vartype_count</span><span class="p">[</span><span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">]</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">_number_of_integer_variables</span> <span class="o">=</span> <span class="n">vartype_count</span><span class="p">[</span><span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">]</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">_number_of_continuous_variables</span> <span class="o">=</span> <span class="n">vartype_count</span><span class="p">[</span><span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">]</span>

        <span class="n">linct_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">type</span> <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="n">mdl</span><span class="o">.</span><span class="n">iter_binary_constraints</span><span class="p">())</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">_number_of_le_constraints</span> <span class="o">=</span> <span class="n">linct_count</span><span class="p">[</span><span class="n">LinearConstraintType</span><span class="o">.</span><span class="n">LE</span><span class="p">]</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">_number_of_eq_constraints</span> <span class="o">=</span> <span class="n">linct_count</span><span class="p">[</span><span class="n">LinearConstraintType</span><span class="o">.</span><span class="n">EQ</span><span class="p">]</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">_number_of_ge_constraints</span> <span class="o">=</span> <span class="n">linct_count</span><span class="p">[</span><span class="n">LinearConstraintType</span><span class="o">.</span><span class="n">GE</span><span class="p">]</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">_number_of_range_constraints</span> <span class="o">=</span> <span class="n">mdl</span><span class="o">.</span><span class="n">number_of_range_constraints</span>
        <span class="n">stats</span><span class="o">.</span><span class="n">_number_of_indicator_constraints</span> <span class="o">=</span> <span class="n">mdl</span><span class="o">.</span><span class="n">number_of_indicator_constraints</span>
        <span class="k">return</span> <span class="n">stats</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of variables in the model.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_binary_variables</span> <span class="o">+</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_integer_variables</span> <span class="o">+</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_continuous_variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_binary_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of bianry variables in the model.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_binary_variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_integer_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of integer variables in the model.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_integer_variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_continuous_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of continuous variables in the model.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_continuous_variables</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_linear_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of linear constraints in the model.</span>

<span class="sd">        This number comprises all relational constraints: &lt;=, == and &gt;=</span>
<span class="sd">        and also range constraints.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_eq_constraints</span> <span class="o">+</span>\
               <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_le_constraints</span> <span class="o">+</span>\
               <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_ge_constraints</span> <span class="o">+</span>\
               <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_range_constraints</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_le_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of &lt;= constraints</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_le_constraints</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_eq_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of == constraints</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_eq_constraints</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_ge_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of &gt;= constraints</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_ge_constraints</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_range_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of range constraints.</span>

<span class="sd">        Range constraints are of the form L &lt;= expression &lt;= U</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`docplex.mp.linear.RangeConstraint`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_range_constraints</span>

<div class="viewcode-block" id="ModelStatistics.number_of_indicator_constraints"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.ModelStatistics.number_of_indicator_constraints">[docs]</a>    <span class="k">def</span> <span class="nf">number_of_indicator_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of indicator constraints.</span>


<span class="sd">        See Also:</span>
<span class="sd">            :class:`docplex.mp.linear.IndicatorConstraint`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_indicator_constraints</span>
</div>
<div class="viewcode-block" id="ModelStatistics.print_information"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.ModelStatistics.print_information">[docs]</a>    <span class="k">def</span> <span class="nf">print_information</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Prints model statistics in readable format.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot; - number of variables: </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_variables</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;   - binary={0}, integer={1}, continuous={2}&quot;</span><span class="o">.</span>
              <span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_binary_variables</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">number_of_integer_variables</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">number_of_continuous_variables</span>
                     <span class="p">))</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot; - number of constraints: </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_linear_constraints</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot; -   LE={0}, EQ={1}, GE={2}, RNG={3}&quot;</span>
              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_number_of_le_constraints</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_eq_constraints</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_ge_constraints</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_range_constraints</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_indicator_constraints</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot; - number of indicator constraints: </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_indicator_constraints</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;docplex.mp.Model.ModelStatistics()&quot;</span>


<span class="c"># noinspection PyProtectedMember</span></div>
<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This is the main class to embed modeling objects.</span>

<span class="sd">    The Model class acts as a factory to create optimization objects,</span>
<span class="sd">    variables, and constraints.</span>
<span class="sd">    It provides various accessors and iterators to the modeling objects.</span>
<span class="sd">    It also manages solving operations and solution management.</span>


<span class="sd">    Args:</span>
<span class="sd">        name (str): The name of the model.</span>
<span class="sd">        output_level: An instance of enum InfoLevel; default is INFO.</span>
<span class="sd">        docloud_context: An instance of DOcloudContext to provide credentials for solving on DOcloud.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        parameters: Contains the list of CPLEX parameters with their current values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">binary_vartype</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">integer_vartype</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">continuous_vartype</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">environment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># for a closed model with no CPLEX, numpy, etc return ClosedEnvironment</span>
        <span class="c"># return get_no_graphics_env()</span>
        <span class="c"># from docplex.environment import ClosedEnvironment</span>
        <span class="c"># return ClosedEnvironment</span>
        <span class="k">return</span> <span class="n">get_configured_env</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_make_key_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span>
        <span class="c"># INTERNAL Takes as input a candidate keys input and returns a valid key sequence</span>
        <span class="k">if</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">has_len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">keys</span>
            <span class="k">elif</span> <span class="n">is_iterator</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># TODO: make a test for this case.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Cannot handle iterable var keys: {0!s} : no len() and not an iterator&quot;</span><span class="p">,</span>
                           <span class="n">keys</span><span class="p">)</span>  <span class="c"># pragma : no cover</span>

        <span class="k">elif</span> <span class="n">is_int</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="ow">and</span> <span class="n">keys</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Unexpected var keys: {0!s}, expecting either iterable or integer&quot;</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>

    <span class="c"># ---- type checking</span>

    <span class="k">def</span> <span class="nf">typecheck_iterable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="c"># INTERNAL: checks for an iterable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="s">&quot;Expecting iterable, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="c"># safe checks.</span>
    <span class="k">def</span> <span class="nf">typecheck_valid_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="n">ModelingObject</span><span class="o">.</span><span class="n">is_valid_index</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="s">&quot;Not an index: {0!s}&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">typecheck_vartype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="c"># INTERNAL: check for a valid vartype</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">,</span> <span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">}:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Not a variable type: {0!s}, expecting VarType.Binary,Integer,Continuous&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">typecheck_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="c"># INTERNAL: check for Var instance</span>
        <span class="n">checked_is_var</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Var</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">checked_is_var</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Expecting decision variable, got: {0!s} type: {1!s}&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">typecheck_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Expr</span><span class="p">),</span> <span class="s">&quot;Expected expression, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">typecheck_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">ct_subtype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">checked_type</span> <span class="o">=</span> <span class="n">ct_subtype</span> <span class="ow">or</span> <span class="n">AbstractConstraint</span>
        <span class="n">checked</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">checked_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="n">checked</span><span class="p">,</span> <span class="s">&quot;Expecting constraint of type: {0!s}, got: {1!s} with type: {2!s}&quot;</span><span class="p">,</span>
                                    <span class="n">checked_type</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">typecheck_zero_or_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">arg</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;expecting 0 or 1, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">typecheck_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="n">is_int</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="s">&quot;Expecting integer, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">typecheck_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">caller</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">caller</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="n">is_number</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="s">&quot;{0}: Expecting number, got: {1!s}&quot;</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="n">is_number</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="s">&quot;Expecting number, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="c"># --- other checks</span>
    <span class="k">def</span> <span class="nf">_check_in_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mobj</span><span class="p">,</span> <span class="n">typename</span><span class="p">):</span>
        <span class="c"># produces message of the type: &quot;constraint ... does not belong to model</span>
        <span class="k">if</span> <span class="n">mobj</span><span class="o">.</span><span class="n">model</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;{0} does not belong to model {1}: {2!s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">typename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">mobj</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">unsupported_operator_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_arg</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">right_arg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Unsupported operation {0!s} {1!s} {2!s}, only &lt;=, ==, &gt;= are allowed&quot;</span><span class="p">,</span> <span class="n">left_arg</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">right_arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_cplex_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">self_env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span>
        <span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">self_env</span><span class="o">.</span><span class="n">has_cplex</span><span class="p">:</span>
            <span class="n">env_cplex_version</span> <span class="o">=</span> <span class="n">self_env</span><span class="o">.</span><span class="n">cplex_version</span>
            <span class="k">assert</span> <span class="n">env_cplex_version</span>
            <span class="k">if</span> <span class="n">env_cplex_version</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">cplex_version</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s">&quot;CPLEX DLL has revision: {0}, older than parameter version: {1}. Parameters are disabled.&quot;</span><span class="p">,</span>
                        <span class="n">env_cplex_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">cplex_version</span><span class="p">)</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="n">ok</span>

    <span class="k">def</span> <span class="nf">round_nearest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">return</span> <span class="n">round_nearest_towards_infinity</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">infinity</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;docplex_model&#39;</span><span class="p">,</span>
                 <span class="n">output_level</span><span class="o">=</span><span class="n">InfoLevel</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                 <span class="n">solver_code</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">,</span>
                 <span class="n">docloud_context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;__init__(name=&#39;docplex_model&#39;, output_level=InfoLevel.INFO, docloud_context=None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__solver_code</span> <span class="o">=</span> <span class="n">solver_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span> <span class="o">=</span> <span class="n">DefaultErrorHandler</span><span class="p">(</span><span class="n">output_level</span><span class="p">)</span>

        <span class="c"># automatic name patterns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_varname_pattern</span> <span class="o">=</span> <span class="s">&quot;_x&quot;</span>
        <span class="c"># noinspection PyPep8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_ctname_pattern</span> <span class="o">=</span> <span class="s">&quot;_c&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_indname_pattern</span> <span class="o">=</span> <span class="s">&quot;_ic&quot;</span>

        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allvarctns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__single_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allvars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_name</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_index</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_name</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_index</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kpis_by_name</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_progress_listeners</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solve_hooks</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># debugSolveHook()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__mip_start</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># -- float formats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_float_precision</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_var_format_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">:</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">,</span>
                                <span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">:</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span><span class="p">,</span>
                                <span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">:</span> <span class="s">&quot;</span><span class="si">%.4f</span><span class="s">&quot;</span><span class="p">}</span>

        <span class="c"># -- scopes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_var_scope</span> <span class="o">=</span> <span class="n">_SymbolGenerator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automatic_var_name_pattern</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ct_scope</span> <span class="o">=</span> <span class="n">_SymbolGenerator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automatic_ct_name_pattern</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_scope</span> <span class="o">=</span> <span class="n">_SymbolGenerator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">automatic_indicator_name_pattern</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_var_scope</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ct_scope</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_scope</span><span class="p">]</span>

        <span class="c"># init engine</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_new_engine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver_code</span><span class="p">,</span> <span class="n">docloud_context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span> <span class="o">=</span> <span class="n">engine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_docloud_context</span> <span class="o">=</span> <span class="n">docloud_context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span> <span class="o">=</span> <span class="n">ModelFactory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solve_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__solution</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># all the following must be placed after an engine has been set.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_objective_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_expr</span><span class="p">(</span><span class="n">constant</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__objective_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_objective_expr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__objective_sense</span> <span class="o">=</span> <span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">default_sense</span><span class="p">()</span>

        <span class="c"># this flag controls the column-wise formatting of text exports.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_format_export</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c"># parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">root_params_make</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">self_cplex_parameters_version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">cplex_version</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">has_cplex</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">cplex_version</span> <span class="o">&gt;</span> <span class="n">self_cplex_parameters_version</span><span class="p">:</span>
                <span class="c"># cplex is more recent than parameters. must update defaults.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s">&quot;* reset parameter defaults, cplex version is: {0}&quot;</span>  <span class="c"># pragma : no cover</span>
                           <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">self_cplex_parameters_version</span><span class="p">))</span>  <span class="c"># pragma : no cover</span>
                <span class="n">nb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">resync_defaults</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">nb</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s">&quot;#parameter defaults have been reset: </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">nb</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">infinity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the numerical value used as upper bound of continuous variables.</span>

<span class="sd">        Note</span>
<span class="sd">            CPLEX usually sets this limit to 1e+20.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">getInfinity</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="k">def</span> <span class="nf">_set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_check_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">new_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;model.name requires a valid string, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">new_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;model.name requires a non-empty string, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">new_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Model name contains whitespaces: |{0:s}|&quot;</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_name</span><span class="p">,</span> <span class="n">_set_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_format_export</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This property is used to enable or disable the formatting of</span>
<span class="sd">        the exported LP model.</span>
<span class="sd">        By formatting, we mean the limitation to 80 columns of the generated LP.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_export</span>

    <span class="k">def</span> <span class="nf">_set_format_export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_format</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_format_export</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">do_format</span><span class="p">)</span>

    <span class="n">format_export</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_format_export</span><span class="p">,</span> <span class="n">_set_format_export</span><span class="p">)</span>

    <span class="c"># you can change the way variables are named by default, just define a string here.</span>
    <span class="k">def</span> <span class="nf">get_automatic_var_name_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_varname_pattern</span>

    <span class="k">def</span> <span class="nf">set_automatic_var_name_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">varname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_varname_pattern</span> <span class="o">=</span> <span class="n">varname</span>

    <span class="n">automatic_var_name_pattern</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_automatic_var_name_pattern</span><span class="p">,</span> <span class="n">set_automatic_var_name_pattern</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_automatic_ct_name_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_ctname_pattern</span>

    <span class="k">def</span> <span class="nf">set_automatic_ct_name_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_ctname_pattern</span> <span class="o">=</span> <span class="n">ctname</span>

    <span class="n">automatic_ct_name_pattern</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_automatic_ct_name_pattern</span><span class="p">,</span> <span class="n">set_automatic_ct_name_pattern</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_automatic_indicator_name_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_indname_pattern</span>

    <span class="k">def</span> <span class="nf">set_automatic_indicator_name_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_automatic_indname_pattern</span> <span class="o">=</span> <span class="n">indname</span>

    <span class="n">automatic_indicator_name_pattern</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_automatic_indicator_name_pattern</span><span class="p">,</span>
                                                <span class="n">set_automatic_indicator_name_pattern</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_automatic_varname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_scope</span><span class="o">.</span><span class="n">new_symbol</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_create_automatic_ctname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
        <span class="c"># need to find the proper scope: linct or indicators</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_ct_scope</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span><span class="o">.</span><span class="n">new_symbol</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_float_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_float_precision</span>

    <span class="k">def</span> <span class="nf">set_float_precision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_digits</span><span class="p">):</span>
        <span class="n">used_digits</span> <span class="o">=</span> <span class="n">nb_digits</span>
        <span class="k">if</span> <span class="n">nb_digits</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Negative float precision given: {0}, using 0 instead&quot;</span><span class="p">,</span> <span class="n">nb_digits</span><span class="p">)</span>
            <span class="n">used_digits</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_digits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">max_nb_digits</span>
            <span class="n">bitness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">bitness</span>
            <span class="k">if</span> <span class="n">nb_digits</span> <span class="o">&gt;</span> <span class="n">max_digits</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Given precision of {0:d} goes beyond {1:d}-bit capability, using maximum: {2:d}&quot;</span><span class="o">.</span>
                             <span class="n">format</span><span class="p">(</span><span class="n">nb_digits</span><span class="p">,</span> <span class="n">bitness</span><span class="p">,</span> <span class="n">max_digits</span><span class="p">))</span>
                <span class="n">used_digits</span> <span class="o">=</span> <span class="n">max_digits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_float_precision</span> <span class="o">=</span> <span class="n">used_digits</span>
        <span class="c"># recompute float format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_var_format_map</span><span class="p">[</span><span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%%</span><span class="s">.</span><span class="si">%d</span><span class="s">f&quot;</span> <span class="o">%</span> <span class="n">nb_digits</span>

    <span class="n">float_precision</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_float_precision</span><span class="p">,</span> <span class="n">set_float_precision</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">time_limit_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  Returns the time limit parameter.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">timelimit</span>

<div class="viewcode-block" id="Model.get_time_limit"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.get_time_limit">[docs]</a>    <span class="k">def</span> <span class="nf">get_time_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the time limit for the model.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_limit_parameter</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Model.set_time_limit"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.set_time_limit">[docs]</a>    <span class="k">def</span> <span class="nf">set_time_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_limit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a time limit for solve operations.</span>

<span class="sd">        Time limit must be a positive number.</span>

<span class="sd">        Args:</span>
<span class="sd">            time_limit: The new time limit.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_num</span><span class="p">(</span><span class="n">time_limit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_limit</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Negative time limit: {0}&quot;</span><span class="p">,</span> <span class="n">time_limit</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">time_limit</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Time limit too small: {0} - using 1 instead&quot;</span><span class="p">,</span> <span class="n">time_limit</span><span class="p">)</span>
            <span class="n">time_limit</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_limit_parameter</span><span class="p">,</span> <span class="n">time_limit</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.remove_time_limit"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.remove_time_limit">[docs]</a>    <span class="k">def</span> <span class="nf">remove_time_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  Removes the time limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_parameter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_limit_parameter</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">continuous_var_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_var_format_map</span><span class="p">[</span><span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solver_code</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__solver_code</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">error_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">docloud_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the DOcloud context attached to the model, possibly None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_docloud_context</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the current solution of the model.</span>

<span class="sd">        Returns None if the model has not yet been solved or if the last solved has failed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__solution</span>

    <span class="k">def</span> <span class="nf">_get_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__solution</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mip_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the MIP start solution attached to the model.</span>

<span class="sd">        Returns None if no MIP start was defined.</span>

<span class="sd">        :return: An instance of SolveSolution if a MIP start has been defined, else None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mip_start</span>

    <span class="k">def</span> <span class="nf">fatal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_output_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="o">.</span><span class="n">outputLevel</span>

    <span class="k">def</span> <span class="nf">set_output_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_output_level</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__error_handler</span><span class="o">.</span><span class="n">set_output_level</span><span class="p">(</span><span class="n">new_output_level</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_quiet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">set_quiet</span><span class="p">()</span>

    <span class="n">output_level</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_output_level</span><span class="p">,</span> <span class="n">set_output_level</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_trace_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace_mode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">set_trace_mode</span><span class="p">(</span><span class="n">trace_mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">notify_trace_mode</span><span class="p">(</span><span class="n">trace_mode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">enable_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_trace_mode</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">disable_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_trace_mode</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_trace_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">is_trace_enabled</span><span class="p">()</span>

<div class="viewcode-block" id="Model.clear"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clears the model of all modeling objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_internal</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_clear_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allvars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allvarctns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__single_vars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_name</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_name</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kpis_by_name</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>  <span class="c"># kpis must be ordered</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solve_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_solve_status</span> <span class="o">=</span> <span class="n">JobSolveStatus</span><span class="o">.</span><span class="n">UNKNOWN</span>  <span class="c"># initial status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__solution</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__mip_start</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_scopes</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_clear_scopes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">a_scope</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scopes</span><span class="p">:</span>
            <span class="n">a_scope</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_make_new_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solver_code</span><span class="p">,</span> <span class="n">docloud_context</span><span class="p">):</span>
        <span class="n">new_engine</span> <span class="o">=</span> <span class="n">EngineFactory</span><span class="o">.</span><span class="n">new_engine</span><span class="p">(</span><span class="n">solver_code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">docloud_context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_engine</span>

    <span class="k">def</span> <span class="nf">_set_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span> <span class="o">=</span> <span class="n">e2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">update_engine</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_clear_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">restart</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="n">old_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span>
        <span class="k">if</span> <span class="n">old_engine</span><span class="p">:</span>
            <span class="c"># dispose of old engine.</span>
            <span class="n">old_engine</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
            <span class="c"># from Ryan InstanceCounter</span>
            <span class="k">del</span> <span class="n">old_engine</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">restart</span><span class="p">:</span>
            <span class="n">new_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_new_engine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver_code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_docloud_context</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_engine</span><span class="p">(</span><span class="n">new_engine</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL for testing</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span>

    <span class="k">def</span> <span class="nf">ensure_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># defined for compatibility with AbstractModel</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="Model.print_information"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.print_information">[docs]</a>    <span class="k">def</span> <span class="nf">print_information</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Prints general informational statistics on the model.</span>

<span class="sd">        Prints the number of variables and their breakdown by type.</span>
<span class="sd">        Prints the number of constraints and their breakdown by type.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">prints_info</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Model: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span><span class="o">.</span><span class="n">print_information</span><span class="p">()</span>

            <span class="n">self_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span>
            <span class="k">if</span> <span class="n">self_params</span><span class="o">.</span><span class="n">has_nondefaults</span><span class="p">():</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot; - parameters:&quot;</span><span class="p">)</span>
                <span class="n">self_params</span><span class="o">.</span><span class="n">print_information</span><span class="p">(</span><span class="n">indent_level</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c"># 3 for &quot; - &quot; + 2 = 5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot; - parameters: defaults&quot;</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_constraints</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_variables</span>

    <span class="c"># @profile</span>
    <span class="k">def</span> <span class="nf">__notify_new_model_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descr</span><span class="p">,</span> <span class="n">mobj</span><span class="p">,</span> <span class="n">mindex</span><span class="p">,</span>
                                  <span class="n">name_dir</span><span class="p">,</span> <span class="n">idx_dir</span><span class="p">,</span>
                                  <span class="n">is_name_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notifies the return af an object being create on the engine.</span>
<span class="sd">        :param descr: A string describing the type of the object being created (e.g. Constraint, Variable).</span>
<span class="sd">        :param mobj:  The newly created modeling object.</span>
<span class="sd">        :param mindex: The index as returned by the engine.</span>
<span class="sd">        :param name_dir: The directory of objects by name (e.g. name -&gt; constraitn directory).</span>
<span class="sd">        :param idx_dir:  The directory from idices to objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mobj</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">mindex</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">mobj_name</span> <span class="o">=</span> <span class="n">mobj</span><span class="o">.</span><span class="n">_get_name</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">mobj_name</span><span class="p">:</span>
                <span class="c"># in some cases, names are checked before register</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_name_safe</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">mobj_name</span> <span class="ow">in</span> <span class="n">name_dir</span><span class="p">:</span>
                        <span class="n">old_name_value</span> <span class="o">=</span> <span class="n">name_dir</span><span class="p">[</span><span class="n">mobj_name</span><span class="p">]</span>
                        <span class="c"># Duplicate constraint name: foo</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Duplicate {0} name: {1} already used for {2!s}&quot;</span><span class="p">,</span> <span class="n">descr</span><span class="p">,</span> <span class="n">mobj_name</span><span class="p">,</span> <span class="n">old_name_value</span><span class="p">)</span>

                <span class="n">name_dir</span><span class="p">[</span><span class="n">mobj_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mobj</span>

        <span class="c"># store in idx dir if any</span>
        <span class="k">if</span> <span class="n">idx_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># do not use if idx_dir because an empty dir is False</span>
            <span class="n">idx_dir</span><span class="p">[</span><span class="n">mindex</span><span class="p">]</span> <span class="o">=</span> <span class="n">mobj</span>

    <span class="k">def</span> <span class="nf">_register_one_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_index</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__notify_new_var</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">var_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_var_scope</span><span class="o">.</span><span class="n">notify_new_index</span><span class="p">(</span><span class="n">var_index</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allvars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

    <span class="c"># @profile</span>
    <span class="k">def</span> <span class="nf">_register_block_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allvars</span><span class="p">,</span> <span class="n">indices</span><span class="p">):</span>
        <span class="c"># with MyTimer(&quot;register_vars&quot;, verbose=True) as t:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fast_range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">allvars</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__notify_new_var</span><span class="p">(</span><span class="n">allvars</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="c"># increment global sequence container</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allvars</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">allvars</span><span class="p">)</span>
        <span class="n">max_var_index</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c"># max index is last index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_var_scope</span><span class="o">.</span><span class="n">notify_new_index</span><span class="p">(</span><span class="n">max_var_index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__notify_new_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_index</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__notify_new_model_object</span><span class="p">(</span><span class="s">&quot;variable&quot;</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">var_index</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_ct_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indicator_scope</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">IndicatorConstraint</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ct_scope</span>

    <span class="k">def</span> <span class="nf">_register_one_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ct_index</span><span class="p">,</span> <span class="n">is_ctname_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        INTERNAL</span>
<span class="sd">        :param ct: The new constraint to register.</span>
<span class="sd">        :param ct_index: The index as returned by the engine.</span>
<span class="sd">        :param is_ctname_safe: True if ct name has been checked for duplicates already.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_ct_scope</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span><span class="o">.</span><span class="n">notify_new_index</span><span class="p">(</span><span class="n">ct_index</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__notify_new_model_object</span><span class="p">(</span>
            <span class="s">&quot;constraint&quot;</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ct_index</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_index</span><span class="p">,</span>
            <span class="n">is_name_safe</span><span class="o">=</span><span class="n">is_ctname_safe</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_register_block_cts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cts</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">safe_names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">nb_cts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cts</span><span class="p">)</span>
        <span class="n">max_ct_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">fast_range</span><span class="p">(</span><span class="n">nb_cts</span><span class="p">):</span>
            <span class="n">ct_idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__notify_new_model_object</span><span class="p">(</span><span class="s">&quot;constraint&quot;</span><span class="p">,</span> <span class="n">cts</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">ct_idx</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_index</span><span class="p">,</span>
                                           <span class="n">is_name_safe</span><span class="o">=</span><span class="n">safe_names</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ct_idx</span> <span class="o">&gt;</span> <span class="n">max_ct_index</span><span class="p">:</span>
                <span class="n">max_ct_index</span> <span class="o">=</span> <span class="n">ct_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ct_scope</span><span class="o">.</span><span class="n">notify_new_index</span><span class="p">(</span><span class="n">max_ct_index</span><span class="p">)</span>
        <span class="c"># extend container faster than append()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cts</span><span class="p">)</span>

    <span class="c"># iterators</span>
    <span class="k">def</span> <span class="nf">iter_var_containers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__allvarctns</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_iter_single_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__single_vars</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_var_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctn</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allvarctns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctn</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_count_variables_with_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">):</span>
        <span class="n">type_filter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">dv</span><span class="p">:</span> <span class="n">dv</span><span class="o">.</span><span class="n">has_type</span><span class="p">(</span><span class="n">vartype</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">type_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__allvars</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">iter_variables_with_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">has_type</span><span class="p">(</span><span class="n">vartype</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of decision variables, all types combined.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__allvars</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_binary_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of binary variables added to the model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_variables_with_type</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_integer_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of integer variables added to the model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_variables_with_type</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_continuous_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of continuous variables added to the model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_variables_with_type</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_integer_or_binary_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">dv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">dv</span><span class="o">.</span><span class="n">is_discrete</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

<div class="viewcode-block" id="Model.get_statistics"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.get_statistics">[docs]</a>    <span class="k">def</span> <span class="nf">get_statistics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns statistics on the model.</span>

<span class="sd">        Returns a new instance of ModelStatistics.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`ModelStatistics`,</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ModelStatistics</span><span class="o">.</span><span class="n">_make_new_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.iter_variables"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.iter_variables">[docs]</a>    <span class="k">def</span> <span class="nf">iter_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Iterates over all the variables in the model.</span>

<span class="sd">        Returns the variables in the order they were added to the model,</span>
<span class="sd">        regardless of their type.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__allvars</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.iter_binary_vars"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.iter_binary_vars">[docs]</a>    <span class="k">def</span> <span class="nf">iter_binary_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Iterates over all binary variables in the model.</span>

<span class="sd">        Returns the variables in the order they were added to the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables_with_type</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.iter_integer_vars"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.iter_integer_vars">[docs]</a>    <span class="k">def</span> <span class="nf">iter_integer_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Iterates over all integer variables in the model.</span>

<span class="sd">        Returns the variables in the order they were added to the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables_with_type</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.iter_continuous_vars"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.iter_continuous_vars">[docs]</a>    <span class="k">def</span> <span class="nf">iter_continuous_vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Iterates over all continuous variables in the model.</span>

<span class="sd">        Returns the variables in the order they were added to the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables_with_type</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.get_var_by_name"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.get_var_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_var_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Looks a for a variable from a name.</span>

<span class="sd">        Returns either a variable if it finds one with exactly this name, or None.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the variable we are looking for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A variable (instance of Var) or None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_name</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="c"># @staticmethod</span>
    <span class="c"># def _build_name_dict(mobj_seq):</span>
    <span class="c"># &quot;&quot;&quot;</span>
    <span class="c"># INTERNAL: builds a dictionary of names to objects, given a sequence</span>
    <span class="c"># Objects with no name (that is name is None) are omitted</span>
    <span class="c">#     :param mobj_seq: the sequence of objects (assumed to have a &quot;name&quot; attribute</span>
    <span class="c">#     :return: a dicitonary of names to objects</span>
    <span class="c">#     &quot;&quot;&quot;</span>
    <span class="c">#     return {mobj.name: mobj for mobj in mobj_seq if mobj.name is not None}</span>

    <span class="c"># index management</span></div>
    <span class="k">def</span> <span class="nf">_build_index_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mobj_seq</span><span class="p">,</span> <span class="n">raise_on_invalid_index</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lazily creates a dict from indices to objects (variable or constraints)</span>
<span class="sd">        :param mobj_seq:</span>
<span class="sd">        :param raise_on_invalid_index:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">mobj</span> <span class="ow">in</span> <span class="n">mobj_seq</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mobj</span><span class="o">.</span><span class="n">has_valid_index</span><span class="p">():</span>
                <span class="n">idx_dict</span><span class="p">[</span><span class="n">mobj</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">mobj</span>
            <span class="k">elif</span> <span class="n">raise_on_invalid_index</span><span class="p">:</span>  <span class="c"># pragma : no cover</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Object has invalid index: {0!s}&quot;</span><span class="p">,</span> <span class="n">mobj</span><span class="p">)</span>  <span class="c"># pragma : no cover</span>
        <span class="k">return</span> <span class="n">idx_dict</span>

    <span class="k">def</span> <span class="nf">get_var_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_valid_index</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_index</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_index_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__allvars</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__vars_by_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_var_ub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">new_ub</span><span class="p">):</span>
        <span class="c"># INTERNAL: use var.ub property to set ub</span>
        <span class="k">if</span> <span class="n">new_ub</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_num</span><span class="p">(</span><span class="n">new_ub</span><span class="p">,</span> <span class="s">&quot;set_var_ub&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_ub</span> <span class="o">!=</span> <span class="n">var</span><span class="o">.</span><span class="n">ub</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">set_var_attribute</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s">&quot;ub&quot;</span><span class="p">,</span> <span class="n">new_ub</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">_internal_set_ub</span><span class="p">(</span><span class="n">new_ub</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_var_lb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">new_lb</span><span class="p">):</span>
        <span class="c"># INTERNAL: use var.lb to set lb</span>
        <span class="k">if</span> <span class="n">new_lb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_num</span><span class="p">(</span><span class="n">new_lb</span><span class="p">,</span> <span class="s">&quot;set_var_ub&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_lb</span> <span class="o">!=</span> <span class="n">var</span><span class="o">.</span><span class="n">lb</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">set_var_attribute</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s">&quot;lb&quot;</span><span class="p">,</span> <span class="n">new_lb</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">_internal_set_lb</span><span class="p">(</span><span class="n">new_lb</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_var_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">new_vartype</span><span class="p">):</span>
        <span class="c"># DOES NOT WORK: CPLEX does not allow this..</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_vartype</span><span class="p">(</span><span class="n">new_vartype</span><span class="p">):</span>  <span class="c"># and new_vartype != var.vartype:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">setVarType</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">new_vartype</span><span class="p">)</span>
            <span class="n">d</span><span class="o">.</span><span class="n">_internal_set_type</span><span class="p">(</span><span class="n">new_vartype</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_var_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvar</span><span class="p">,</span> <span class="n">new_arg_name</span><span class="p">):</span>
        <span class="c"># INTERNAL: use var.name to set variable names</span>
        <span class="n">new_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_arg_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Not a valid name: {0!s}&quot;</span><span class="p">,</span> <span class="n">new_arg_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">new_name</span> <span class="o">!=</span> <span class="n">dvar</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">set_var_attribute</span><span class="p">(</span><span class="n">dvar</span><span class="p">,</span> <span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
            <span class="n">ModelingObjectBase</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">dvar</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_typecheck_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">candidate_bounds</span><span class="p">):</span>
        <span class="n">check_ok</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="n">is_number</span><span class="p">(</span><span class="n">candidate_bounds</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">candidate_bounds</span><span class="p">):</span>
            <span class="n">check_ok</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">check_ok</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">is_number</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">candidate_bounds</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">check_ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Model.{0}: expecting either number or number_sequence as bounds, got: {1!s}&quot;</span><span class="p">,</span>
                       <span class="n">header</span><span class="p">,</span> <span class="n">candidate_bounds</span><span class="p">)</span>

<div class="viewcode-block" id="Model.set_var_lbs"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.set_var_lbs">[docs]</a>    <span class="k">def</span> <span class="nf">set_var_lbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">changed_vars</span><span class="p">,</span> <span class="n">new_lbs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Change lower bounds of a collection of variables.</span>

<span class="sd">        new_lbs accepts either a single number (all lower bouds are set to this number)</span>
<span class="sd">        or an array of numbers. With an array, variables are set the corresponding bound in the array.</span>
<span class="sd">        If the bounds array is smaller than the variable array, the remaining variables are unchanged.</span>


<span class="sd">        Args:</span>
<span class="sd">            changed_vars: The collection of variables to be changed</span>
<span class="sd">            new_lbs: Either a number or a collection of numbers.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_iterable</span><span class="p">(</span><span class="n">changed_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_typecheck_bounds</span><span class="p">(</span><span class="s">&quot;set_var_lbs&quot;</span><span class="p">,</span> <span class="n">new_lbs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">new_lbs</span><span class="p">):</span>
            <span class="n">engine_new_lbs</span> <span class="o">=</span> <span class="n">new_lbs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">engine_new_lbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_lbs</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">changed_vars</span><span class="p">)</span>
        <span class="n">actual_lbs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">set_var_attribute</span><span class="p">(</span><span class="n">changed_vars</span><span class="p">,</span> <span class="s">&quot;lb&quot;</span><span class="p">,</span> <span class="n">engine_new_lbs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">new_lb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">changed_vars</span><span class="p">,</span> <span class="n">actual_lbs</span><span class="p">):</span>
            <span class="n">var</span><span class="o">.</span><span class="n">_internal_set_lb</span><span class="p">(</span><span class="n">new_lb</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.set_var_ubs"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.set_var_ubs">[docs]</a>    <span class="k">def</span> <span class="nf">set_var_ubs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">changed_vars</span><span class="p">,</span> <span class="n">new_ubs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Change upper bounds of a collection of variables.</span>

<span class="sd">        new_ubs accepts either a single number (all upper bouds are set to this number)</span>
<span class="sd">        or an array of numbers. With an array, variables are set the corresponding bound in the array.</span>
<span class="sd">        If the bounds array is smaller than the variable array, the remaining variable bounds are unchanged.</span>

<span class="sd">        Args:</span>
<span class="sd">            changed_vars: The collection of variables to be changed.</span>
<span class="sd">            new_ubs: Either a number or a collection of numbers.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_iterable</span><span class="p">(</span><span class="n">changed_vars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_typecheck_bounds</span><span class="p">(</span><span class="s">&quot;set_var_ubs&quot;</span><span class="p">,</span> <span class="n">new_ubs</span><span class="p">)</span>

        <span class="n">new_lbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">new_ubs</span><span class="p">]</span> <span class="k">if</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">new_ubs</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">new_ubs</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">changed_vars</span><span class="p">)</span>
        <span class="n">actual_ubs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">set_var_attribute</span><span class="p">(</span><span class="n">changed_vars</span><span class="p">,</span> <span class="s">&quot;ub&quot;</span><span class="p">,</span> <span class="n">new_lbs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">new_ub</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">changed_vars</span><span class="p">,</span> <span class="n">actual_ubs</span><span class="p">):</span>
            <span class="n">var</span><span class="o">.</span><span class="n">_internal_set_ub</span><span class="p">(</span><span class="n">new_ub</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.get_constraint_by_name"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.get_constraint_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_constraint_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Looks a for a constraint from a name.</span>

<span class="sd">        Returns either a constraint if it finds a constraint with exactly this name, or None</span>
<span class="sd">        if no constraint has this name.</span>

<span class="sd">        Will not raise an exception if not found</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the constraint we are looking for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A constraint or None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_name</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">get_constraint_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_valid_index</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_index</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_index_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of constraints that were added to the model.</span>

<span class="sd">        The number includes linear constraints, range constraints, and indicator constraints.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span><span class="p">)</span>

<div class="viewcode-block" id="Model.iter_constraints"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.iter_constraints">[docs]</a>    <span class="k">def</span> <span class="nf">iter_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return an iterator over all constraints in the model.</span>

<span class="sd">        The iterator iterates over all constraints (linear, ranges, indicators).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_count_constraints_with_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cttype</span><span class="p">):</span>
        <span class="n">type_filter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ct</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">cttype</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="n">type_filter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">gen_constraints_with_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cttype</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">cttype</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">ct</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_range_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of range constraints added to the model.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_constraints_with_type</span><span class="p">(</span><span class="n">RangeConstraint</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_linear_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the total number of linear constraints added to the model.</span>

<span class="sd">        This counts binary linear constraints (&lt;=, &gt;=, or ==) and</span>
<span class="sd">        range constraints.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :func:`number_of_range_constraints`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_constraints_with_type</span><span class="p">(</span><span class="n">AbstractLinearConstraint</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">iter_range_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_constraints_with_type</span><span class="p">(</span><span class="n">RangeConstraint</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">iter_binary_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_constraints_with_type</span><span class="p">(</span><span class="n">BinaryLinearConstraint</span><span class="p">)</span>

<div class="viewcode-block" id="Model.iter_linear_constraints"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.iter_linear_constraints">[docs]</a>    <span class="k">def</span> <span class="nf">iter_linear_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an iterator on the linear constraints of the model.</span>
<span class="sd">        This includes binary linear constraints and ranges, but not indicators.</span>

<span class="sd">        :return: An iterator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_constraints_with_type</span><span class="p">(</span><span class="n">AbstractLinearConstraint</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.iter_indicator_constraints"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.iter_indicator_constraints">[docs]</a>    <span class="k">def</span> <span class="nf">iter_indicator_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns an iterator on idicator constraints in the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_constraints_with_type</span><span class="p">(</span><span class="n">IndicatorConstraint</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_indicator_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of indicator constraints in the model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count_constraints_with_type</span><span class="p">(</span><span class="n">IndicatorConstraint</span><span class="p">)</span>

<div class="viewcode-block" id="Model.var"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.var">[docs]</a>    <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a decision variable and stores it in the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            vartype: The type of the decision variable;</span>
<span class="sd">                this can take three values: Binary, Integer or Continuous.</span>

<span class="sd">            lb: The lower bound of the variable; either a number or None, to use the default.</span>
<span class="sd">                 The default lower bound for all three variable types is zero.</span>

<span class="sd">            ub: The upper bound of the variable domain; expectes either a number or None to use the type&#39;s default.</span>
<span class="sd">                The default upper bound for Binary is 1, otherwise positive infinity.</span>

<span class="sd">            name: An optional string to name the variable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The newly created decision variable, an instance of Var.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`docplex.mp.linear.Var`,</span>
<span class="sd">            :func:`infinity`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_vartype</span><span class="p">(</span><span class="n">vartype</span><span class="p">)</span>
        <span class="n">new_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">vartype</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__single_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_var</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_var</span>
</div>
    <span class="k">def</span> <span class="nf">_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="n">new_var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">vartype</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__single_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_var</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_var</span>

<div class="viewcode-block" id="Model.continuous_var"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.continuous_var">[docs]</a>    <span class="k">def</span> <span class="nf">continuous_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a new continuous decision variable and stores it in the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            lb: The lower bound of the variable, or None. The default is 0.</span>
<span class="sd">            ub: The upper bound of the variable, or None, to use the default. The default is model infinity.</span>
<span class="sd">            name: An optional name for the variable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of the Var class with type VarType.Continuous.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.integer_var"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.integer_var">[docs]</a>    <span class="k">def</span> <span class="nf">integer_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a new integer variable and stores it in the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            lb: The lower bound of the variable, or None. The default is 0.</span>
<span class="sd">            ub: The upper bound of the variable, or None, to use the default. The default is model infinity.</span>
<span class="sd">            name: An optional name for the variable</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of the Var class with type VarType.Integer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.binary_var"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.binary_var">[docs]</a>    <span class="k">def</span> <span class="nf">binary_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a new binary variable and stores it in the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:An optional name for the variable.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of the Var class with type VarType.Binary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">var_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_vartype</span><span class="p">(</span><span class="n">vartype</span><span class="p">)</span>
        <span class="n">fixed_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_key_seq</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
        <span class="n">ctn</span> <span class="o">=</span> <span class="n">_VariableContainer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="p">[</span><span class="n">fixed_keys</span><span class="p">],</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_var_container</span><span class="p">(</span><span class="n">ctn</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">var_list</span><span class="p">(</span><span class="n">fixed_keys</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">key_format</span><span class="p">)</span>

<div class="viewcode-block" id="Model.binary_var_list"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.binary_var_list">[docs]</a>    <span class="k">def</span> <span class="nf">binary_var_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;binary_var_list(self, keys, name=str, key_format=None)</span>

<span class="sd">        Create a list of binary decision variables.</span>

<span class="sd">        Create a list of binary variables and store them in the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys: Either a sequence of objects or an integer.</span>
<span class="sd">            name: Used to name variables. Accepts either a string or</span>
<span class="sd">                a function. If given a string, the variable name is formed by appending the string</span>
<span class="sd">                to the string representation of the key object (if keys is a sequence) or the</span>
<span class="sd">                index of the variable within the range, if an integer argument is passed.</span>
<span class="sd">            key_format: A format string or None. This format string describes how keys contribute to variable names.</span>
<span class="sd">                        The default is &quot;_%s&quot;. For example if name is &quot;x&quot; and each key object is represented by a string</span>
<span class="sd">                        like &quot;k1&quot;, k2&quot;, ... then variables will be named &quot;x_k1&quot;, &quot;x_k2&quot;,...</span>
<span class="sd">                        </span>
<span class="sd">        Example:</span>
<span class="sd">            If you want each key string to be surrounded by {}, use a special key_format: &quot;_{%s}&quot;,</span>
<span class="sd">            the %s denotes where the key string will be formatted and appended to &quot;name&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of Var objects with type VarType.Binary.</span>

<span class="sd">        Example:</span>
<span class="sd">            mdl.binary_var_list(3, &quot;z&quot;) returns a list of size 3</span>
<span class="sd">            containing three binary variables with name z_0, z_1, z_2.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_list</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="n">key_format</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.integer_var_list"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.integer_var_list">[docs]</a>    <span class="k">def</span> <span class="nf">integer_var_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;integer_var_list(self, keys, lb=None, ub=None, name=str, key_format=None)</span>

<span class="sd">        Create a list of integer decision variables.</span>

<span class="sd">        Create a list of variables with type VarType.Integer and store them in the model,</span>
<span class="sd">        and return the list.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys: Either a sequence of objects or a positive integer. If passed an integer,</span>
<span class="sd">                it is interpreted as the number of variables to create.</span>
<span class="sd">            lb: Lower bounds of the variables. Accepts either a float number,</span>
<span class="sd">                a function (which will be called on each key argument) or None.</span>
<span class="sd">            ub: Upper bounds of the variables.  Accepts either a float number,</span>
<span class="sd">                a function (which will  be called on each key argument), or None.</span>
<span class="sd">            name: Used to name variables. Accepts either a string or</span>
<span class="sd">                a function. If given a string, the variable name is formed by appending the string</span>
<span class="sd">                to the string representation of the key object (if keys is a sequence) or the</span>
<span class="sd">                index of the variable within the range, if an integer argument is passed.</span>
<span class="sd">            key_format: A format string or None. This format string describes how keys contribute to variable names.</span>
<span class="sd">                The default is &quot;_%s&quot;. For example if name is &quot;x&quot; and each key object is represented by a string</span>
<span class="sd">                like &quot;k1&quot;, k2&quot;, ... then variables will be named &quot;x_k1&quot;, &quot;x_k2&quot;,...</span>

<span class="sd">        Note:</span>
<span class="sd">            Using None as the lower bound means the default lower bound (0) is used.</span>
<span class="sd">            Using None as the upper bound means the default upper bound (the model&#39;s positive infinity)</span>
<span class="sd">            is used.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of Var objects with type VarType.Integer.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_list</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">key_format</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.continuous_var_list"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.continuous_var_list">[docs]</a>    <span class="k">def</span> <span class="nf">continuous_var_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;continuous_var_list(self, keys, lb=None, ub=None, name=str, key_format=None)</span>

<span class="sd">        Creates a list of continuous decision variables.</span>

<span class="sd">        Create a list of variables with type VarType.Integer, store them in the model,</span>
<span class="sd">        and return the list.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys: Either a sequence of objects or a positive integer. If passed an integer,</span>
<span class="sd">                it is interpreted as the number of variables to create.</span>

<span class="sd">            lb: Lower bounds of the variables. Accepts either a float number,</span>
<span class="sd">                a function,  or None. Use a number if all variables share the same lower bound,</span>
<span class="sd">                or use a function if lower bounds vary depending on the key, in which case,</span>
<span class="sd">                the function will be called on each key in keys.</span>
<span class="sd">                None means using the default lower bound (0) is used.</span>

<span class="sd">            ub: Upper bounds of the variables. Accepts either a float number,</span>
<span class="sd">                a function  or None. Use a number if all variables share the same upper bound,</span>
<span class="sd">                or use a function if upper bounds vary depending on the key, in which case,</span>
<span class="sd">                the function will be called on each key in keys.</span>
<span class="sd">                None means using the default upper bound (model infinity) is used.</span>

<span class="sd">            name: Used to name variables. Accepts either a string or</span>
<span class="sd">                a function. If given a string, the variable name is formed by appending the string</span>
<span class="sd">                to the string representation of the key object (if keys is a sequence) or the</span>
<span class="sd">                index of the variable within the range, if an integer argument is passed.</span>
<span class="sd">                If passed a function, this function is called on each key object to generate a name.</span>
<span class="sd">                The default behavior is to call str() on each key object.</span>

<span class="sd">            key_format: A format string or None. This format string describes how keys contribute to variable names.</span>
<span class="sd">                        The default is &quot;_%s&quot;. For example if name is &quot;x&quot; and each key object is represented by a string</span>
<span class="sd">                        like &quot;k1&quot;, k2&quot;, ... then variables will be named &quot;x_k1&quot;, &quot;x_k2&quot;,...</span>
<span class="sd">        Note:</span>
<span class="sd">            When keys is either an empty list or the integer 0, an empty list is returned.</span>


<span class="sd">        Returns:</span>
<span class="sd">            A list of Var objects with type VarType.Continuous.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`docplex.mp.linear.Var`,</span>
<span class="sd">            :func:`infinity`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_list</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">key_format</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.continuous_var_dict"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.continuous_var_dict">[docs]</a>    <span class="k">def</span> <span class="nf">continuous_var_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;continuous_var_dict(self, keys, lb=None, ub=None, name=str, key_format=None)</span>

<span class="sd">        Create a dictionary of continuous variables, indexed by key objects.</span>

<span class="sd">        Create a dictionary that allows retrieval of variables from business</span>
<span class="sd">        model objects. Keys can be either a Python collection, an iterator, or a generator.</span>

<span class="sd">        A key can be any Python object, with the exception of None.</span>
<span class="sd">        Keys are used in the naming of variables.</span>

<span class="sd">        Note:</span>
<span class="sd">            If keys is empty, this method returns an empty dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys: Either a sequence of objects, an iterator, or a positive integer. If passed an integer,</span>
<span class="sd">                it is interpreted as the number of variables to create.</span>
<span class="sd">            lb: Lower bounds of the variables. Accepts either a float number,</span>
<span class="sd">                a function,  or None. Use a number if all variables share the same lower bound,</span>
<span class="sd">                or use a function if lower bounds vary depending on the key, in which case,</span>
<span class="sd">                the function will be called on each key in keys.</span>
<span class="sd">                None means using the default lower bound (0) is used.</span>
<span class="sd">            ub: Upper bounds of the variables. Accepts either a float number,</span>
<span class="sd">                a function,  or None. Use a number if all variables share the same upper bound,</span>
<span class="sd">                or use a function if upper bounds vary depending on the key, in which case,</span>
<span class="sd">                the function will be called on each key in keys.</span>
<span class="sd">                None means using the default upper bound (model infinity) is used.</span>

<span class="sd">            name: Used to name variables. Accepts either a string or</span>
<span class="sd">                a function. If given a string, the variable name is formed by appending the string</span>
<span class="sd">                to the string representation of the key object (if keys is a sequence) or the</span>
<span class="sd">                index of the variable within the range, if an integer argument is passed.</span>
<span class="sd">                If passed a function, this function is called on each key object to generate a name.</span>
<span class="sd">                The default behavior is to call str() on each key object.</span>

<span class="sd">            key_format: A format string or None. This format string describes how keys contribute to variable names.</span>
<span class="sd">                        The default is &quot;_%s&quot;. For example if name is &quot;x&quot; and each key object is represented by a string</span>
<span class="sd">                        like &quot;k1&quot;, k2&quot;, ... then variables will be named &quot;x_k1&quot;, &quot;x_k2&quot;,...</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary of Var objects (with vartype VarType.Continuous) indexed by the objects in keys.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`docplex.mp.linear.Var`,</span>
<span class="sd">            :func:`infinity`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cvars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuous_var_list</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">key_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_var_dict</span><span class="p">(</span><span class="n">keyseq</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span> <span class="n">varseq</span><span class="o">=</span><span class="n">cvars</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.integer_var_dict"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.integer_var_dict">[docs]</a>    <span class="k">def</span> <span class="nf">integer_var_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;integer_var_dict(self, keys, lb=None, ub=None, name=str, key_format=None)</span>

<span class="sd">        Create a dictionary of integer variables, indexed by key objects.</span>

<span class="sd">        Create a dictionary that allows retrieval of variables from business</span>
<span class="sd">        model objects. Keys can be either a Python collection, an iterator, or a generator.</span>

<span class="sd">        A key can be any Python object, with the exception of None.</span>
<span class="sd">        Keys are used in the naming of variables.</span>

<span class="sd">        Note:</span>
<span class="sd">            If keys is empty, this method returns an empty dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys: Either a sequence of objects, an iterator or a positive integer. If passed an integer,</span>
<span class="sd">                it is interpreted as the number of variables to create.</span>

<span class="sd">            lb: Lower bounds of the variables. Accepts either an integer number,</span>
<span class="sd">                a function,  or None. Use a number if all variables share the same lower bound,</span>
<span class="sd">                or use a function if lower bounds vary depending on the key, in which case,</span>
<span class="sd">                the function will be called on each key in keys.</span>
<span class="sd">                None means using the default lower bound (0) is used.</span>

<span class="sd">            ub: Upper bounds of the variables. Accepts either an integer number,</span>
<span class="sd">                a function,  or None. Use a number if all variables share the same upper bound,</span>
<span class="sd">                or use a function if upper bounds vary depending on the key, in which case,</span>
<span class="sd">                the function will be called on each key in keys.</span>
<span class="sd">                None means using the default upper bound (model infinity) is used.</span>

<span class="sd">            name: Used to name variables. Accepts either a string or</span>
<span class="sd">                a function. If given a string, the variable name is formed by appending the string</span>
<span class="sd">                to the string representation of the key object (if keys is a sequence) or the</span>
<span class="sd">                index of the variable within the range, if an integer argument is passed.</span>
<span class="sd">                If passed a function, this function is called on each key object to generate a name.</span>
<span class="sd">                The default behavior is to call str() on each key object.</span>

<span class="sd">            key_format: A format string or None. This format string describes how keys contribute to variable names.</span>
<span class="sd">                        The default is &quot;_%s&quot;. For example if name is &quot;x&quot; and each key object is represented by a string</span>
<span class="sd">                        like &quot;k1&quot;, k2&quot;, ... then variables will be named &quot;x_k1&quot;, &quot;x_k2&quot;,...</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary of Var objects (with vartype VarType.Integer) indexed by the objects in keys.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :func:`infinity`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ivars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">integer_var_list</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="n">key_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_var_dict</span><span class="p">(</span><span class="n">varseq</span><span class="o">=</span><span class="n">ivars</span><span class="p">,</span> <span class="n">keyseq</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.binary_var_dict"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.binary_var_dict">[docs]</a>    <span class="k">def</span> <span class="nf">binary_var_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;binary_var_dict(self, keys, name=str, key_format=None)</span>

<span class="sd">        Create a dictionary of binary variables, indexed by key objects.</span>

<span class="sd">        Create a dictionary that allows retrieval of variables from business</span>
<span class="sd">        model objects. Keys can be either a Python collection, an iterator, or a generator.</span>

<span class="sd">        A key can be any Python object, with the exception of None.</span>
<span class="sd">        Keys are used in the naming of variables.</span>

<span class="sd">        Note:</span>
<span class="sd">            if keys is empty, this method returns an empty dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys: Either a sequence of objects, an iterator or a positive integer. If passed an integer,</span>
<span class="sd">                it is interpreted as the number of variables to create.</span>

<span class="sd">            name: Used to name variables. Accepts either a string or</span>
<span class="sd">                a function. If given a string, the variable name is formed by appending the string</span>
<span class="sd">                to the string representation of the key object (if keys is a sequence) or the</span>
<span class="sd">                index of the variable within the range, if an integer argument is passed.</span>

<span class="sd">            key_format: A format string or None. This format string describes how keys contribute to variable names.</span>
<span class="sd">                        The default is &quot;_%s&quot;. For example if name is &quot;x&quot; and each key object is represented by a string</span>
<span class="sd">                        like &quot;k1&quot;, k2&quot;, ... then variables will be named &quot;x_k1&quot;, &quot;x_k2&quot;,...</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary of Var objects (with vartype VarType.Binary) indexed by the objects in keys.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`docplex.mp.linear.Var`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bvars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_var_list</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="n">key_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_var_dict</span><span class="p">(</span><span class="n">varseq</span><span class="o">=</span><span class="n">bvars</span><span class="p">,</span> <span class="n">keyseq</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">var_multidict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">seq_of_key_seqs</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_vartype</span><span class="p">(</span><span class="n">vartype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_iterable</span><span class="p">(</span><span class="n">seq_of_key_seqs</span><span class="p">)</span>
        <span class="n">fixed_keys</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_make_key_seq</span><span class="p">(</span><span class="n">ks</span><span class="p">)</span> <span class="k">for</span> <span class="n">ks</span> <span class="ow">in</span> <span class="n">seq_of_key_seqs</span><span class="p">]</span>

        <span class="n">ctn</span> <span class="o">=</span> <span class="n">_VariableContainer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">fixed_keys</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_var_container</span><span class="p">(</span><span class="n">ctn</span><span class="p">)</span>
        <span class="c"># the sequence of keysets should answer to len(no generators here)</span>
        <span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fixed_keys</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dimension</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;len of key sequence must be &gt;= 1, got: {0}&quot;</span><span class="p">,</span> <span class="n">dimension</span><span class="p">)</span>  <span class="c"># pragma : no cover</span>

        <span class="c"># create cartesian product of keys...</span>
        <span class="n">all_key_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">fixed_keys</span><span class="p">))</span>
        <span class="n">cube_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">var_list</span><span class="p">(</span><span class="n">all_key_tuples</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dimension</span><span class="p">,</span> <span class="n">key_format</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="n">var_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_var_dict</span><span class="p">(</span><span class="n">cube_vars</span><span class="p">,</span> <span class="n">all_key_tuples</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">var_dict</span>

    <span class="k">def</span> <span class="nf">var_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vartype</span><span class="p">,</span> <span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">key_format</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_multidict</span><span class="p">(</span><span class="n">vartype</span><span class="p">,</span> <span class="p">[</span><span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">],</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">key_format</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">binary_var_dict2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="c"># INTERNAL, OBSOLETE, use binary_var_matrix</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary_var_matrix</span><span class="p">(</span><span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="Model.binary_var_matrix"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.binary_var_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">binary_var_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;binary_var_matrix(self, keys1, keys2, name=str)</span>

<span class="sd">        Create a dictionary of binary variables, indexed by pairs of key objects.</span>

<span class="sd">        Create a dictionary that allows retrieval of variables from  a tuple</span>
<span class="sd">        of two keys, the first one from keys1, the second one from keys2.</span>
<span class="sd">        In short, variables are indexed by the Cartesian product of the two key sets.</span>

<span class="sd">        A key can be any Python object, with the exception of None.</span>
<span class="sd">        Keys are used in the naming of variables.</span>

<span class="sd">        Note:</span>
<span class="sd">            If any of keys1 or keys2 is empty, this method returns an empty dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys1: Either a sequence of objects, an iterator, or a positive integer. If passed an integer N,</span>
<span class="sd">                    it is interpreted as a range from 0 to N-1.</span>

<span class="sd">            keys2: Same as keys1.</span>

<span class="sd">            name: Used to name variables. Accepts either a string or</span>
<span class="sd">                a function. If given a string, the variable name is formed by appending the string</span>
<span class="sd">                to the string representation of the key object (if keys is a sequence) or the</span>
<span class="sd">                index of the variable within the range, if an integer argument is passed.</span>

<span class="sd">            key_format: A format string or None. This format string describes how keys contribute to variable names.</span>
<span class="sd">                        The default is &quot;_%s&quot;. For example if name is &quot;x&quot; and each key object is represented by a string</span>
<span class="sd">                        like &quot;k1&quot;, k2&quot;, ... then variables will be named &quot;x_k1&quot;, &quot;x_k2&quot;,...</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary of Var objects (with vartype VarType.Binary) indexed by all couples (k1, k2)</span>
<span class="sd">            with k1 in keys1 and k2 in keys2</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`docplex.mp.linear.Var`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_multidict</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">,</span> <span class="p">[</span><span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.integer_var_matrix"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.integer_var_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">integer_var_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;integer_var_matrix(self, keys1, keys2, lb=None, ub=None, name=str)</span>

<span class="sd">        Create a dictionary of integer variables, indexed by pairs of key objects.</span>

<span class="sd">        Create a dictionary that allows retrieval of variables from  a tuple</span>
<span class="sd">        of two keys, the first one from keys1, the second one from keys2.</span>
<span class="sd">        In short, variables are indexed by the Cartesian product of the two key sets.</span>

<span class="sd">        A key can be any Python object, with the exception of None.</span>

<span class="sd">        Arguments lb, ub and name are interpreted exactly as in Model.integer_var_dict()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_multidict</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="p">[</span><span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">],</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.continuous_var_matrix"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.continuous_var_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">continuous_var_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;continuous_var_matrix(self, keys1, keys2, lb=None, ub=None, name=str)</span>

<span class="sd">        Create a dictionary of continuous variables, indexed by pairs of key objects.</span>

<span class="sd">        Create a dictionary that allows retrieval of variables from a tuple</span>
<span class="sd">        of two keys, the first one from keys1, the second one from keys2.</span>
<span class="sd">        In short, variables are indexed by the Cartesian product of the two key sets.</span>

<span class="sd">        A key can be any Python object, with the exception of None.</span>

<span class="sd">        Arguments lb, ub and name are interpreted exactly as in Model.continuous_var_dict()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_multidict</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">,</span> <span class="p">[</span><span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">],</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.continuous_var_cube"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.continuous_var_cube">[docs]</a>    <span class="k">def</span> <span class="nf">continuous_var_cube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">keys3</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;continuous_var_cube(self, keys1, keys2, keys3, lb=None, ub=None, name=str)</span>

<span class="sd">        Creates a dictionay of continuous variables, indexed by triplets.</span>

<span class="sd">        Same as continuous_var_matrix, except that variables are indexed by triplets of</span>
<span class="sd">        the form (k1, k2, k3) with k1 in keys, k2 in keys2, k3 in keys3.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :func:`continuous_var_matrix`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_multidict</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Continuous</span><span class="p">,</span> <span class="p">[</span><span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">keys3</span><span class="p">],</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">integer_var_cube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">keys3</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_multidict</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="p">[</span><span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">keys3</span><span class="p">],</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">binary_var_cube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">keys3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_multidict</span><span class="p">(</span><span class="n">VarType</span><span class="o">.</span><span class="n">Binary</span><span class="p">,</span> <span class="p">[</span><span class="n">keys1</span><span class="p">,</span> <span class="n">keys2</span><span class="p">,</span> <span class="n">keys3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="c"># noinspection PyMethodMayBeStatic</span>
    <span class="k">def</span> <span class="nf">_make_var_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">varseq</span><span class="p">,</span> <span class="n">keyseq</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_iterable</span><span class="p">(</span><span class="n">varseq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_iterable</span><span class="p">(</span><span class="n">keyseq</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keyseq</span><span class="p">,</span> <span class="n">varseq</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_zero_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">zero_expr</span>

    <span class="k">def</span> <span class="nf">linear_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">linear_expr</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">constant</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">monomial_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvar</span><span class="p">,</span> <span class="n">coef</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_var</span><span class="p">(</span><span class="n">dvar</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monomial_expr</span><span class="p">(</span><span class="n">dvar</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_monomial_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvar</span><span class="p">,</span> <span class="n">coef</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MonomialExpr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvar</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="c"># NOT DOCUMENTED for now</span>
        <span class="kn">from</span> <span class="nn">docplex.mp.functional</span> <span class="kn">import</span> <span class="n">AbsExpr</span>

        <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_linear_expr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">AbsExpr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>

    <span class="n">_all_zeros</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">_to_linear_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">LinearExpr</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">e</span>
        <span class="c"># elif e in self._all_zeros:</span>
        <span class="c">#     return self._get_zero_expr()  # pco only</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">to_linear_expr</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="c"># build a linear_expr</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear_expr</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<div class="viewcode-block" id="Model.scal_prod"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.scal_prod">[docs]</a>    <span class="k">def</span> <span class="nf">scal_prod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvars</span><span class="p">,</span> <span class="n">coefs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a linear expression, equal to the scalar product of a list of variables and a sequence of coefficients.</span>

<span class="sd">        This method allows different types of input for both arguments. The variable sequence can be either a list</span>
<span class="sd">        or an iterator of objects that can be converted to linear expressions, that is, variables, expressions, or numbers.</span>
<span class="sd">        The most usual case is variables.</span>
<span class="sd">        The coefficients can be either a list of numbers, an iterator over numbers, or even a plain number.</span>
<span class="sd">        In this last case the scalar product reduces to a sum times this coefficient.</span>


<span class="sd">        :param dvars: A list or an iterator to variables or expressions.</span>
<span class="sd">        :param coefs: A list or an iterator on numbers, or even a number.</span>

<span class="sd">        Note: </span>
<span class="sd">           If either list or iterator is empty, this method returns zero.</span>

<span class="sd">        :return: A linear expression or 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">scal_prod</span><span class="p">(</span><span class="n">dvars</span><span class="p">,</span> <span class="n">coefs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.sum"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.sum">[docs]</a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a linear expression summing over a sequence.</span>


<span class="sd">        Note: This method returns 0 if the argument is an empty list or iterator.</span>
<span class="sd">        </span>
<span class="sd">        :param args: A list of objects that can be converted to linear expressions, that is, linear expressions, decision variables, or numbers.</span>

<span class="sd">        :return: A linear expression or 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">ge_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">ge_constraint</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">le_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">le_constraint</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">eq_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">eq_constraint</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_post_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="n">eng</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">BinaryLinearConstraint</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">eng</span><span class="o">.</span><span class="n">createBinaryLinearConstraint</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">RangeConstraint</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">eng</span><span class="o">.</span><span class="n">createRangeConstraint</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">IndicatorConstraint</span><span class="p">):</span>
            <span class="c"># here check whether linear ct is trivial. if yes do not send to CPLEX</span>
            <span class="n">indicator</span> <span class="o">=</span> <span class="n">ct</span>
            <span class="n">linct</span> <span class="o">=</span> <span class="n">indicator</span><span class="o">.</span><span class="n">linear_constraint</span>
            <span class="k">if</span> <span class="n">linct</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">():</span>
                <span class="n">is_feasible</span> <span class="o">=</span> <span class="n">linct</span><span class="o">.</span><span class="n">_is_trivially_feasible</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Indicator constraint {0!s} has a trivially feasible constraint (no effect)&quot;</span><span class="p">,</span>
                                 <span class="n">indicator</span><span class="p">)</span>
                    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s">&quot;indicator constraint {0!s} has a trivially infeasible constraint; variable invalidated&quot;</span><span class="p">,</span>
                        <span class="n">indicator</span><span class="p">)</span>
                    <span class="n">indicator</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
                    <span class="k">return</span> <span class="o">-</span><span class="mi">4</span>
            <span class="k">return</span> <span class="n">eng</span><span class="o">.</span><span class="n">createIndicatorConstraint</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Expecting binary constraint, indicator or range, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>  <span class="c"># pragma : no cover</span>

    <span class="k">def</span> <span class="nf">_notify_trivial_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ct</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="n">ctname</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ctname</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">):</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">ctname</span>
        <span class="k">elif</span> <span class="n">ct</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ct</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">):</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="n">ct_typename</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">short_typename</span><span class="p">()</span> <span class="k">if</span> <span class="n">ct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;constraint&quot;</span>
        <span class="n">ct_rank</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_constraints</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Adding trivial feasible {2}: {0!s}, rank: {1}&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">ct_rank</span><span class="p">,</span> <span class="n">ct_typename</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Adding trivially infeasible {2}: {0!s}, rank: {1}&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">ct_rank</span><span class="p">,</span> <span class="n">ct_typename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Adding trivial feasible {1}, rank: {0}&quot;</span><span class="p">,</span> <span class="n">ct_rank</span><span class="p">,</span> <span class="n">ct_typename</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ct</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Adding trivially infeasible {1}, rank: {0}&quot;</span><span class="p">,</span> <span class="n">ct_rank</span><span class="p">,</span> <span class="n">ct_typename</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Adding trivially infeasible {1}, rank: {0}&quot;</span><span class="p">,</span> <span class="n">ct_rank</span><span class="p">,</span> <span class="n">ct_typename</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_prepare_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">do_check</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">if</span> <span class="n">ct</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># sum([]) == 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_notify_trivial_constraint</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="n">ct</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="c"># happens with sum([]) and constant e.g. sum([]) == 2</span>
            <span class="n">ct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">new_trivial_infeasible_ct</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_notify_trivial_constraint</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ctname</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Adding a trivially infeasible constraint with name: {0}&quot;</span><span class="p">,</span> <span class="n">ctname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># analogous to 0 == 1, model is sure to fail</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Adding trivially infeasible constraint&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
            <span class="c"># -- watch for trivial cts e.g. linexpr(0) &lt;= linexpr(1)</span>
            <span class="k">if</span> <span class="n">ct</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ct</span><span class="o">.</span><span class="n">_is_trivially_feasible</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_notify_trivial_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">ct</span><span class="o">.</span><span class="n">_is_trivially_infeasible</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_notify_trivial_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c"># is this necessary if we&#39;re sure where we are sure of the calling context??</span>
        <span class="k">if</span> <span class="n">do_check</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ct</span><span class="o">.</span><span class="n">is_in_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Constraint {0!s} does not belong to model {1}&quot;</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c"># --- name management ---</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ctname</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ct</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">ct</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_automatic_ctname</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
                <span class="n">ct</span><span class="o">.</span><span class="n">notify_automatic_name</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">ctname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Duplicate constraint name: {0!s}, used for: {1}&quot;</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">get_constraint_by_name</span><span class="p">(</span><span class="n">ctname</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># might be an issue if both ctname and ct.name exist</span>
            <span class="n">ct</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">ctname</span>

        <span class="k">assert</span> <span class="n">ct</span><span class="o">.</span><span class="n">has_name</span><span class="p">()</span>
        <span class="c"># ---</span>
        <span class="c"># at this stage we are sure the ctname is valid whatsoever.</span>
        <span class="k">if</span> <span class="n">do_check</span> <span class="ow">and</span> <span class="n">ct</span><span class="o">.</span><span class="n">has_valid_index</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;constraint has already been posted: {0!s}, index is: {1}&quot;</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="c"># pragma : no cover</span>
            <span class="k">return</span> <span class="bp">False</span>  <span class="c"># pragma : no cover</span>
        <span class="k">return</span> <span class="bp">True</span>


    <span class="c"># @profile</span>
    <span class="k">def</span> <span class="nf">_add_constraint_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">do_check</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ct</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># sum([]) == 0</span>
            <span class="n">ct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">new_trivial_feasible_ct</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_notify_trivial_constraint</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ct</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="c"># happens with sum([]) and constant e.g. sum([]) == 2</span>
            <span class="n">ct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">new_trivial_infeasible_ct</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_notify_trivial_constraint</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ctname</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Adding a trivially infeasible constraint with name: {0}&quot;</span><span class="p">,</span> <span class="n">ctname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># analogous to 0 == 1, model is sure to fail</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Adding trivially infeasible constraint&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
            <span class="c"># -- watch for trivial cts e.g. linexpr(0) &lt;= linexpr(1)</span>
            <span class="k">if</span> <span class="n">ct</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ct</span><span class="o">.</span><span class="n">_is_trivially_feasible</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_notify_trivial_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">ct</span><span class="o">.</span><span class="n">_is_trivially_infeasible</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_notify_trivial_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">is_feasible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c"># is this necessary if we&#39;re sure where we are sure of the calling context??</span>
        <span class="k">if</span> <span class="n">do_check</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ct</span><span class="o">.</span><span class="n">is_in_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Constraint {0!s} does not belong to model {1}&quot;</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c"># --- name management ---</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ctname</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ct</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">ct</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_automatic_ctname</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
                <span class="n">ct</span><span class="o">.</span><span class="n">notify_automatic_name</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">ctname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Duplicate constraint name: {0!s}, used for: {1}&quot;</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">get_constraint_by_name</span><span class="p">(</span><span class="n">ctname</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># might be an issue if both ctname and ct.name exist</span>
            <span class="n">ct</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">ctname</span>

        <span class="k">assert</span> <span class="n">ct</span><span class="o">.</span><span class="n">has_name</span><span class="p">()</span>
        <span class="c"># ---</span>
        <span class="c"># at this stage we are sure the ctname is valid whatsoever.</span>
        <span class="k">if</span> <span class="n">do_check</span> <span class="ow">and</span> <span class="n">ct</span><span class="o">.</span><span class="n">has_valid_index</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;constraint has already been posted: {0!s}, index is: {1}&quot;</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="c"># pragma : no cover</span>
            <span class="k">return</span> <span class="n">ct</span><span class="o">.</span><span class="n">index</span>  <span class="c"># pragma : no cover</span>

        <span class="n">ct_engine_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_one_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">ct_engine_index</span><span class="p">,</span> <span class="n">is_ctname_safe</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ct</span>

    <span class="k">def</span> <span class="nf">_remove_constraint_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        No typechecking for this internal version.</span>
<span class="sd">        :param ct:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ct_name</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">name</span>
        <span class="n">ct_index</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">unchecked_index</span>
        <span class="c"># remove from engine.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">remove_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="c"># remove from model.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__allcts</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ct_name</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_name</span><span class="p">[</span><span class="n">ct_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cts_by_index</span><span class="p">[</span><span class="n">ct_index</span><span class="p">]</span>
        <span class="n">ct</span><span class="o">.</span><span class="n">notify_deleted</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ModelingObject</span><span class="o">.</span><span class="n">is_valid_index</span><span class="p">(</span><span class="n">ct_index</span><span class="p">):</span>
            <span class="c"># resync indices from doomed up</span>
            <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_linear_constraints</span><span class="p">():</span>
                <span class="n">old_model_index</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">unchecked_index</span>
                <span class="k">if</span> <span class="n">old_model_index</span> <span class="o">&gt;</span> <span class="n">ct_index</span><span class="p">:</span>
                    <span class="n">updated_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">get_ct_index</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">updated_index</span> <span class="o">!=</span> <span class="n">old_model_index</span><span class="p">:</span>
                        <span class="n">ct</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">updated_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_constraint_indices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_linear_constraints</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_resolve_ct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct_arg</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">silent</span>
        <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
            <span class="n">printed_context</span> <span class="o">=</span> <span class="n">context</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">printed_context</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ct_arg</span><span class="p">,</span> <span class="n">AbstractConstraint</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ct_arg</span>
        <span class="k">elif</span> <span class="n">is_string</span><span class="p">(</span><span class="n">ct_arg</span><span class="p">):</span>
            <span class="n">ct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_constraint_by_name</span><span class="p">(</span><span class="n">ct_arg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ct</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;{0}no constraint with name: </span><span class="se">\&quot;</span><span class="s">{1}</span><span class="se">\&quot;</span><span class="s"> - ignored&quot;</span><span class="p">,</span> <span class="n">printed_context</span><span class="p">,</span> <span class="n">ct_arg</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ct</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;{0}unexpected argument {1!s}, expecting string or constraint&quot;</span><span class="p">,</span> <span class="n">printed_context</span><span class="p">,</span> <span class="n">ct_arg</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>

<div class="viewcode-block" id="Model.remove_constraint"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.remove_constraint">[docs]</a>    <span class="k">def</span> <span class="nf">remove_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct_arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Removes a constraint from the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            ct_arg: The constraint to remove. Accepts either a constraint object or a string.</span>
<span class="sd">                If passed a string, looks for a constraint with that name.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_ct</span><span class="p">(</span><span class="n">ct_arg</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s">&quot;remove_constraint&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ct</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_in_model</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="s">&quot;constraint&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_remove_constraint_internal</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.add_range"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.add_range">[docs]</a>    <span class="k">def</span> <span class="nf">add_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">rng_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds a new range constraint to the model.</span>

<span class="sd">        A range constraint states that a linear</span>
<span class="sd">        expression has to stay within an interval [lb..ub].</span>
<span class="sd">        Both lb and ub have to be float numbers with lb smaller than ub.</span>
<span class="sd">        Raises an exception if lb is greater than ub.</span>

<span class="sd">        The method creates a new range constraint and adds it to the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            lb: A float number.</span>
<span class="sd">            expr: A linear expression, e.g. X+Y+Z.</span>
<span class="sd">            ub: A float number, which should be greater than lb.</span>
<span class="sd">            rng_name: An optional name for the range constraint.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`docplex.mp.linear.RangeConstraint`</span>

<span class="sd">        Returns:</span>
<span class="sd">            The newly created range constraint, an instance of RangeConstraint.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">range_constraint</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">rng_name</span><span class="p">)</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_internal</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">rng_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ct</span>
</div>
<div class="viewcode-block" id="Model.add_indicator"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.add_indicator">[docs]</a>    <span class="k">def</span> <span class="nf">add_indicator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary_var</span><span class="p">,</span> <span class="n">linear_ct</span><span class="p">,</span> <span class="n">active_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds a new indicator constraint to the model.</span>

<span class="sd">        An indicator constraint links (one-way) the value of a binary variable to</span>
<span class="sd">        the satisfaction of a linear constraint.</span>
<span class="sd">        If the binary variable equals the active value then the constraint is satisfied, but</span>
<span class="sd">        otherwise the constraint may or may not be satisfied.</span>

<span class="sd">        :param binary_var: The binary variable used to control the satisfaction of the linear constraint.</span>
<span class="sd">        :param linear_ct: A linear constraint (EQ, LE, GE).</span>
<span class="sd">        :param active_value: 0 or 1. The value used to trigger the satisfaction of the constraint. The default is 1.</span>
<span class="sd">        :param name: An optional name for the indicator constraint.</span>

<span class="sd">        :return: The newly created indicator constraint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># noinspection PyPep8</span>
        <span class="n">indicator_trivial_feasible_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="n">indicator_trivial_infeasible_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_var</span><span class="p">(</span><span class="n">binary_var</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_constraint</span><span class="p">(</span><span class="n">linear_ct</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_zero_or_one</span><span class="p">(</span><span class="n">active_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_in_model</span><span class="p">(</span><span class="n">binary_var</span><span class="p">,</span> <span class="n">typename</span><span class="o">=</span><span class="s">&quot;binary variable&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_in_model</span><span class="p">(</span><span class="n">linear_ct</span><span class="p">,</span> <span class="n">typename</span><span class="o">=</span><span class="s">&quot;linear_constraint&quot;</span><span class="p">)</span>

        <span class="n">indicator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indicator_constraint</span><span class="p">(</span><span class="n">binary_var</span><span class="o">=</span><span class="n">binary_var</span><span class="p">,</span> <span class="n">linear_ct</span><span class="o">=</span><span class="n">linear_ct</span><span class="p">,</span> <span class="n">active_value</span><span class="o">=</span><span class="n">active_value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">linear_ct</span><span class="o">.</span><span class="n">is_trivial</span><span class="p">():</span>
            <span class="n">is_feasible</span> <span class="o">=</span> <span class="n">linear_ct</span><span class="o">.</span><span class="n">_is_trivially_feasible</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">is_feasible</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Indicator constraint {0!s} has a trivial feasible linear constraint (has no effect)&quot;</span><span class="p">,</span>
                             <span class="n">indicator</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">indicator_trivial_feasible_idx</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;indicator constraint {0!s} has a trivial infeasible linear constraint - invalidated&quot;</span><span class="p">,</span>
                             <span class="n">indicator</span><span class="p">)</span>
                <span class="n">indicator</span><span class="o">.</span><span class="n">invalidate</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">indicator_trivial_infeasible_idx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_internal</span><span class="p">(</span><span class="n">indicator</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.range_constraint"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.range_constraint">[docs]</a>    <span class="k">def</span> <span class="nf">range_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">rng_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a new range constraint, but does not add it to the model.</span>

<span class="sd">        A range constraint states that a linear</span>
<span class="sd">        expression has to stay within an interval [lb..ub].</span>
<span class="sd">        Both lb and ub have to be floating-point numbers with lb smaller than ub.</span>
<span class="sd">        Raises an exception if lb is greater than ub.</span>

<span class="sd">        The method creates a new range constraint but does not add it to the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            lb: A float number.</span>
<span class="sd">            expr: A linear expression, e.g. X+Y+Z.</span>
<span class="sd">            ub: A float number, which should be greater than lb.</span>
<span class="sd">            rng_name: An optional name for the range constraint.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The newly created range constraint.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_num</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="s">&#39;Model.range_constraint&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_num</span><span class="p">(</span><span class="n">ub</span><span class="p">,</span> <span class="s">&#39;Model.range_constraint&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lb</span> <span class="o">&lt;=</span> <span class="n">ub</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;infeasible range constraint, lb={0}, ub={1}, expr={2}&quot;</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>

        <span class="n">expr1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_linear_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="n">rng</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">new_range_constraint</span><span class="p">(</span><span class="n">lb</span><span class="p">,</span> <span class="n">expr1</span><span class="p">,</span> <span class="n">ub</span><span class="p">,</span> <span class="n">rng_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rng</span>
</div>
    <span class="k">def</span> <span class="nf">indicator_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">binary_var</span><span class="p">,</span> <span class="n">linear_ct</span><span class="p">,</span> <span class="n">active_value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_var</span><span class="p">(</span><span class="n">binary_var</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_constraint</span><span class="p">(</span><span class="n">linear_ct</span><span class="p">,</span> <span class="n">AbstractLinearConstraint</span><span class="p">)</span>
        <span class="n">actual_active_value</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">active_value</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">new_indicator_constraint</span><span class="p">(</span><span class="n">binary_var</span><span class="p">,</span> <span class="n">linear_ct</span><span class="p">,</span> <span class="n">actual_active_value</span><span class="p">)</span>

<div class="viewcode-block" id="Model.add_constraint"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.add_constraint">[docs]</a>    <span class="k">def</span> <span class="nf">add_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Adds a new linear constraint to the model.</span>

<span class="sd">        :param ct: A linear constraint of the form &lt;expr1&gt; &lt;op&gt; &lt;expr2&gt;, where both expr1 and expr2 are</span>
<span class="sd">         linear expressions built from variables in the model, and &lt;op&gt; is a relational operator</span>
<span class="sd">         among &lt;= (smaller or equal), == (equal), and &gt;= (greater or equal).</span>


<span class="sd">        :param ctname: An optional string used to name the constraint.</span>

<span class="sd">        :return: The newly added constraint.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_internal</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ct</span>
</div>
    <span class="k">def</span> <span class="nf">_add_constraint_block</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct_ctname_seq</span><span class="p">,</span> <span class="n">safe</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="n">posted_cts</span> <span class="o">=</span> <span class="p">[</span><span class="n">ct</span> <span class="k">for</span> <span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span> <span class="ow">in</span> <span class="n">ct_ctname_seq</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_constraint</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">ctname</span><span class="p">,</span> <span class="n">do_check</span><span class="o">=</span><span class="n">safe</span><span class="p">)]</span>
        <span class="n">ct_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">create_block_linear_constraints</span><span class="p">(</span><span class="n">posted_cts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_register_block_cts</span><span class="p">(</span><span class="n">posted_cts</span><span class="p">,</span> <span class="n">ct_indices</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">posted_cts</span>

    <span class="c"># ----------------------------------------------------</span>
    <span class="c"># objective</span>
    <span class="c"># ----------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">_clear_engine_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">clear_objective</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__objective_expr</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">objective_expr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the current expression used as the model objective.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objective_expr</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">objective_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the direction of the optimization.</span>

<span class="sd">        :return: An instance of ObjectiveSense, either Minimize or Maximize.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objective_sense</span>

<div class="viewcode-block" id="Model.minimize"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.minimize">[docs]</a>    <span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets an expression as the expression to be minimized.</span>

<span class="sd">        The argument is converted to a linear expression. Accepted types are variable (instances of Var class),</span>
<span class="sd">        linear expressions (instance of LinearExpr), or numbers.</span>

<span class="sd">        :param expr: A linear expression or a variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">Minimize</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.maximize"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.maximize">[docs]</a>    <span class="k">def</span> <span class="nf">maximize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets an expression as the expression to be maximized.</span>

<span class="sd">        :param expr: A linear expression or a variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">Maximize</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.is_minimize"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.is_minimize">[docs]</a>    <span class="k">def</span> <span class="nf">is_minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Checks whether the model is a minimization model.</span>

<span class="sd">        Note that this returns True even if the expression to minimize is a constant.</span>
<span class="sd">        To check whether the model has a non-constant objective, use has_objective().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objective_sense</span> <span class="ow">is</span> <span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">Minimize</span>
</div>
<div class="viewcode-block" id="Model.is_maximize"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.is_maximize">[docs]</a>    <span class="k">def</span> <span class="nf">is_maximize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Checks whether the model is a maximization model.</span>
<span class="sd">        Note that this returns True even if the expression to maximize is a constant.</span>
<span class="sd">        To check whether the model has a non-constant objective, use has_objective().</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objective_sense</span> <span class="ow">is</span> <span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">Maximize</span>
</div>
<div class="viewcode-block" id="Model.objective_coef"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.objective_coef">[docs]</a>    <span class="k">def</span> <span class="nf">objective_coef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvar</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the objective coefficient of a variable.</span>

<span class="sd">        The objective coefficient is the coefficient of the variable in</span>
<span class="sd">        the Model&#39;s objective expression. If the variable is not explicitly</span>
<span class="sd">        mentioned in the objective, it returns 0.</span>

<span class="sd">        :param dvar: The decision variable to compute the objective coefficient.</span>

<span class="sd">        :return: A float number, the objective coefficient of the variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typecheck_var</span><span class="p">(</span><span class="n">dvar</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objective_coef</span><span class="p">(</span><span class="n">dvar</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_objective_coef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvar</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objective_expr</span><span class="p">[</span><span class="n">dvar</span><span class="p">]</span>

<div class="viewcode-block" id="Model.remove_objective"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.remove_objective">[docs]</a>    <span class="k">def</span> <span class="nf">remove_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clears the current objective.</span>

<span class="sd">        This is equivalent to setting &quot;minimize 1&quot;.</span>
<span class="sd">        Any subsequent solve will look only for a feasible solution.</span>
<span class="sd">        You can detect this state by calling has_objective() on the model.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :func:`has_objective`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">Minimize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_objective_expr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.has_objective"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.has_objective">[docs]</a>    <span class="k">def</span> <span class="nf">has_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Checks whether the model has a non-constant objective expression.</span>

<span class="sd">        A model with a constant objective will only search for a feasible solution when solved.</span>
<span class="sd">        This happens either if no objectibve has been assigned to the model,</span>
<span class="sd">        or if the objective has been removed with remove_objective.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :func:`remove_objective`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objective_expr</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Model.set_objective"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.set_objective">[docs]</a>    <span class="k">def</span> <span class="nf">set_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sense</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sets a new objective.</span>

<span class="sd">        Args:</span>
<span class="sd">            sense: Either an instance of ObjectiveSense, either Minimize or Maximize,</span>
<span class="sd">                or a string: &quot;min&quot; or &quot;max&quot;</span>
<span class="sd">            expr: Is converted to a linear expresion. Acceptable types are Var, LinearExpr, or plain number</span>

<span class="sd">        Note that using a number will not actually optimize, but only look for a feasible solution.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">expr</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_objective_expr</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_linear_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective_expr</span><span class="o">.</span><span class="n">is_constant</span><span class="p">():</span>
            <span class="c"># do not try to clear a constant list as CPLEX/wrapper will crash!</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_clear_engine_objective</span><span class="p">()</span>

        <span class="n">actual_sense</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_sense</span><span class="p">(</span><span class="n">sense</span><span class="p">)</span>

        <span class="c"># minor issue: we reset coefficients even if they are identical.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">actual_sense</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__objective_sense</span> <span class="o">=</span> <span class="n">actual_sense</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__objective_expr</span> <span class="o">=</span> <span class="n">expr</span>
</div>
    <span class="k">def</span> <span class="nf">_can_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">can_solve</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_make_start_infodict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="n">infodict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span>
        <span class="n">infodict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s">&quot;number_of_</span><span class="si">%s</span><span class="s">_vars&quot;</span> <span class="o">%</span> <span class="n">tn</span> <span class="k">for</span> <span class="n">tn</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;binary&quot;</span><span class="p">,</span> <span class="s">&quot;integer&quot;</span><span class="p">,</span> <span class="s">&quot;ccontinuous&quot;</span><span class="p">]],</span>
                            <span class="p">[</span><span class="n">stats</span><span class="o">.</span><span class="n">number_of_binary_variables</span><span class="p">,</span>
                             <span class="n">stats</span><span class="o">.</span><span class="n">number_of_integer_variables</span><span class="p">,</span>
                             <span class="n">stats</span><span class="o">.</span><span class="n">number_of_continuous_variables</span><span class="p">]))</span>
        <span class="n">infodict</span><span class="p">[</span><span class="s">&quot;number_of_constraints&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_constraints</span>
        <span class="k">return</span> <span class="n">infodict</span>

    <span class="k">def</span> <span class="nf">_make_end_infodict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(</span><span class="n">keep_zeros</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>

<div class="viewcode-block" id="Model.solve"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.solve">[docs]</a>    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docloud_context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Starts a solve operation on the model.</span>

<span class="sd">        If passed a real DOcloud context, the solve operation will be started on DOcloud.</span>
<span class="sd">        If the argument is None, or does not contain valid DOcloud credentials,</span>
<span class="sd">        the solve operation will try to use CPLEX if CPLEX is available (it uses the Environment class</span>
<span class="sd">        to determine this).</span>

<span class="sd">        If CPLEX is available, the the solve operation will be performed using the native CPLEX.</span>
<span class="sd">        If CPLEX is not available but if the model has its own DOcloud credentials (set at model creation time),</span>
<span class="sd">        the the solve operation will be started on DOcloud, using the model&#39;s own DOcloudContex instance.</span>

<span class="sd">        If CPLEX is not available and the model has no valid credentials, an error is raised, as there is</span>
<span class="sd">        no way to perform the solve.</span>

<span class="sd">        Args:</span>
<span class="sd">            docloud_context: an optional instance of DOcloudContext to perform this particular solve.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the solve operation produced a solution.</span>
<span class="sd">            The solution can be accessed by the solution property.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_objective</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;No objective to optimize - searching for a feasible solution&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">docloud_context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">docloud_context</span><span class="o">.</span><span class="n">has_credentials</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_cloud</span><span class="p">(</span><span class="n">docloud_context</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;DOcloud context has no valid credentials: {0!s}&quot;</span><span class="p">,</span> <span class="n">docloud_context</span><span class="p">)</span>
        <span class="c"># from now on docloud_context is None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">has_cplex</span><span class="p">:</span>
            <span class="c"># if CPLEX is installed go for it</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_local</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">docloud_context</span><span class="p">:</span>
            <span class="c"># no context passed as argument, no Cplex installed, try model&#39;s own context</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_cloud</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docloud_context</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># no way to solve.. really</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;CPLEX DLL not found: please provide DOcloud credentials&quot;</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_solve_local</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Starts a solve operation on the local machine.</span>

<span class="sd">        Note:</span>
<span class="sd">        This method will never try to solve on DOcloud, regardless of whether the model</span>
<span class="sd">        has an attached DOcloud context.</span>
<span class="sd">        If CPLEX is not available, an error is raised.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the solve produced a solution, else False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify_start_solve</span><span class="p">()</span>

        <span class="n">self_solve_hooks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_hooks</span>
        <span class="k">if</span> <span class="n">worker_hook</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">self_solve_hooks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">worker_hook</span><span class="p">)</span>
        <span class="c"># connect progress listeners (if any) iff problem is mip</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_integer_or_binary_vars</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_progress_listeners</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">connect_progress_listeners</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_progress_listeners</span><span class="p">)</span>

        <span class="c"># call notifyStart on progress listeners</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fire_start_solve_listeners</span><span class="p">()</span>
        <span class="c"># notify hooks only on solve_local</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">self_solve_hooks</span><span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">notify_start_solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_make_start_infodict</span><span class="p">())</span>

        <span class="c"># --- solve is protected in try/except block</span>
        <span class="n">has_solution</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">reported_obj</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">engine_status</span> <span class="o">=</span> <span class="n">JobSolveStatus</span><span class="o">.</span><span class="n">UNKNOWN</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">new_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">has_solution</span> <span class="o">=</span> <span class="n">new_solution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_solution</span><span class="p">(</span><span class="n">new_solution</span><span class="p">)</span>
            <span class="n">reported_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reported_objective_value</span><span class="p">()</span>

            <span class="c"># store solve status as returned by the engine.</span>
            <span class="n">engine_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">get_solve_status</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_solve_status</span> <span class="o">=</span> <span class="n">engine_status</span>

        <span class="k">except</span> <span class="n">DOcplexException</span> <span class="k">as</span> <span class="n">docpx_e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_solution</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">docpx_e</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="c"># call notifyEnd on progress listeners</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fire_end_solve_listeners</span><span class="p">(</span><span class="n">has_solution</span><span class="p">,</span> <span class="n">reported_obj</span><span class="p">)</span>

            <span class="c"># call hooks</span>
            <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">self_solve_hooks</span><span class="p">:</span>
                <span class="n">h</span><span class="o">.</span><span class="n">notify_end_solve</span><span class="p">(</span><span class="n">has_solution</span><span class="p">,</span>
                                   <span class="n">engine_status</span><span class="p">,</span>
                                   <span class="n">reported_obj</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">_make_end_infodict</span><span class="p">())</span>

            <span class="c"># unplug worker hook if any</span>
            <span class="k">if</span> <span class="n">worker_hook</span><span class="p">:</span>
                <span class="n">self_solve_hooks</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">worker_hook</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">has_solution</span>

<div class="viewcode-block" id="Model.get_solve_status"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.get_solve_status">[docs]</a>    <span class="k">def</span> <span class="nf">get_solve_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the solve status of the last successful solve.</span>

<span class="sd">        If the model has been solved successfully, returns the status stored in the</span>
<span class="sd">        model solution. Otherwise returns JobSolveStatus.UNKNOWN</span>

<span class="sd">        :Returns:</span>
<span class="sd">            An enumerated value of type JobSolveStatus.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :class:`docloud.status.JobSolveStatus`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_solve_status</span>
</div>
    <span class="k">def</span> <span class="nf">_solve_cloud</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docloud_context</span><span class="p">):</span>
        <span class="c"># see if we can reuse the local docloud engine if any?</span>
        <span class="n">docloud_engine</span> <span class="o">=</span> <span class="n">DOcloudEngine</span><span class="p">(</span><span class="n">error_handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="p">,</span> <span class="n">docloud_context</span><span class="o">=</span><span class="n">docloud_context</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">notify_start_solve</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fire_start_solve_listeners</span><span class="p">()</span>
        <span class="n">new_solution</span> <span class="o">=</span> <span class="n">docloud_engine</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_solution</span><span class="p">(</span><span class="n">new_solution</span><span class="p">)</span>
        <span class="c"># store solve status as returned by the engine.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_solve_status</span> <span class="o">=</span> <span class="n">docloud_engine</span><span class="o">.</span><span class="n">get_solve_status</span><span class="p">()</span>
        <span class="n">ok</span> <span class="o">=</span> <span class="n">new_solution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
        <span class="n">objective_value</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
            <span class="n">objective_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fire_end_solve_listeners</span><span class="p">(</span><span class="n">ok</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">)</span>
        <span class="c"># cloud engine is transient here</span>
        <span class="k">return</span> <span class="n">ok</span>

<div class="viewcode-block" id="Model.solve_cloud"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.solve_cloud">[docs]</a>    <span class="k">def</span> <span class="nf">solve_cloud</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docloud_context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Starts execution of the model on the cloud.</span>

<span class="sd">        This method accepts a context (an instance of DOcloudContext) to be used when</span>
<span class="sd">        solving on the cloud. If the context argument is None or invalid, then it will</span>
<span class="sd">        use the model&#39;s own instance of DOcloudContext, set at model creation time.</span>

<span class="sd">        Note:</span>
<span class="sd">            This method will always solve the model on the cloud, whether or not CPLEX</span>
<span class="sd">            is available on the local machine</span>

<span class="sd">        If docloud_context argument is None and the model has no context attached, an exception is raised.</span>

<span class="sd">        Args:</span>
<span class="sd">            docloud_context: An optional context to use on the cloud. If None, uses the model&#39;s DOcloudContext instance, if any.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if execution produces a solution, else False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">docloud_context</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">docloud_context</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="p">,</span> <span class="n">DOcloudEngine</span><span class="p">):</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_cloud</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docloud_context</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;DOcloud context is None: cannot solve on the cloud&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">docloud_context</span><span class="o">.</span><span class="n">has_credentials</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_cloud</span><span class="p">(</span><span class="n">docloud_context</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;DOcloud context has no valid credentials: {0!s}&quot;</span><span class="p">,</span> <span class="n">docloud_context</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">notify_start_solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solve_count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">notify_solve_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">notify_solve_relaxed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relaxed_solution</span><span class="p">):</span>
        <span class="c"># INTERNAL: used by relaxer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_solution</span><span class="p">(</span><span class="n">relaxed_solution</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">relaxed_solution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notify_start_solve</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notify_solve_failed</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_resolve_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sense_arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        INTERNAL</span>
<span class="sd">        :param sense_arg:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sense_arg</span><span class="p">,</span> <span class="n">ObjectiveSense</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">sense_arg</span>
        <span class="k">elif</span> <span class="n">is_string</span><span class="p">(</span><span class="n">sense_arg</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sense_arg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resolve_objective_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sense_arg</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sense_arg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<div class="viewcode-block" id="Model.solve_lexicographic"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.solve_lexicographic">[docs]</a>    <span class="k">def</span> <span class="nf">solve_lexicographic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goals</span><span class="p">,</span>
                            <span class="n">senses</span><span class="o">=</span><span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">Minimize</span><span class="p">,</span>
                            <span class="n">abs_tolerance</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
                            <span class="n">relative_tolerance</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
                            <span class="n">dump_pass_files</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                            <span class="n">docloud_context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Performs a lexicographic solve from an ordered collection of goals.</span>

<span class="sd">        :param goals: An ordered collection of linear expressions.</span>

<span class="sd">        :param senses: Either an ordered collection of senses, or one sense, or None. The default is None,</span>
<span class="sd">         in which case the solve uses a Minimize sense. Each sense can be either a sense object,</span>
<span class="sd">         that is either ObjectiveSense.Minimize or Maximize, or a string &quot;min&quot; or &quot;max&quot;.</span>

<span class="sd">        :param abs_tolerance: A float number (default is 1e-5) used as the absolute slack in</span>
<span class="sd">         intermediate constraints set to keep the previous passes&#39; objectives.</span>

<span class="sd">        :param relative_tolerance: A float number (default is 1e-5) used as the relative slack in</span>
<span class="sd">         intermediate constraints set to keep the previous passes&#39; objectives. The slack used is the maximum</span>
<span class="sd">         of the absolute slack and the relative slack times the objective of the pass.</span>

<span class="sd">        :param docloud_context: An instance of a context or None. if not None, will force all solves</span>
<span class="sd">         to be ran on the cloud.</span>

<span class="sd">        :return: True if all passes ran successfully.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">old_objective_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objective_expr</span>
        <span class="n">old_objective_sense</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__objective_sense</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">goals</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;solve_lexicographic requires a non-empty list of goals&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_indexable</span><span class="p">(</span><span class="n">goals</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;solve_lexicographic requires an indexable collection of goals, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">goals</span><span class="p">)</span>
        <span class="c"># --- senses ---</span>
        <span class="k">if</span> <span class="n">senses</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">senses</span> <span class="o">=</span> <span class="n">generate_constant</span><span class="p">(</span><span class="n">ObjectiveSense</span><span class="o">.</span><span class="n">Minimize</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">senses</span><span class="p">,</span> <span class="n">ObjectiveSense</span><span class="p">):</span>
            <span class="n">senses</span> <span class="o">=</span> <span class="n">generate_constant</span><span class="p">(</span><span class="n">senses</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_string</span><span class="p">(</span><span class="n">senses</span><span class="p">):</span>
            <span class="n">senses</span> <span class="o">=</span> <span class="n">generate_constant</span><span class="p">(</span><span class="n">senses</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">senses</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;solve_lexicographic expects as senses: None, min/max or iterable, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">senses</span><span class="p">)</span>
        <span class="n">iter_senses</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">senses</span><span class="p">)</span>
        <span class="c"># --- senses ---</span>

        <span class="n">pass_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">current_status</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c"># currentObjective = -1</span>
        <span class="n">nested_kpi_format</span> <span class="o">=</span> <span class="s">&#39;   - </span><span class="si">%s</span><span class="s"> =&#39;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">actual_goals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tolerance_scheme</span> <span class="o">=</span> <span class="n">_ToleranceScheme</span><span class="p">(</span><span class="n">abs_tolerance</span><span class="p">,</span> <span class="n">relative_tolerance</span><span class="p">)</span>
        <span class="c"># keep extra constraints, in order to remove them at the end.</span>
        <span class="n">extra_cts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">gi</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">goals</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">DecisionKPI</span><span class="p">):</span>
                <span class="n">goal_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_linear_expr</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">get_expression</span><span class="p">())</span>
                <span class="n">goal_name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">goal_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_linear_expr</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">goal_name</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">goal_expr</span><span class="o">.</span><span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">goal_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_linear_expr</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
                <span class="n">goal_name</span> <span class="o">=</span> <span class="n">goal_expr</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s">&quot;pass</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">gi</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">actual_goals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">goal_name</span><span class="p">,</span> <span class="n">goal_expr</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">goal_name</span><span class="p">,</span> <span class="n">goal_expr</span> <span class="ow">in</span> <span class="n">actual_goals</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">goal_expr</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span> <span class="ow">and</span> <span class="n">pass_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Constant expression in lexicographoic solve: {0!s}, skipped&quot;</span><span class="p">,</span> <span class="n">goal_expr</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">pass_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">next_sense</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iter_senses</span><span class="p">)</span>
                <span class="n">sense</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_sense</span><span class="p">(</span><span class="n">next_sense</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s">&quot;lexicographic: starting pass </span><span class="si">%d</span><span class="s">, </span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">pass_count</span><span class="p">,</span> <span class="n">sense</span><span class="o">.</span><span class="n">action</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">goal_name</span><span class="p">)</span>
                <span class="n">m</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">sense</span><span class="p">,</span> <span class="n">goal_expr</span><span class="p">)</span>
                <span class="c"># print(&quot;-- current objective is: {0!s}&quot;.format(goal_expr))</span>
                <span class="k">if</span> <span class="n">dump_pass_files</span><span class="p">:</span>
                    <span class="n">pass_basename</span> <span class="o">=</span> <span class="s">&#39;lexico_</span><span class="si">%s</span><span class="s">_pass</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pass_count</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dump_as_lp</span><span class="p">(</span><span class="n">basename</span><span class="o">=</span><span class="n">pass_basename</span><span class="p">)</span>
                <span class="n">current_status</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">docloud_context</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">current_status</span><span class="p">:</span>
                    <span class="n">current_obj</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">objective_value</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_obj</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">prints_trace</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s">&quot;lexicographic: pass #</span><span class="si">%d</span><span class="s"> ok with objective=</span><span class="si">%.4f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pass_count</span><span class="p">,</span> <span class="n">current_obj</span><span class="p">))</span>
                        <span class="n">m</span><span class="o">.</span><span class="n">_report_lexicographic_goals</span><span class="p">(</span><span class="n">actual_goals</span><span class="p">,</span> <span class="n">kpi_header_format</span><span class="o">=</span><span class="n">nested_kpi_format</span><span class="p">)</span>
                    <span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerance_scheme</span><span class="o">.</span><span class="n">compute_tolerance</span><span class="p">(</span><span class="n">current_obj</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sense</span><span class="o">.</span><span class="n">is_minimize</span><span class="p">():</span>
                        <span class="n">pass_ct</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">goal_expr</span> <span class="o">&lt;=</span> <span class="n">current_obj</span> <span class="o">+</span> <span class="n">tolerance</span><span class="p">,</span>
                                                   <span class="s">&#39;_ctle_pass_</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">pass_count</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">pass_ct</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">goal_expr</span> <span class="o">&gt;=</span> <span class="n">current_obj</span> <span class="o">-</span> <span class="n">tolerance</span><span class="p">,</span>
                                                   <span class="s">&#39;_ctge_pass_</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">pass_count</span><span class="p">)</span>

                    <span class="c"># print(&quot;&gt;&gt;&gt;&gt; new pass ct is {0!s}&quot;.format(pass_ct))</span>
                    <span class="n">extra_cts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pass_ct</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;lexicographic fails. pass #</span><span class="si">%d</span><span class="s">, stop!&quot;</span><span class="p">,</span> <span class="n">pass_count</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c">#  print(&quot;-&gt; start restoring model at end of lexicographic&quot;)</span>
            <span class="k">while</span> <span class="n">extra_cts</span><span class="p">:</span>
                <span class="c"># using LIFO logic to avoid holes in indices.</span>
                <span class="n">ct_to_remove</span> <span class="o">=</span> <span class="n">extra_cts</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="c"># print(&quot;* removing constraint: name: {0}, idx: {1}&quot;.format(ct_to_remove.name, ct_to_remove.index))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_remove_constraint_internal</span><span class="p">(</span><span class="n">ct_to_remove</span><span class="p">)</span>
            <span class="c"># restore objective whatsove</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">old_objective_sense</span><span class="p">,</span> <span class="n">old_objective_expr</span><span class="p">)</span>
            <span class="c">#  print(&quot;&lt;- end restoring model at end of lexicographic&quot;)</span>

        <span class="k">if</span> <span class="n">current_status</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;lexicographic ok, #passes={0}, results={1!s}&quot;</span><span class="p">,</span> <span class="n">pass_count</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">prints_info</span><span class="p">():</span>
                <span class="n">m</span><span class="o">.</span><span class="n">_report_lexicographic_goals</span><span class="p">(</span><span class="n">actual_goals</span><span class="p">,</span> <span class="n">kpi_header_format</span><span class="o">=</span><span class="n">nested_kpi_format</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;lexicographic failed at pass {0}&quot;</span><span class="p">,</span> <span class="n">pass_count</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">current_status</span>
</div>
    <span class="k">def</span> <span class="nf">_has_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__solution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">_set_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_solution</span><span class="p">,</span> <span class="n">do_copy_values</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        INTERNAL: Sets this solution as the model&#39;s current solution.</span>
<span class="sd">        Copies values to variables (for now, let&#39;s think more about this)</span>
<span class="sd">        :param new_solution:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__solution</span> <span class="o">=</span> <span class="n">new_solution</span>
        <span class="k">if</span> <span class="n">new_solution</span> <span class="ow">and</span> <span class="n">do_copy_values</span><span class="p">:</span>
            <span class="n">new_solution</span><span class="o">.</span><span class="n">_copy_var_values</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">check_has_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># see if we can refine messages here...</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_solution</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Model&lt;{0}&gt; has not been solved OK&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="Model.set_mip_start"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.set_mip_start">[docs]</a>    <span class="k">def</span> <span class="nf">set_mip_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mip_start_sol</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  Sets a solution as the  MIP starting point.</span>

<span class="sd">        Use a (possibly partial) solution object as starting point for a MIP.</span>

<span class="sd">        This is valid only for models with binary or integer variables.</span>

<span class="sd">        Presently, this is also only valid for a native solve (when CPLEX DLL is installed) but not on DOcloud.</span>

<span class="sd">        :param mip_start_sol: The solution object to use as a starting point. This argument should be of type</span>
<span class="sd">         SolveSolution</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mip_start_sol</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Invalid MIP start: {0!s}&quot;</span><span class="p">,</span> <span class="n">mip_start_sol</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_integer_or_binary_vars</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Problem has no Integer or Binary variable, cannot use MIP start&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mip_start_sol</span><span class="o">.</span><span class="n">check_as_mip_start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__mip_start</span> <span class="o">=</span> <span class="n">mip_start_sol</span>

    <span class="c"># def getObjectiveValue(self):</span>
    <span class="c">#     # PCO: not documented, to be replaced by objective_value property</span>
    <span class="c">#     return self.objective_value</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">objective_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the value of the objective expression in the last solve solution.</span>

<span class="sd">        Raises an exception if the model has not been solved successfully.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_has_solution</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objective_value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_objective_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">objective_value</span>

    <span class="k">def</span> <span class="nf">_reported_objective_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">failure_obj</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">objective_value</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span> <span class="k">else</span> <span class="n">failure_obj</span>

    <span class="k">def</span> <span class="nf">_resolve_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_arg</span><span class="p">,</span> <span class="n">basename_arg</span><span class="p">,</span> <span class="n">extension</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">path_arg</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path_arg</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">path_arg</span> <span class="o">==</span> <span class="s">&quot;.&quot;</span><span class="p">:</span>
                    <span class="n">path_arg</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_output_path</span><span class="p">(</span><span class="n">extension</span><span class="p">,</span> <span class="n">basename_arg</span><span class="p">,</span> <span class="n">path_arg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># ensure path ends with extension</span>
                <span class="k">return</span> <span class="n">path_arg</span> <span class="k">if</span> <span class="n">path_arg</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span> <span class="k">else</span> <span class="n">path_arg</span> <span class="o">+</span> <span class="n">extension</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">path_arg</span> <span class="ow">is</span> <span class="bp">None</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_output_path</span><span class="p">(</span><span class="n">extension</span><span class="p">,</span> <span class="n">basename_arg</span><span class="p">,</span> <span class="n">path_arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_make_output_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extension</span><span class="p">,</span> <span class="n">basename_arg</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">self_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">raw_basename</span> <span class="o">=</span> <span class="n">resolve_pattern</span><span class="p">(</span><span class="n">basename_arg</span><span class="p">,</span> <span class="n">self_name</span><span class="p">)</span> <span class="k">if</span> <span class="n">basename_arg</span> <span class="k">else</span> <span class="n">self_name</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">raw_basename</span><span class="p">)</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">path</span> <span class="ow">or</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">basename</span> <span class="o">+</span> <span class="n">extension</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="n">__printer_ctor_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">LP_format</span><span class="p">:</span> <span class="n">LPModelPrinter</span>
                           <span class="p">}</span>

    <span class="n">lp_format</span> <span class="o">=</span> <span class="n">LP_format</span>

    <span class="k">def</span> <span class="nf">_get_printer_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exchange_format</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param exchange_format: The format to be used.</span>
<span class="sd">        :param do_raise:  A Boolean, raise exception if format is unuspported.</span>
<span class="sd">        :return: printer or None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">printer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__printer_ctor_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">exchange_format</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">printer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">do_raise</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Unsupported output format: {0!s}&quot;</span><span class="p">,</span> <span class="n">exchange_format</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Unsupported output format: {0!s}&quot;</span><span class="p">,</span> <span class="n">exchange_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">printer</span>

    <span class="k">def</span> <span class="nf">dump_as_lp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">)</span>

<div class="viewcode-block" id="Model.export_as_lp"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.export_as_lp">[docs]</a>    <span class="k">def</span> <span class="nf">export_as_lp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Exports a model in LP format.</span>

<span class="sd">        Args:</span>
<span class="sd">            basename: Controls the basename with which the model is printed.</span>
<span class="sd">                Accepts None, a plainstring or a string format.</span>
<span class="sd">                if None, uses the model&#39;s name;</span>
<span class="sd">                if passed a plain string, the string is used in place of the model&#39;s name;</span>
<span class="sd">                if passed a string format (either with %s or {0}, it is used to format the</span>
<span class="sd">                model name to produce the basename of the written file.</span>

<span class="sd">            path: A path to write file, expects a string path or None.</span>
<span class="sd">                can be either a directory, in which case the basename</span>
<span class="sd">                that was computed with the basename argument, is appended to the directory to produce</span>
<span class="sd">                the file.</span>
<span class="sd">                If given a full path, the path is directly used to write the file, and</span>
<span class="sd">                the basename argument is not used.</span>
<span class="sd">                If passed None, the output directory will be tempdir.gettempdir().</span>

<span class="sd">            hide_user_names: A Boolean indicating whether or not to keep user names for</span>
<span class="sd">                variables and constraints. If False, all names are replaced by x1, x2,... for variables,</span>
<span class="sd">                and c1,c2,... for constraints.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Assuming the model&#39;s name is mymodel:</span>
<span class="sd">                m.export_as_lp() will write &quot;mymodel.lp&quot; in gettempdir()</span>
<span class="sd">                m.export_as_lp(basename=&quot;foo&quot;) will write &quot;foo.lp&quot; in gettempdir()</span>
<span class="sd">                m.export_as_lp(basename=&quot;foo&quot;, path=&quot;e:/home/docplex&quot;)</span>
<span class="sd">                    will write file &quot;e:/home/docplex/foo.lp&quot;</span>
<span class="sd">                m.export_as_lp(&quot;e/home/docplex/bar.lp&quot;)</span>
<span class="sd">                    will write file &quot;e:/home/docplex/bar.lp&quot;</span>
<span class="sd">                m.export_as_lp(basename=&quot;docplex_%s&quot;, path=&quot;e/home/&quot;)</span>
<span class="sd">                    will write file &quot;e:/home/docplex/docplex_mymodel.lp&quot;</span>

<span class="sd">        See Also:</span>
<span class="sd">            tempdir.gettempdir()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_export</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span>
                            <span class="n">use_engine</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                            <span class="n">hide_user_names</span><span class="o">=</span><span class="n">hide_user_names</span><span class="p">,</span>
                            <span class="n">exchange_format</span><span class="o">=</span><span class="n">exchange_format</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_export</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span>
                            <span class="n">hide_user_names</span><span class="o">=</span><span class="n">hide_user_names</span><span class="p">,</span>
                            <span class="n">exchange_format</span><span class="o">=</span><span class="n">exchange_format</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">use_engine</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="c"># path is either a path string or None</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Expecting path string or None, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">basename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">basename</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Expecting basename string or None, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">basename</span><span class="p">)</span>
        <span class="c"># INTERNAL</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extension</span> <span class="o">=</span> <span class="n">exchange_format</span><span class="o">.</span><span class="n">extension</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Not a supported exchange format: {0!s}&quot;</span><span class="p">,</span> <span class="n">exchange_format</span><span class="p">)</span>
        <span class="n">raw_basename</span> <span class="o">=</span> <span class="n">resolve_pattern</span><span class="p">(</span><span class="n">basename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="n">basename</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">raw_basename</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">extension</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_export_to_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="p">,</span> <span class="n">use_engine</span><span class="p">,</span> <span class="n">exchange_format</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s">&quot;model file: {0} overwritten&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">_export_to_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">use_engine</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensure_setup</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">use_engine</span><span class="p">:</span>
                <span class="c"># rely on engine for the dump</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># a path is not a stream but anyway it will work</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_export_to_stream</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="n">hide_user_names</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">exchange_format</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">path</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Cannot open file: {0}, model not exported&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">_export_to_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">):</span>
        <span class="n">printer_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_printer_type</span><span class="p">(</span><span class="n">exchange_format</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">printer_type</span><span class="p">:</span>
            <span class="n">printer</span> <span class="o">=</span> <span class="n">printer_type</span><span class="p">()</span>
            <span class="n">printer</span><span class="o">.</span><span class="n">wrap_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_export</span>
            <span class="k">if</span> <span class="n">hide_user_names</span><span class="p">:</span>
                <span class="n">printer</span><span class="o">.</span><span class="n">forget_user_names</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">printer</span><span class="o">.</span><span class="n">printModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span>

<div class="viewcode-block" id="Model.export_to_stream"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.export_to_stream">[docs]</a>    <span class="k">def</span> <span class="nf">export_to_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;export_to_stream(self, stream, hide_user_names=False)</span>

<span class="sd">        Export the model to an output stream in LP format.</span>

<span class="sd">        A stream can be one of</span>
<span class="sd">            - a string, interpreted as a system path</span>
<span class="sd">            - None, interpreted as stdout</span>
<span class="sd">            - otherwise assuming a Python file-type object (e.g. a StringIO() instance)</span>
<span class="sd">                </span>
<span class="sd">        Args:</span>
<span class="sd">            stream: sn object defining where the output willbe sent</span>
<span class="sd">            </span>
<span class="sd">            hide_user_names: An optional Boolean indicating whether or not to keep user names for</span>
<span class="sd">                variables and constraints. If False, all names are replaced by x1,x2,... for variables,</span>
<span class="sd">                and c1,c2,... for constraints. Default is to keep user names.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_export_to_stream</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="p">,</span> <span class="n">exchange_format</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.export_to_string"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.export_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">export_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;export_to_string(self, hide_user_names=False)</span>

<span class="sd">        Exports the model to a string.</span>

<span class="sd">        The output string contains the model in LP format.</span>

<span class="sd">        Args:</span>
<span class="sd">            hide_user_names: an optional boolean indicating whether or not to keep user names for</span>
<span class="sd">                variables and constraints. If False, all names are replaced by x1,x2 for variables,</span>
<span class="sd">                and c1,c2... for constraints. Default is to keep user names.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a string, containg the model exported in LP format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oss</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_export_to_stream</span><span class="p">(</span><span class="n">oss</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="p">,</span> <span class="n">exchange_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">oss</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="c"># -- supported attributes</span></div>
    <span class="n">_supported_attributes</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;duals&quot;</span><span class="p">:</span> <span class="n">_SolveAttribute</span><span class="p">(</span><span class="s">&quot;duals&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">),</span>
                             <span class="s">&quot;slacks&quot;</span><span class="p">:</span> <span class="n">_SolveAttribute</span><span class="p">(</span><span class="s">&quot;slacks&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">),</span>
                             <span class="s">&quot;reduced_costs&quot;</span><span class="p">:</span> <span class="n">_SolveAttribute</span><span class="p">(</span><span class="s">&quot;reduced_costs&quot;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)}</span>

    <span class="c"># advanced values</span>
    <span class="k">def</span> <span class="nf">_get_engine_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">clazz</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Queries and returns some solve attribute from the last solve.</span>
<span class="sd">        :param arg: Object or iterable.</span>
<span class="sd">        :param clazz: The type of the argument.</span>
<span class="sd">        :param attr_name: The name of the attribute.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attr_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supported_attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Unsupported solve attribute: {0:s}&quot;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">attr_data</span><span class="o">.</span><span class="n">requires_solved</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_can_solve</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&#39;Cannot query attribute {0}, engine has no solve capability&#39;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">clazz</span><span class="p">):</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_engine_attributes_internal</span><span class="p">([</span><span class="n">arg</span><span class="p">],</span> <span class="n">attr_data</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">attrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">arg</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_engine_attributes_internal</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">attr_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Attribute {0:s} not available for: {1:s}, expecting object or iterable&quot;</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_engine_attributes_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mobjs</span><span class="p">,</span> <span class="n">attr_data</span><span class="p">):</span>
        <span class="n">attr_name</span> <span class="o">=</span> <span class="n">attr_data</span><span class="o">.</span><span class="n">name</span>
        <span class="n">is_for_vars</span> <span class="o">=</span> <span class="n">attr_data</span><span class="o">.</span><span class="n">is_for_vars</span>
        <span class="k">if</span> <span class="n">is_for_vars</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">ct</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_constraints</span><span class="p">()]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">is_attributes_fetched</span><span class="p">(</span><span class="n">attr_data</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="c"># get index to value from engine</span>
            <span class="n">attr_idx_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">get_solve_attribute</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">_store_attribute_result</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_idx_map</span><span class="p">,</span> <span class="n">is_for_vars</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">mobjs</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dual_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cts</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_has_solution</span><span class="p">()</span>
        <span class="n">duals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_engine_attribute</span><span class="p">(</span><span class="n">cts</span><span class="p">,</span> <span class="n">AbstractConstraint</span><span class="p">,</span> <span class="s">&#39;duals&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">duals</span>

    <span class="k">def</span> <span class="nf">slack_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cts</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_has_solution</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_engine_attribute</span><span class="p">(</span><span class="n">cts</span><span class="p">,</span> <span class="n">AbstractConstraint</span><span class="p">,</span> <span class="s">&#39;slacks&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reduced_costs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_has_solution</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_engine_attribute</span><span class="p">(</span><span class="n">dvars</span><span class="p">,</span> <span class="n">Var</span><span class="p">,</span> <span class="s">&#39;reduced_costs&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Model.print_solution"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.print_solution">[docs]</a>    <span class="k">def</span> <span class="nf">print_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_filter_zeros</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  Prints the value of the model variables after a solve.</span>

<span class="sd">        Only valid after a successful solve. If the model has not been solved successfully, an</span>
<span class="sd">        exception is raised.</span>

<span class="sd">        :param do_filter_zeros: If True, only non-zero values are printed. Default is True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_has_solution</span><span class="p">()</span>
        <span class="n">self_float_precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">float_precision</span>
        <span class="n">printed_var_counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">has_name</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">is_generated</span><span class="p">():</span>
                <span class="n">var_value</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">unchecked_solution_value</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">do_filter_zeros</span> <span class="ow">or</span> <span class="mi">0</span> <span class="o">!=</span> <span class="n">var_value</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;{0}&gt; </span><span class="se">\&quot;</span><span class="s">{1}</span><span class="se">\&quot;</span><span class="s"> = {2:.{prec}f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">printed_var_counter</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">var_value</span><span class="p">,</span>
                                                               <span class="n">prec</span><span class="o">=</span><span class="mi">0</span> <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">is_discrete</span><span class="p">()</span> <span class="k">else</span> <span class="n">self_float_precision</span><span class="p">))</span>
                    <span class="n">printed_var_counter</span> <span class="o">+=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="Model.report"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.report">[docs]</a>    <span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  Prints the value of the objective and the KPIs.</span>
<span class="sd">        Only valid after a successful solve, otherwise will state the model is not solved.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_solution</span><span class="p">():</span>
            <span class="n">used_prec</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective_expr</span><span class="o">.</span><span class="n">is_discrete</span><span class="p">()</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_float_precision</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;model solved with objective: {0:.{prec}f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_objective_value</span><span class="p">(),</span> <span class="n">prec</span><span class="o">=</span><span class="n">used_prec</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report_kpis</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Model has not been solved successfully, no reporting done.&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Model.report_kpis"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.report_kpis">[docs]</a>    <span class="k">def</span> <span class="nf">report_kpis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_kpis</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">kpi_header_format</span><span class="o">=</span><span class="s">&#39;* KPI: </span><span class="si">%s</span><span class="s">=&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  Prints the values of the KPIs.</span>
<span class="sd">        Only valid after a successful solve.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kpi_format</span> <span class="o">=</span> <span class="n">kpi_header_format</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuous_var_format</span>  <span class="c"># be safe even integer KPIs might yield floats</span>
        <span class="n">printed_kpis</span> <span class="o">=</span> <span class="n">selected_kpis</span> <span class="k">if</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">selected_kpis</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_kpis</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">kpi</span> <span class="ow">in</span> <span class="n">printed_kpis</span><span class="p">:</span>
            <span class="n">kpi_value</span> <span class="o">=</span> <span class="n">kpi</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="n">kpi_format</span> <span class="o">%</span> <span class="p">(</span><span class="n">kpi</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">kpi_value</span><span class="p">))</span>
</div>
    <span class="k">def</span> <span class="nf">_report_lexicographic_goals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal_name_values</span><span class="p">,</span> <span class="n">kpi_header_format</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="n">kpi_format</span> <span class="o">=</span> <span class="n">kpi_header_format</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuous_var_format</span>  <span class="c"># be safe even integer KPIs might yield floats</span>
        <span class="n">printed_kpis</span> <span class="o">=</span> <span class="n">goal_name_values</span> <span class="k">if</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">goal_name_values</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_kpis</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">goal_name</span><span class="p">,</span> <span class="n">goal_expr</span> <span class="ow">in</span> <span class="n">printed_kpis</span><span class="p">:</span>
            <span class="n">goal_value</span> <span class="o">=</span> <span class="n">goal_expr</span><span class="o">.</span><span class="n">solution_value</span>
            <span class="k">print</span><span class="p">(</span><span class="n">kpi_format</span> <span class="o">%</span> <span class="p">(</span><span class="n">goal_name</span><span class="p">,</span> <span class="n">goal_value</span><span class="p">))</span>

<div class="viewcode-block" id="Model.iter_kpis"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.iter_kpis">[docs]</a>    <span class="k">def</span> <span class="nf">iter_kpis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns an iterator over all KPIs in the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">           An iterator object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kpis_by_name</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="Model.kpi_by_name"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.kpi_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">kpi_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">try_match</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">match_case</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Fetches a KPI from a string.</span>

<span class="sd">        This method fetches a KPI from a string, using either exact naming or trying</span>
<span class="sd">        to match a substring of the KPI name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The string to be matched.</span>
<span class="sd">            try_match: A Boolean. If True, returns KPI whose name is not equal to the</span>
<span class="sd">                argument, but contains it. Default is True.</span>
<span class="sd">            match_case: If True, looks for a case-exact match, else ignores case. Default is False.</span>
<span class="sd">            do_raise: If True, raise an exception when no KPI is found.</span>

<span class="sd">        Example:</span>
<span class="sd">            If the KPI name is &quot;Total CO2 Cost&quot; then fetching with argument &quot;co2&quot; and match_case to False</span>
<span class="sd">            will succeed. If match_case if True, then no KPI will be returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The KPI expression if found. If the search fails, either raises an exception, or returns a dummy</span>
<span class="sd">            constant expression with 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">kpi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_kpis</span><span class="p">():</span>
            <span class="n">kpi_name</span> <span class="o">=</span> <span class="n">kpi</span><span class="o">.</span><span class="n">name</span>
            <span class="n">ok</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">kpi_name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">elif</span> <span class="n">try_match</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">match_case</span><span class="p">:</span>
                    <span class="n">ok</span> <span class="o">=</span> <span class="n">kpi_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ok</span> <span class="o">=</span> <span class="n">kpi_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">kpi</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">do_raise</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Cannot find any KPI matching: {0:s}&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_zero_expr</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Model.kpi_value_by_name"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.kpi_value_by_name">[docs]</a>    <span class="k">def</span> <span class="nf">kpi_value_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">try_match</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">match_case</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return a KPI value from a KPI name.</span>

<span class="sd">        This method fetches a KPI value from a string, using either exact naming or trying</span>
<span class="sd">        to match a substring of the KPI name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The string to be matched.</span>
<span class="sd">            try_match: A Boolean. If True, returns KPI whose name is not equal to the</span>
<span class="sd">                argument, but contains it. Default is True.</span>
<span class="sd">            match_case: If True, looks for a case-exact match, else ignores case. Default is False.</span>
<span class="sd">            do_raise: If True, raise an exception when no KPI is found.</span>

<span class="sd">        Example:</span>
<span class="sd">            If the KPI name is &quot;Total CO2 Cost&quot; then fetching with argument &quot;co2&quot; and match_case to False</span>
<span class="sd">            will succeed. If match_case if True, then no KPI will be returned.</span>

<span class="sd">        Note:</span>
<span class="sd">            Expression KPIs require a valid solution to be computed. Make sure that the model contains</span>
<span class="sd">            a valid solution before computing an expression-based KPI, otherwise an exception will be raised.</span>
<span class="sd">            Functional KPIs do not require a valid solution.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The KPI value (a float).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpi_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">try_match</span><span class="p">,</span> <span class="n">match_case</span><span class="o">=</span><span class="n">match_case</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="n">do_raise</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">kpi</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_make_kpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpi_arg</span><span class="p">,</span> <span class="n">kpi_name</span><span class="p">):</span>
        <span class="c"># return a concrete instance of KPI</span>
        <span class="kn">from</span> <span class="nn">docplex.mp.kpi</span> <span class="kn">import</span> <span class="n">DecisionKPI</span><span class="p">,</span> <span class="n">FunctionalKPI</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">,</span> <span class="n">Expr</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DecisionKPI</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">,</span> <span class="n">kpi_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">,</span> <span class="n">Var</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DecisionKPI</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">,</span> <span class="n">kpi_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">,</span> <span class="n">DecisionKPI</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">DecisionKPI</span><span class="p">(</span><span class="n">kpi_arg</span><span class="o">.</span><span class="n">_dobj</span><span class="p">,</span> <span class="n">kpi_arg</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">,</span> <span class="n">FunctionalKPI</span><span class="p">):</span>
            <span class="n">other_fn_kpi</span> <span class="o">=</span> <span class="n">kpi_arg</span>
            <span class="k">return</span> <span class="n">FunctionalKPI</span><span class="p">(</span><span class="n">other_fn_kpi</span><span class="o">.</span><span class="n">_function</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other_fn_kpi</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">is_function</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">FunctionalKPI</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">kpi_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Cannot interpret this as a KPI: {0!s}. expecting expression, variable or function&quot;</span><span class="p">,</span> <span class="n">kpi_arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_kpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kpi_arg</span><span class="p">,</span> <span class="n">publish_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">new_kpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_kpi</span><span class="p">(</span><span class="n">kpi_arg</span><span class="p">,</span> <span class="n">publish_name</span><span class="p">)</span>
        <span class="n">new_kpi_name</span> <span class="o">=</span> <span class="n">new_kpi</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">new_kpi_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kpis_by_name</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Duplicate KPI name: {0!s}. KPI names must be unique&quot;</span><span class="p">,</span> <span class="n">new_kpi_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_kpis_by_name</span><span class="p">[</span><span class="n">new_kpi_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_kpi</span>
        <span class="k">return</span> <span class="n">new_kpi</span>

    <span class="k">def</span> <span class="nf">_check_progress_listener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">ProgressListener</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;Not a progress listener: {0!s}&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">add_progress_listener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listener</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_progress_listener</span><span class="p">(</span><span class="n">listener</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_progress_listeners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_progress_listener</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listener</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_progress_listener</span><span class="p">(</span><span class="n">listener</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_progress_listeners</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">listener</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_fire_start_solve_listeners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_progress_listeners</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">notify_start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_fire_end_solve_listeners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">has_solution</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_progress_listeners</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">notify_end</span><span class="p">(</span><span class="n">has_solution</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clear_progress_listeners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_progress_listeners</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">prettyprint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ModelPrettyPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">printModel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Model.clone"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Makes a deep copy of the model, possibly with a new name.</span>
<span class="sd">            Variables, constraints, and objective are copied.</span>

<span class="sd">        Args:</span>
<span class="sd">            new_name: The new name to use. If None is provided, returns a &quot;Copy of xxx&quot; where xxx is the original model name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of Model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">new_name</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">new_solver_code</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># INTERNAL</span>
        <span class="n">copy_name</span> <span class="o">=</span> <span class="n">new_name</span> <span class="ow">or</span> <span class="s">&quot;Copy of </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">copy_solver_code</span> <span class="o">=</span> <span class="n">new_solver_code</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver_code</span>
        <span class="n">copy_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">copy_name</span><span class="p">,</span> <span class="n">solver_code</span><span class="o">=</span><span class="n">copy_solver_code</span><span class="p">)</span>

        <span class="c"># clone variable containers</span>
        <span class="k">for</span> <span class="n">ctn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_var_containers</span><span class="p">():</span>
            <span class="n">copy_model</span><span class="o">.</span><span class="n">_add_var_container</span><span class="p">(</span><span class="n">ctn</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">copy_model</span><span class="p">))</span>

        <span class="c"># clone variables</span>
        <span class="n">var_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables</span><span class="p">():</span>
            <span class="n">copied_var</span> <span class="o">=</span> <span class="n">copy_model</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">vartype</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">lb</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">ub</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">var_mapping</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">copied_var</span>

        <span class="c"># clone constraints</span>
        <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_constraints</span><span class="p">():</span>
            <span class="n">copied_ct</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">copy_model</span><span class="p">,</span> <span class="n">var_mapping</span><span class="p">)</span>
            <span class="n">copy_model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">copied_ct</span><span class="p">,</span> <span class="n">ct</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="c"># clone objective</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_objective</span><span class="p">():</span>
            <span class="n">copy_model</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective_expr</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">copy_model</span><span class="p">,</span> <span class="n">var_mapping</span><span class="p">))</span>

        <span class="c"># clone kpis</span>
        <span class="k">for</span> <span class="n">kpi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_kpis</span><span class="p">():</span>
            <span class="n">copy_model</span><span class="o">.</span><span class="n">add_kpi</span><span class="p">(</span><span class="n">kpi</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">copy_model</span><span class="p">,</span> <span class="n">var_mapping</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_docloud_context</span><span class="p">:</span>
            <span class="n">copy_model</span><span class="o">.</span><span class="n">_docloud_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_docloud_context</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c"># clone params (some day)</span>
        <span class="k">return</span> <span class="n">copy_model</span>

    <span class="k">def</span> <span class="nf">_is_fully_indexed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        INTERNAL: Returns true if all objects have valid index, else None.</span>
<span class="sd">        :return: True if all variables and constraints have a valid index, else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">justifier</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">dv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">dv</span><span class="o">.</span><span class="n">has_valid_index</span><span class="p">():</span>
                <span class="n">justifier</span> <span class="o">=</span> <span class="n">dv</span>
                <span class="k">break</span>
        <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_constraints</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ct</span><span class="o">.</span><span class="n">has_valid_index</span><span class="p">():</span>
                <span class="n">justifier</span> <span class="o">=</span> <span class="n">ct</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">justifier</span> <span class="ow">is</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">refresh_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_setup</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="c"># compatibility with AbtractModel</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># compatibility with AbtractModel</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">is_free_lb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_lb</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">is_free_lb</span><span class="p">(</span><span class="n">var_lb</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_free_ub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_ub</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__factory</span><span class="o">.</span><span class="n">is_free_ub</span><span class="p">(</span><span class="n">var_ub</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sync_constraint_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct_iter</span><span class="p">):</span>
        <span class="c"># INTERNAL: check only when CPLEX is present.</span>
        <span class="n">self_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span>
        <span class="k">if</span> <span class="n">self_engine</span><span class="o">.</span><span class="n">has_cplex</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">ct</span> <span class="ow">in</span> <span class="n">ct_iter</span><span class="p">:</span>
                <span class="n">model_index</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>
                <span class="n">cpx_index</span> <span class="o">=</span> <span class="n">self_engine</span><span class="o">.</span><span class="n">get_ct_index</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">model_index</span> <span class="o">!=</span> <span class="n">cpx_index</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;indices differ, obj: {0!s}, docplex={1}, CPLEX={2}&quot;</span><span class="p">,</span>
                                             <span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">model_index</span><span class="p">,</span> <span class="n">cpx_index</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_sync_var_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">self_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span>
        <span class="k">if</span> <span class="n">self_engine</span><span class="o">.</span><span class="n">has_cplex</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">dvar</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_variables</span><span class="p">():</span>
                <span class="n">model_index</span> <span class="o">=</span> <span class="n">dvar</span><span class="o">.</span><span class="n">get_index</span><span class="p">()</span>
                <span class="n">cpx_index</span> <span class="o">=</span> <span class="n">self_engine</span><span class="o">.</span><span class="n">get_var_index</span><span class="p">(</span><span class="n">dvar</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">model_index</span> <span class="o">!=</span> <span class="n">cpx_index</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;indices differ, obj: {0!s}, docplex={1}, CPLEX={2}&quot;</span><span class="p">,</span>
                                             <span class="p">(</span><span class="n">dvar</span><span class="p">,</span> <span class="n">model_index</span><span class="p">,</span> <span class="n">cpx_index</span><span class="p">))</span>

<div class="viewcode-block" id="Model.end"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.end">[docs]</a>    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Terminates a model instance.</span>

<span class="sd">        Reclaims all memory consumed by the model.</span>
<span class="sd">        Reclaims memory allocated by CPLEX, if any.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_engine</span><span class="p">(</span><span class="n">restart</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_resolve_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_arg</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param_arg</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">):</span>
            <span class="n">parameter</span> <span class="o">=</span> <span class="n">param_arg</span>
        <span class="k">elif</span> <span class="n">is_int</span><span class="p">(</span><span class="n">param_arg</span><span class="p">):</span>
            <span class="c"># find parameter with this cplex id</span>
            <span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter_from_id</span><span class="p">(</span><span class="n">param_arg</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">parameter</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;No parameter with id: {0} - ignored&quot;</span><span class="p">,</span> <span class="n">param_arg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parameter</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;set_parameter expected Parameter instances or id, got: {0!s}&quot;</span><span class="p">,</span> <span class="n">param_arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parameter</span>

    <span class="k">def</span> <span class="nf">get_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_arg</span><span class="p">):</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_parameter</span><span class="p">(</span><span class="n">param_arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_parameter_internal</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">check_is_verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_parameter_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">check_is_verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_cplex_version</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">check_is_verbose</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">parameter</span><span class="o">.</span><span class="n">default_value</span>

<div class="viewcode-block" id="Model.parameter_from_id"><a class="viewcode-back" href="../../../docplex.mp.model.html#docplex.mp.model.Model.parameter_from_id">[docs]</a>    <span class="k">def</span> <span class="nf">parameter_from_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_cpx_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Finds a Parameter from a CPLEX id code.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameter_cpx_id: A cplex parameter id (positive integer, e.g. 2009 is mipgap).</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of Parameter, if found, else None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">parameter_cpx_id</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">generate_params</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">cpx_id</span> <span class="o">==</span> <span class="n">parameter_cpx_id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">p</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
</div>
    <span class="k">def</span> <span class="nf">set_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_arg</span><span class="p">,</span> <span class="n">raw_value</span><span class="p">):</span>
        <span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_parameter</span><span class="p">(</span><span class="n">param_arg</span><span class="p">)</span>
        <span class="c"># check the value, else raise error</span>
        <span class="n">new_value</span> <span class="o">=</span> <span class="n">parameter</span><span class="o">.</span><span class="n">check_value</span><span class="p">(</span><span class="n">raw_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_cplex_version</span><span class="p">()</span> <span class="ow">and</span> <span class="n">new_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__engine</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span> <span class="n">new_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reset_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_cplex_version</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># None argument, reset all params</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_iterable</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reset_parameter</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_parameter</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="n">param</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">default_value</span><span class="p">)</span>


    <span class="c"># with protocol</span>
    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="c"># terminate the model upon exiting a &#39;with&#39; block.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="c"># implements the &quot;+=&quot; dialect a la PulP</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">AbstractConstraint</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fatal</span><span class="p">(</span><span class="s">&quot;Model += can only be used with constraints, not with: {0!s}&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">ct</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">ctname</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

</div>
<span class="k">class</span> <span class="nc">AbstractModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">output_level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">solver_code</span><span class="o">=</span><span class="s">&#39;default&#39;</span><span class="p">,</span> <span class="n">docloud_context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">Model</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                       <span class="n">output_level</span><span class="o">=</span><span class="n">output_level</span><span class="p">,</span>
                       <span class="n">solver_code</span><span class="o">=</span><span class="n">solver_code</span><span class="p">,</span>
                       <span class="n">docloud_context</span><span class="o">=</span><span class="n">docloud_context</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_data_args</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">expected_sizemin</span><span class="p">,</span> <span class="n">do_raise</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Empty data collection&quot;</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">expected_sizemin</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;Missing data: expecting </span><span class="si">%d</span><span class="s"> collections, got: </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">expected_sizemin</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">do_raise</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DOcplexException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Redefine this function to return False if some data is invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">setup_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">setup_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">setup_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Redefine this method to set the objective.</span>
<span class="sd">        This is not mandatory as a model might not have any objective.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">pass</span>  <span class="c"># pragma: no cover</span>

    <span class="c"># noinspection PyMethodMayBeStatic</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Redefine this method to check the model before solve.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">setup_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">post_process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Setup the model artifacts, raise exception if data are not correct.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_variables</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_constraints</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_objective</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;model is invalid, setup stops&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ensure_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">ensure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(),</span> <span class="s">&quot;Model is not valid&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_empty</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">restart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Called to restart the model in an empty state.</span>

<span class="sd">        The underlying model is also restarted to a clean and empty state.</span>
<span class="sd">        All modeling objects previsouly defined and stored in the model are discarded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c"># if the superclass does not call the parent class, make sure...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_internal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_engine</span><span class="p">(</span><span class="n">restart</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">refresh_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_setup</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Clears all model elements plus sets a new engine.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">do_setup</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ensure_setup</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">before_solve_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This method is called just before solve inside a run.</span>
<span class="sd">        Redefine to get some particular behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">prints_info</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_information</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_handler</span><span class="o">.</span><span class="n">prints_trace</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">export_as_lp</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">basename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">exchange_format</span><span class="o">=</span><span class="n">LP_format</span><span class="p">):</span>
        <span class="c"># INTERNAL: redefine export at this stage to ensure model is setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensure_setup</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Model</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">basename</span><span class="p">,</span> <span class="n">hide_user_names</span><span class="p">,</span> <span class="n">exchange_format</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_silent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docloud_context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># make sure th emodel is setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensure_setup</span><span class="p">()</span>
        <span class="c"># check data and model if necessary (ddefault is do nothing)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
        <span class="c"># insert some last minute code before solve.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">before_solve_hook</span><span class="p">()</span>
        <span class="c"># call solve_run which by default calls solve</span>
        <span class="n">ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_run</span><span class="p">(</span><span class="n">docloud_context</span><span class="o">=</span><span class="n">docloud_context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">post_process</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ok</span>

    <span class="k">def</span> <span class="nf">solve_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docloud_context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">docloud_context</span><span class="o">=</span><span class="n">docloud_context</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docloud_context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_silent</span><span class="p">(</span><span class="n">docloud_context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ok</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DOcplex Preview 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, IBM CPLEX.
    </div>
  </body>
</html>