

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>docplex.cp.utils &#8212; DOcplex.CP: Constraint Programming Modeling for Python V2.18 documentation</title>
    <link rel="stylesheet" href="../../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DOcplex.CP: Constraint Programming Modeling for Python V2.18 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for docplex.cp.utils</h1><div class="highlight"><pre>
<span></span><span class="c1"># --------------------------------------------------------------------------</span>
<span class="c1"># Source file provided under Apache License, Version 2.0, January 2004,</span>
<span class="c1"># http://www.apache.org/licenses/</span>
<span class="c1"># (c) Copyright IBM Corp. 2015, 2016, 2017, 2018</span>
<span class="c1"># --------------------------------------------------------------------------</span>
<span class="c1"># Author: Olivier OUDOT, IBM Analytics, France Lab, Sophia-Antipolis</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Miscellaneous utility functions. Some of theme are here to prevent possible</span>
<span class="sd">port problems between the different versions of Python.</span>

<span class="sd">This module is theoretically not public, but documented because some public classes are extending</span>
<span class="sd">classes defined here.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">gzip</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">deque</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections.abc</span> <span class="k">import</span> <span class="n">Iterable</span>  <span class="c1"># Python &gt;= 3.7</span>
<span class="k">except</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">Iterable</span>      <span class="c1"># Python &lt; 3.7</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">StringIO</span> <span class="k">import</span> <span class="n">StringIO</span>  <span class="c1"># Python 2</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">StringIO</span>        <span class="c1"># Python 3</span>


<span class="c1">###############################################################################</span>
<span class="c1">## Constants</span>
<span class="c1">###############################################################################</span>

<span class="c1"># Python 2 indicator</span>
<span class="n">IS_PYTHON_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Check if numpy is available</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="n">IS_NUMPY_AVAILABLE</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">NUMPY_NDARRAY</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IS_NUMPY_AVAILABLE</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">NUMPY_NDARRAY</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Check if panda is available</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pandas</span>
    <span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">Series</span> <span class="k">as</span> <span class="n">PandaSeries</span>
    <span class="n">IS_PANDA_AVAILABLE</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IS_PANDA_AVAILABLE</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Constant used to indicate to set a parameter to its default value</span>
<span class="c1"># Useful if default value is not static</span>
<span class="n">DEFAULT</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>

<span class="c1"># Platform type</span>
<span class="n">IS_WINDOWS</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span>


<span class="c1">###############################################################################</span>
<span class="c1">## Public classes</span>
<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="CpoException"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.CpoException">[docs]</a><span class="k">class</span> <span class="nc">CpoException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Exception thrown in case of CPO errors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a new exception</span>

<span class="sd">        Args:</span>
<span class="sd">            msg: Error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CpoException</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="CpoNotSupportedException"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.CpoNotSupportedException">[docs]</a><span class="k">class</span> <span class="nc">CpoNotSupportedException</span><span class="p">(</span><span class="n">CpoException</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Exception thrown when a CPO function is not supported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a new exception</span>

<span class="sd">        Args:</span>
<span class="sd">            msg: Error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CpoNotSupportedException</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="Context"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context">[docs]</a><span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Class handling miscellaneous list of parameters. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a new context</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: List of key=value to initialize context with.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Context</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a context parameter.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:  Parameter name</span>
<span class="sd">            value: Parameter value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get a context parameter.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:  Parameter name</span>
<span class="sd">        Return:</span>
<span class="sd">            Parameter value, None if not set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


<div class="viewcode-block" id="Context.set_attribute"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.set_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a context attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:  Attribute name</span>
<span class="sd">            value: Attribute value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
            <span class="nb">vars</span><span class="p">(</span><span class="n">value</span><span class="p">)[</span><span class="s1">&#39;parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="Context.get_attribute"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.get_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get a context attribute.</span>

<span class="sd">        This method search first attribute in this context. If not found, it moves up to</span>
<span class="sd">        parent context, and continues as long as not found or root is reached.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:    Attribute name</span>
<span class="sd">            default: Optional, default value if attribute is absent</span>
<span class="sd">        Return:</span>
<span class="sd">            Attribute value, default value if not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ctx</span><span class="p">:</span>
               <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default</span></div>


<div class="viewcode-block" id="Context.del_attribute"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.del_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">del_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Remove a context attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:    Attribute name</span>
<span class="sd">        Return:</span>
<span class="sd">            True if attribute has been removed, False if it was not present</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                <span class="nb">vars</span><span class="p">(</span><span class="n">value</span><span class="p">)[</span><span class="s1">&#39;parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">del</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Context.set_by_path"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.set_by_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_by_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a context attribute using its path.</span>

<span class="sd">        Attribute path is a sequence of attribute names separated by dots.</span>

<span class="sd">        Args:</span>
<span class="sd">            path:   Attribute path</span>
<span class="sd">            value:  Attribute value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">trgt</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># Go down in sub-contexts</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">path</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">sc</span> <span class="o">=</span> <span class="n">trgt</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">sc</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
                <span class="n">trgt</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">sc</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Attribute &#39;&quot;</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="s2">&quot;&#39; should be a Context&quot;</span><span class="p">)</span>
            <span class="n">trgt</span> <span class="o">=</span> <span class="n">sc</span>
        <span class="c1"># Set final value</span>
        <span class="n">trgt</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="Context.get_by_path"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.get_by_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_by_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get a context attribute using its path.</span>

<span class="sd">        Attribute path is a sequence of attribute names separated by dots.</span>

<span class="sd">        Args:</span>
<span class="sd">            path:    Attribute path</span>
<span class="sd">            default: Optional, default value if attribute is not found</span>
<span class="sd">        Return:</span>
<span class="sd">            Attribute value, default value if not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">default</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="Context.search_and_replace_attribute"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.search_and_replace_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">search_and_replace_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Replace an existing attribute.</span>

<span class="sd">        The attribute is searched first as a value in this context node.</span>
<span class="sd">        If not found, it is searched recursively in children contexts, in alphabetical order.</span>

<span class="sd">        Args:</span>
<span class="sd">            name:  Attribute name</span>
<span class="sd">            value: Attribute value, None to remove attribute</span>
<span class="sd">            path:  Path of the current node. default is &#39;&#39;</span>
<span class="sd">        Return:</span>
<span class="sd">            Full path of the attribute that has been found and replaced, None if not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sctxs</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of subcontexts</span>
        <span class="c1"># Search first in atomic values</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                <span class="n">sctxs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">ov</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">npath</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">k</span> <span class="k">if</span> <span class="n">path</span> <span class="k">else</span> <span class="n">k</span>
                    <span class="k">if</span> <span class="n">ov</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ov</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Attribute &#39;&quot;</span> <span class="o">+</span> <span class="n">npath</span> <span class="o">+</span> <span class="s2">&quot;&#39; is a Context and can only be replaced by a Context&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">npath</span>
        <span class="c1"># Search then in sub-contexts</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sctxs</span><span class="p">:</span>
            <span class="n">npath</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">k</span> <span class="k">if</span> <span class="n">path</span> <span class="k">else</span> <span class="n">k</span>
            <span class="n">apth</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">search_and_replace_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">npath</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">apth</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">apth</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Context.get_parent"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.get_parent">[docs]</a>    <span class="k">def</span> <span class="nf">get_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the parent context.</span>

<span class="sd">        Each time a context attribute is set to a context, its parent is assigned to the context where it is stored.</span>

<span class="sd">        Return:</span>
<span class="sd">            Parent context, None if this context is root</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;parent&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="Context.get_root"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.get_root">[docs]</a>    <span class="k">def</span> <span class="nf">get_root</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the root context (last parent with no parent).</span>

<span class="sd">        Return:</span>
<span class="sd">            Root context</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">pp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">pp</span>
            <span class="n">pp</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="Context.clone"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clone this context and all sub-contexts recursively.</span>

<span class="sd">        Return:</span>
<span class="sd">            Cloned copy of this context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="n">res</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="Context.add"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add another context to this one.</span>

<span class="sd">        All attributes of given context are set in this one, replacing previous value if any.</span>
<span class="sd">        If one value is another context, it is cloned before being set.</span>

<span class="sd">        Args:</span>
<span class="sd">            ctx:  Other context to add to this one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ctx</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span></div>


<div class="viewcode-block" id="Context.is_log_enabled"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.is_log_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">is_log_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vrb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if log is enabled for a given verbosity</span>

<span class="sd">        This method get this context &#39;log_output&#39; attribute to retrieve the log output, and the</span>
<span class="sd">        attribute &#39;verbose&#39; to retrieve the current verbosity level.</span>

<span class="sd">        Args:</span>
<span class="sd">            vrb:  Required verbosity level, None for always</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_output</span> <span class="ow">and</span> <span class="p">((</span><span class="n">vrb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;=</span> <span class="n">vrb</span><span class="p">)))</span></div>


<div class="viewcode-block" id="Context.get_log_output"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.get_log_output">[docs]</a>    <span class="k">def</span> <span class="nf">get_log_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get this context log output</span>

<span class="sd">        This method returns the log_output defined in attribute &#39;log_output&#39; and convert</span>
<span class="sd">        it to sys.stdout if its value is True</span>

<span class="sd">        Returns:</span>
<span class="sd">            Log output stream, None if none</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_output</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="k">if</span> <span class="n">out</span> <span class="o">==</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">out</span></div>


<div class="viewcode-block" id="Context.log"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.log">[docs]</a>    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vrb</span><span class="p">,</span> <span class="o">*</span><span class="n">msg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Log a message if log is enabled with enough verbosity</span>

<span class="sd">        This method get this context &#39;log_output&#39; attribute to retrieve the log output, and the</span>
<span class="sd">        attribute &#39;verbose&#39; to retrieve the current verbosity level.</span>

<span class="sd">        Args:</span>
<span class="sd">            vrb:  Required verbosity level, None for always</span>
<span class="sd">            msg:  Message elements to log (concatenated on one line)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_log_enabled</span><span class="p">(</span><span class="n">vrb</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_log_output</span><span class="p">()</span>
            <span class="n">prfx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_prefix</span>
            <span class="k">if</span> <span class="n">prfx</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">prfx</span><span class="p">))</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">out</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>


<div class="viewcode-block" id="Context.print_context"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.print_context">[docs]</a>    <span class="k">def</span> <span class="nf">print_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Print this context.</span>

<span class="sd">        At each level, atomic values are printed first, then sub-contexts, in alphabetical order.</span>

<span class="sd">        DEPRECATED. Use :meth:`write` instead.</span>

<span class="sd">        Args:</span>
<span class="sd">            out (Optional):    Target output stream or file name. If not given, default value is sys.stdout.</span>
<span class="sd">            indent (Optional): Start line indentation. Default is empty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span></div>


<div class="viewcode-block" id="Context.write"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Context.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Write this context.</span>

<span class="sd">        At each level, atomic values are printed first, then sub-contexts, in alphabetical order.</span>

<span class="sd">        If the given output is a string, it is considered as a file name that is opened by this method</span>
<span class="sd">        using &#39;utf-8&#39; encoding.</span>

<span class="sd">        Args:</span>
<span class="sd">            out (Optional):    Target output stream or file name. If not given, default value is sys.stdout.</span>
<span class="sd">            indent (Optional): Start line indentation. Default is empty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check file</span>
        <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">out</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">open_utf8</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="c1"># Check default output</span>
        <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

        <span class="n">sctxs</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of subcontexts</span>
        <span class="c1"># Print atomic values</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Context</span><span class="p">):</span>
                <span class="n">sctxs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                    <span class="c1"># Check if value must be masked</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;secret&quot;</span><span class="p">):</span>
                        <span class="n">v</span> <span class="o">=</span> <span class="s2">&quot;**********&quot;</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>
                    <span class="n">vstr</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vstr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="n">vstr</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Print sub-contexts</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sctxs</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">v</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="IdAllocator"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.IdAllocator">[docs]</a><span class="k">class</span> <span class="nc">IdAllocator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Allocator of identifiers.</span>

<span class="sd">    This implementation is not thread-safe.</span>
<span class="sd">    Use SafeIdAllocator for a usage in a multi-thread environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;prefix&#39;</span><span class="p">,</span>  <span class="c1"># Id prefix</span>
                 <span class="s1">&#39;count&#39;</span><span class="p">,</span>   <span class="c1"># Allocated id count</span>
                 <span class="s1">&#39;bdgts&#39;</span><span class="p">,</span>   <span class="c1"># Count printing base digits</span>
                 <span class="p">)</span>
    <span class="n">DIGITS</span> <span class="o">=</span> <span class="s2">&quot;0123456789&quot;</span>
    <span class="n">LETTERS_AND_DIGITS</span> <span class="o">=</span> <span class="s2">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">bdgts</span><span class="o">=</span><span class="s2">&quot;0123456789&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a new id allocator.</span>

<span class="sd">        Args:</span>
<span class="sd">            prefix:  Prefix of all ids</span>
<span class="sd">            bdgts:   List of digit characters to be use for counter conversion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IdAllocator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bdgts</span> <span class="o">=</span> <span class="n">bdgts</span>

<div class="viewcode-block" id="IdAllocator.get_prefix"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.IdAllocator.get_prefix">[docs]</a>    <span class="k">def</span> <span class="nf">get_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the name prefix used by this allocator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Name prefix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span></div>

<div class="viewcode-block" id="IdAllocator.get_count"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.IdAllocator.get_count">[docs]</a>    <span class="k">def</span> <span class="nf">get_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the number of id that has been allocated by this allocator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Number of id that has been allocated by this allocator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span></div>

<div class="viewcode-block" id="IdAllocator.allocate"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.IdAllocator.allocate">[docs]</a>    <span class="k">def</span> <span class="nf">allocate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Allocate a new id.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Next id for this allocator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">bdgts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdgts</span>
        <span class="n">blen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdgts</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
           <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bdgts</span><span class="p">[</span><span class="n">cnt</span> <span class="o">%</span> <span class="n">blen</span><span class="p">])</span>
           <span class="n">cnt</span> <span class="o">//=</span> <span class="n">blen</span>
        <span class="n">res</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SafeIdAllocator"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.SafeIdAllocator">[docs]</a><span class="k">class</span> <span class="nc">SafeIdAllocator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Allocator of identifiers.</span>

<span class="sd">    This implementation uses a lock to protect the increment of the counter,</span>
<span class="sd">    allowing to use it by multiple threads.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;prefix&#39;</span><span class="p">,</span>  <span class="c1"># Id prefix</span>
                 <span class="s1">&#39;count&#39;</span><span class="p">,</span>   <span class="c1"># Allocated id count</span>
                 <span class="s1">&#39;bdgts&#39;</span><span class="p">,</span>   <span class="c1"># Count printing base digits</span>
                 <span class="s1">&#39;lock&#39;</span><span class="p">,</span>    <span class="c1"># Lock to protect counter</span>
                 <span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">bdgts</span><span class="o">=</span><span class="s2">&quot;0123456789&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a new id allocator.</span>

<span class="sd">        Args:</span>
<span class="sd">            prefix:  Prefix of all ids</span>
<span class="sd">            bdgts:   (Optional) List of digit characters to be use for counter conversion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SafeIdAllocator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bdgts</span> <span class="o">=</span> <span class="n">bdgts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

<div class="viewcode-block" id="SafeIdAllocator.get_prefix"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.SafeIdAllocator.get_prefix">[docs]</a>    <span class="k">def</span> <span class="nf">get_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the name prefix used by this allocator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Name prefix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span></div>

<div class="viewcode-block" id="SafeIdAllocator.get_count"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.SafeIdAllocator.get_count">[docs]</a>    <span class="k">def</span> <span class="nf">get_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the number of id that has been allocated by this allocator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Number of id that has been allocated by this allocator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span></div>

<div class="viewcode-block" id="SafeIdAllocator.allocate"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.SafeIdAllocator.allocate">[docs]</a>    <span class="k">def</span> <span class="nf">allocate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Allocate a new id</span>

<span class="sd">        Returns:</span>
<span class="sd">            Next id for this allocator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">bdgts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdgts</span>
        <span class="n">blen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdgts</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
           <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bdgts</span><span class="p">[</span><span class="n">cnt</span> <span class="o">%</span> <span class="n">blen</span><span class="p">])</span>
           <span class="n">cnt</span> <span class="o">//=</span> <span class="n">blen</span>
        <span class="n">res</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>

<div class="viewcode-block" id="SafeIdAllocator.reset"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.SafeIdAllocator.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reset the allocator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span></div></div>


<div class="viewcode-block" id="KeyIdDict"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.KeyIdDict">[docs]</a><span class="k">class</span> <span class="nc">KeyIdDict</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Dictionary using id of the key objects as key.</span>

<span class="sd">    This object allows to use any Python object as key (with no __hash__() function),</span>
<span class="sd">    and to map a value on the physical instance of the key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;kdict&#39;</span><span class="p">,</span>  <span class="c1"># Dictionary of objects</span>
                 <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">KeyIdDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kdict</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="KeyIdDict.set"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.KeyIdDict.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a value in the dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            key:   Key</span>
<span class="sd">            value: Value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kid</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="c1"># Store value and original key, to not garbage it and preserve its id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kdict</span><span class="p">[</span><span class="n">kid</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="KeyIdDict.get"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.KeyIdDict.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get a value from the dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            key:     Key</span>
<span class="sd">            default: Default value if not found. Default is None.</span>
<span class="sd">        Returns:</span>
<span class="sd">            Value corresponding to the key, default value (None) if not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kid</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kdict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kid</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">default</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="KeyIdDict.keys"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.KeyIdDict.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the list of all keys &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kdict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span></div>

<div class="viewcode-block" id="KeyIdDict.values"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.KeyIdDict.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the list of all values &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kdict</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span></div>

<div class="viewcode-block" id="KeyIdDict.clear"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.KeyIdDict.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clear all dictionary content &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kdict</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of elements in this dictionary &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kdict</span><span class="p">)</span></div>


<div class="viewcode-block" id="ObjectCache"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCache">[docs]</a><span class="k">class</span> <span class="nc">ObjectCache</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Limited size object cache.</span>

<span class="sd">    This object allows to associate an object to a key.</span>
<span class="sd">    This cache is limited in size. This means that, if the max size is reached, adding a new</span>
<span class="sd">    object removes the oldest.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;obj_dict&#39;</span><span class="p">,</span>  <span class="c1"># Dictionary of objects</span>
                 <span class="s1">&#39;max_size&#39;</span><span class="p">,</span>  <span class="c1"># Max cache size</span>
                 <span class="s1">&#39;key_list&#39;</span><span class="p">,</span>  <span class="c1"># Ordered list of objects keys in the cache</span>
                 <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ObjectCache</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">=</span> <span class="n">maxsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_list</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>

<div class="viewcode-block" id="ObjectCache.set"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCache.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a value in the cache</span>

<span class="sd">        Args:</span>
<span class="sd">            key:   Key</span>
<span class="sd">            value: Value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if key already in cache</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="p">:</span>
            <span class="c1"># Just replace the value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Remove older object if max size is reached</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>
            <span class="c1"># Store new object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectCache.get"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCache.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get a value from the cache</span>

<span class="sd">        Args:</span>
<span class="sd">            key:  Key</span>
<span class="sd">        Returns:</span>
<span class="sd">            Value corresponding to the key, None if not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectCache.keys"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCache.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the list of all keys &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectCache.values"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCache.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the list of all values &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></div>

<div class="viewcode-block" id="ObjectCache.size"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCache.size">[docs]</a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the current size of the cache &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectCache.clear"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCache.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clear all dictionary content &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of elements in this dictionary &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="p">)</span></div>


<div class="viewcode-block" id="ObjectCacheById"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCacheById">[docs]</a><span class="k">class</span> <span class="nc">ObjectCacheById</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Object cache that uses object id as key.</span>

<span class="sd">    This object allows to associate an object to a key.</span>
<span class="sd">    It is implemented using a dict that uses the id of the key as dict key.</span>
<span class="sd">    This allows to:</span>
<span class="sd">     * Use any Python object as key, even if it does not implement __hash__() function,</span>
<span class="sd">     * Use different key objects that are logically equal</span>

<span class="sd">    This cache is limited in size. This means that, if the max size is reached, adding a new</span>
<span class="sd">    object will remove the oldest.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;obj_dict&#39;</span><span class="p">,</span>  <span class="c1"># Dictionary of objects</span>
                 <span class="s1">&#39;max_size&#39;</span><span class="p">,</span>  <span class="c1"># Max cache size</span>
                 <span class="s1">&#39;key_list&#39;</span><span class="p">,</span>  <span class="c1"># Ordered list of objects keys in the cache</span>
                 <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ObjectCacheById</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span> <span class="o">=</span> <span class="n">maxsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_list</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>

<div class="viewcode-block" id="ObjectCacheById.set"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCacheById.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a value in the cache.</span>

<span class="sd">        Args:</span>
<span class="sd">            key:   Key</span>
<span class="sd">            value: Value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kid</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="c1"># Check if key already in cache</span>
        <span class="k">if</span> <span class="n">kid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="p">:</span>
            <span class="c1"># Just replace the value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="p">[</span><span class="n">kid</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Remove older object if max size is reached</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="o">.</span><span class="n">popleft</span><span class="p">()))</span>
            <span class="c1"># Store new object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="p">[</span><span class="n">kid</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="c1"># Append key in deque (side effect is that key is preserved to preserve its id)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectCacheById.get"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCacheById.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get a value from the cache.</span>

<span class="sd">        Args:</span>
<span class="sd">            key:  Key</span>
<span class="sd">        Returns:</span>
<span class="sd">            Value corresponding to the key, None if not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">key</span><span class="p">))</span></div>

<div class="viewcode-block" id="ObjectCacheById.keys"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCacheById.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the list of all keys &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="ObjectCacheById.values"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCacheById.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the list of all values &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></div>

<div class="viewcode-block" id="ObjectCacheById.clear"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ObjectCacheById.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clear all dictionary content &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of elements in this dictionary &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj_dict</span><span class="p">)</span></div>


<div class="viewcode-block" id="IdentityAccessor"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.IdentityAccessor">[docs]</a><span class="k">class</span> <span class="nc">IdentityAccessor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Object implementing a __getitem__ that returns the key as value. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">key</span></div>


<div class="viewcode-block" id="TextFileLineReader"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.TextFileLineReader">[docs]</a><span class="k">class</span> <span class="nc">TextFileLineReader</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Reader for text files, possibly compressed using gzip &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span>     <span class="c1"># Input stream</span>
                 <span class="s1">&#39;encoding&#39;</span><span class="p">,</span>  <span class="c1"># Character encoding</span>
                 <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a text file line reader.</span>

<span class="sd">        Args:</span>
<span class="sd">            file:      File name</span>
<span class="sd">            encoding:  (Optional) Character encoding, UTF-8 by default</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.gz&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.zip&quot;</span><span class="p">:</span>
            <span class="n">zfile</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="n">lfiles</span> <span class="o">=</span> <span class="n">zfile</span><span class="o">.</span><span class="n">infolist</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lfiles</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Zip file does not contains a single entry&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">zfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">lfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="n">encoding</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Release resources. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<div class="viewcode-block" id="TextFileLineReader.close"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.TextFileLineReader.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Close this reader. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="TextFileLineReader.readline"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.TextFileLineReader.readline">[docs]</a>    <span class="k">def</span> <span class="nf">readline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read next line of text.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Next line of text, including ending end of line character, empty line if end of file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check input already closed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="c1"># Process case where read is done in a compressed file</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">line</span></div></div>


<div class="viewcode-block" id="Chrono"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Chrono">[docs]</a><span class="k">class</span> <span class="nc">Chrono</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Chronometer &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;startTime&#39;</span><span class="p">,</span>  <span class="c1"># Chrono start time</span>
                 <span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a new chronometer initialized with current time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Chrono</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restart</span><span class="p">()</span>

<div class="viewcode-block" id="Chrono.get_start"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Chrono.get_start">[docs]</a>    <span class="k">def</span> <span class="nf">get_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the chrono start time.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Time when chronometer has been started</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">startTime</span></div>

<div class="viewcode-block" id="Chrono.get_elapsed"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Chrono.get_elapsed">[docs]</a>    <span class="k">def</span> <span class="nf">get_elapsed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the chrono elapsed time.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Time spent from chronometer start time (float), in seconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">startTime</span></div>

<div class="viewcode-block" id="Chrono.restart"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Chrono.restart">[docs]</a>    <span class="k">def</span> <span class="nf">restart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Restart chrono to current time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Convert this chronometer into a string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            String of the chrono elapsed time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_elapsed</span><span class="p">())</span></div>


<div class="viewcode-block" id="Barrier"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Barrier">[docs]</a><span class="k">class</span> <span class="nc">Barrier</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Barrier blocking multiple threads.</span>

<span class="sd">    This class implements a simple barrier with no timeout.</span>
<span class="sd">    Implemented here because not available in Python 2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;parties&#39;</span><span class="p">,</span>  <span class="c1"># Number of parties required before unlocking the barrier</span>
                 <span class="s1">&#39;count&#39;</span><span class="p">,</span>    <span class="c1"># Number of waiting parties</span>
                 <span class="s1">&#39;lock&#39;</span><span class="p">,</span>     <span class="c1"># Counters protection lock</span>
                 <span class="s1">&#39;barrier&#39;</span>   <span class="c1"># Threads blocking lock</span>
                 <span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parties</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a new barrier</span>

<span class="sd">        Args:</span>
<span class="sd">            parties:  Number of parties required before unlocking the barrier</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parties</span> <span class="o">=</span> <span class="n">parties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barrier</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barrier</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>

<div class="viewcode-block" id="Barrier.wait"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.Barrier.wait">[docs]</a>    <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Wait for the barrier</span>
<span class="sd">        This method blocks the calling thread until required number of threads has called this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">parties</span><span class="p">:</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">barrier</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barrier</span><span class="o">.</span><span class="n">release</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="FunctionCache"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.FunctionCache">[docs]</a><span class="k">class</span> <span class="nc">FunctionCache</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Object caching the result of a function.</span>
<span class="sd">    Future calls with same parameters returns a result stored in a cache dictionary.</span>

<span class="sd">    This object is not thread-safe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">,</span>  <span class="c1"># Function returned values. Key is the parameters passed to the function,</span>
                            <span class="c1"># value is function result if function has already been called.</span>
                 <span class="s1">&#39;lock&#39;</span><span class="p">,</span>    <span class="c1"># Lock protecting values dictionary</span>
                 <span class="s1">&#39;funct&#39;</span><span class="p">,</span>   <span class="c1"># Function whose results is cached.</span>
                 <span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            f:  Function whose results should be cached.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funct</span> <span class="o">=</span> <span class="n">f</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

<div class="viewcode-block" id="FunctionCache.get"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.FunctionCache.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">param</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the function result for a given parameter</span>
<span class="sd">        Args:</span>
<span class="sd">            param:  Function parameters</span>
<span class="sd">        Returns:</span>
<span class="sd">            Function result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># First check if None is the actual result</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="c1"># Call function to get actual result</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">funct</span><span class="p">(</span><span class="o">*</span><span class="n">param</span><span class="p">)</span>
            <span class="c1"># Add result to the cache</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="FunctionCache.clear"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.FunctionCache.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clear all dictionary content &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the number of elements in this cache &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>


<div class="viewcode-block" id="InfoDict"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.InfoDict">[docs]</a><span class="k">class</span> <span class="nc">InfoDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Dictionary used to store information of various types.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="InfoDict.incr"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.InfoDict.incr">[docs]</a>    <span class="k">def</span> <span class="nf">incr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Increment the value of an attribute considered as a number.</span>

<span class="sd">        If the attribute is not already in the dictionary, it is set to the given increment value.</span>

<span class="sd">        Args:</span>
<span class="sd">            key:  Attribute key</span>
<span class="sd">            val:  Value to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">val</span></div>


<div class="viewcode-block" id="InfoDict.clone"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.InfoDict.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clone this information dictionary</span>

<span class="sd">        Returns:</span>
<span class="sd">            New information dictionary, cloned copy of this one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">InfoDict</span><span class="p">()</span>
        <span class="n">res</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="InfoDict.print_infos"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.InfoDict.print_infos">[docs]</a>    <span class="k">def</span> <span class="nf">print_infos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Print this information structure.</span>

<span class="sd">        Attributes are sorted in alphabetical order</span>

<span class="sd">        If the given output is a string, it is considered as a file name that is opened by this method</span>
<span class="sd">        using &#39;utf-8&#39; encoding.</span>

<span class="sd">        DEPRECATED. Use :meth:`write` instead.</span>

<span class="sd">        Args:</span>
<span class="sd">            out (Optional):    Target output stream or file name. If not given, default value is sys.stdout.</span>
<span class="sd">            indent (Optional): Start line indentation. Default is empty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span></div>


<div class="viewcode-block" id="InfoDict.write"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.InfoDict.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Write this information structure.</span>

<span class="sd">        Attributes are sorted in alphabetical order</span>

<span class="sd">        If the given output is a string, it is considered as a file name that is opened by this method</span>
<span class="sd">        using &#39;utf-8&#39; encoding.</span>

<span class="sd">        Args:</span>
<span class="sd">            out (Optional):    Target output stream or file name. If not given, default value is sys.stdout.</span>
<span class="sd">            indent (Optional): Start line indentation. Default is empty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check file</span>
        <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">out</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">open_utf8</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="c1"># Check default output</span>
        <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

        <span class="c1"># Get sorted list of keys</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
            <span class="c1"># Print attributes</span>
            <span class="n">mxlen</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="p">(</span><span class="n">mxlen</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span> <span class="o">+</span> <span class="s2">&quot; : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot;none</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="ListDict"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ListDict">[docs]</a><span class="k">class</span> <span class="nc">ListDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Dictionary specialized to associate lists to the keys.</span>

<span class="sd">    This class is a dictionary that enables to associate to each key a list of values.</span>
<span class="sd">    When adding a value, key and list are created if not present, otherwise element is added to the existing list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ListDict.append"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.ListDict.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; append a value to the list associated to a key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key:  Attribute key</span>
<span class="sd">            val:  Value to add to this key list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div></div>



<span class="c1">###############################################################################</span>
<span class="c1">## Public functions</span>
<span class="c1">###############################################################################</span>

<div class="viewcode-block" id="check_default"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.check_default">[docs]</a><span class="k">def</span> <span class="nf">check_default</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check that an argument value is DEFAULT and returns the default value if so.</span>

<span class="sd">    This method has to be used in conjunction with usage of the DEFAULT constant as</span>
<span class="sd">    default value of a parameter. It allows to assign a parameter to a default value</span>
<span class="sd">    that can be computed dynamically.</span>

<span class="sd">    Args:</span>
<span class="sd">        val:     Value to check</span>
<span class="sd">        default: Default value to return if val is DEFAULT</span>
<span class="sd">    Returns:</span>
<span class="sd">        val if val is different from DEFAULT, default otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">default</span> <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="n">DEFAULT</span><span class="p">)</span> <span class="k">else</span> <span class="n">val</span></div>


<div class="viewcode-block" id="replace_in_tuple"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.replace_in_tuple">[docs]</a><span class="k">def</span> <span class="nf">replace_in_tuple</span><span class="p">(</span><span class="n">tpl</span><span class="p">,</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Replace a value in a tuple.</span>

<span class="sd">    A new tuple is created with one value changed by another.</span>

<span class="sd">    Args:</span>
<span class="sd">        tpl:     Source tuple</span>
<span class="sd">        ndx:  Index of the tuple value to change</span>
<span class="sd">        val:  new value</span>
<span class="sd">    Returns:</span>
<span class="sd">        New tuple with value at position &#39;ndx&#39; replaced by &#39;val&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tpl</span><span class="p">)</span>
    <span class="n">lst</span><span class="p">[</span><span class="n">ndx</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span></div>


<div class="viewcode-block" id="replace"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.replace">[docs]</a><span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">rfun</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Build a copy of a source object and apply a replacement function on all its attributes.</span>

<span class="sd">    If an object is not changed, its original version is returned.</span>

<span class="sd">    Args:</span>
<span class="sd">       obj:  Source object</span>
<span class="sd">       rfun: Value replacement function</span>
<span class="sd">    Returns:</span>
<span class="sd">        Copy of source object with all values replaced, or same object if no value has been replaced.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if object is immediately replaceable</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">nobj</span> <span class="o">=</span> <span class="n">rfun</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="c1"># Check case where replace function force to keep same object</span>
        <span class="k">if</span> <span class="n">nobj</span> <span class="ow">is</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">nobj</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="c1"># Check basic types (also eliminates strings)</span>
    <span class="n">ot</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">nobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ot</span> <span class="ow">in</span> <span class="n">BASIC_TYPES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nobj</span>

    <span class="c1"># Duplicate object a priori</span>
    <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">nobj</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="c1"># Check if object is a tuple (particular case, can not process case of general object extending tuple)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">nvals</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rfun</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">)</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">nx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">nx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">nvals</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
            <span class="c1"># Particular case of named tuples</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;_fields&#39;</span><span class="p">):</span>
                <span class="n">nobj</span> <span class="o">=</span> <span class="n">ot</span><span class="p">(</span><span class="o">*</span><span class="n">nvals</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nobj</span> <span class="o">=</span> <span class="n">ot</span><span class="p">(</span><span class="n">nvals</span><span class="p">)</span>

    <span class="c1"># Check if object is dictionary</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">nobj</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">nk</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">rfun</span><span class="p">)</span>
            <span class="n">nv</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">rfun</span><span class="p">)</span>
            <span class="n">nobj</span><span class="p">[</span><span class="n">nk</span><span class="p">]</span> <span class="o">=</span> <span class="n">nv</span>
            <span class="n">changed</span> <span class="o">|=</span> <span class="p">(</span><span class="n">nk</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">k</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">nv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">v</span><span class="p">)</span>

    <span class="c1"># Check if object is list</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">nv</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">rfun</span><span class="p">)</span>
            <span class="n">nobj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nv</span>
            <span class="n">changed</span> <span class="o">|=</span> <span class="p">(</span><span class="n">nv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">v</span><span class="p">)</span>

    <span class="c1"># Replace in attributes if any (even in objects extending basic composed types)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__dict__&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">atr</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">atr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">atr</span><span class="p">)</span>
                    <span class="n">nv</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">rfun</span><span class="p">)</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">nobj</span><span class="p">,</span> <span class="n">atr</span><span class="p">,</span> <span class="n">nv</span><span class="p">)</span>
                    <span class="n">changed</span> <span class="o">|=</span> <span class="p">(</span><span class="n">nv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">v</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="c1"># Replace in slots attributes if any (even in objects extending basic composed types)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__slots__&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">atr</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">atr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">atr</span><span class="p">)</span>
                <span class="n">nv</span> <span class="o">=</span> <span class="n">replace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">rfun</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">nobj</span><span class="p">,</span> <span class="n">atr</span><span class="p">,</span> <span class="n">nv</span><span class="p">)</span>
                <span class="n">changed</span> <span class="o">|=</span> <span class="p">(</span><span class="n">nv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">v</span><span class="p">)</span>

    <span class="c1"># Return object</span>
    <span class="k">return</span> <span class="n">nobj</span> <span class="k">if</span> <span class="n">changed</span> <span class="k">else</span> <span class="n">obj</span></div>


<div class="viewcode-block" id="assert_arg_int_interval"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.assert_arg_int_interval">[docs]</a><span class="k">def</span> <span class="nf">assert_arg_int_interval</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check that an argument is an integer in a given interval.</span>

<span class="sd">    Args:</span>
<span class="sd">        val:  Argument value</span>
<span class="sd">        mn:   Minimal possible value (included)</span>
<span class="sd">        mx:   Maximal possible value (excluded)</span>
<span class="sd">        name: Name of the parameter (optional), used in raised exception.</span>
<span class="sd">    Raises:</span>
<span class="sd">      TypeError exception if wrong argument type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">is_int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">val</span> <span class="o">&gt;=</span> <span class="n">mn</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">val</span> <span class="o">&lt;</span> <span class="n">mx</span><span class="p">),</span> \
           <span class="s2">&quot;Argument &#39;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;&#39; should be an integer in [&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mn</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;..&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mx</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span></div>


<div class="viewcode-block" id="to_string"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.to_string">[docs]</a><span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Convert a value into a string, recursively for lists and tuples.</span>

<span class="sd">    Args:</span>
<span class="sd">        val: Value to convert value</span>
<span class="sd">    Returns:</span>
<span class="sd">        String representation of the value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check tuple</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">to_string</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;,)&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">to_string</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

    <span class="c1"># Check list</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">to_string</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>

    <span class="c1"># Default</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_get_vars</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Get the list variable names of an object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if a dictionary is present</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__dict__&#39;</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__dict__&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="c1"># Check if slot is defined</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__slots__&#39;</span><span class="p">):</span>
        <span class="n">slts</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__slots__&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_array</span><span class="p">(</span><span class="n">slts</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">slts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">slts</span><span class="p">]</span>
        <span class="c1"># Go upper in the class hierarchy</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">while</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__slots__&#39;</span><span class="p">):</span>
            <span class="n">slts</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;__slots__&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_array</span><span class="p">(</span><span class="n">slts</span><span class="p">):</span>
                <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">slts</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slts</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span>
    <span class="c1"># No attributes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_equals_lists</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Utility function for equals() to check two lists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">equals</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span> <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">))</span>


<div class="viewcode-block" id="equals"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.equals">[docs]</a><span class="k">def</span> <span class="nf">equals</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check that two values are logically equal, i.e. with the same attributes with the same values, recursively.</span>

<span class="sd">    This method does not call __eq__ except on basic types, and is then proof to possible overloads of &#39;==&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">       v1: First value</span>
<span class="sd">       v2: Second value</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if both values are identical, false otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check same object (also covers some primitive types as int, float and strings, but not guarantee)</span>
    <span class="k">if</span> <span class="n">v1</span> <span class="ow">is</span> <span class="n">v2</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Check same type</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">t</span> <span class="ow">is</span> <span class="nb">type</span><span class="p">(</span><span class="n">v2</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_string</span><span class="p">(</span><span class="n">v2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">v1</span> <span class="o">==</span> <span class="n">v2</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Check basic types</span>
    <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">BASIC_TYPES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">v1</span> <span class="o">==</span> <span class="n">v2</span>

    <span class="c1"># Check list or tuple</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">_equals_lists</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>

    <span class="c1"># Check dictionary</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="c1"># Compare keys</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">v1</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">v2</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_equals_lists</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># Compare values</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">k1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">equals</span><span class="p">(</span><span class="n">v1</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">v2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">)):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Check sets</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">frozenset</span><span class="p">)):</span>
        <span class="c1"># Compare values</span>
        <span class="k">return</span> <span class="n">_equals_lists</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">v1</span><span class="p">)),</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">v2</span><span class="p">)))</span>

    <span class="c1"># Compare object attributes</span>
    <span class="n">dv1</span> <span class="o">=</span> <span class="n">_get_vars</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">_equals_lists</span><span class="p">(</span><span class="n">dv1</span><span class="p">,</span> <span class="n">_get_vars</span><span class="p">(</span><span class="n">v2</span><span class="p">)):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dv1</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">equals</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="make_directories"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.make_directories">[docs]</a><span class="k">def</span> <span class="nf">make_directories</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Ensure a directory path exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Directory path to check or create</span>
<span class="sd">    Raises:</span>
<span class="sd">        Any IO exception if directory creation is not possible</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">path</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="create_stdout_logger"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.create_stdout_logger">[docs]</a><span class="k">def</span> <span class="nf">create_stdout_logger</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create a default logger on stdout with default formatter printing time at the beginning.</span>
<span class="sd">        of the line.</span>

<span class="sd">    Args:</span>
<span class="sd">        name:  Name of the logger</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">ch</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">ch</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1">  </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logger</span></div>


<div class="viewcode-block" id="get_file_name_only"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.get_file_name_only">[docs]</a><span class="k">def</span> <span class="nf">get_file_name_only</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Get the name of a file, without directory or extension.</span>
<span class="sd">    Args:</span>
<span class="sd">        file:  File name</span>
<span class="sd">    Returns:</span>
<span class="sd">        Name of the file, without directory or extension</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="read_string_file"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.read_string_file">[docs]</a><span class="k">def</span> <span class="nf">read_string_file</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Read a file as a string.</span>
<span class="sd">    Args:</span>
<span class="sd">        file:  File name</span>
<span class="sd">    Returns:</span>
<span class="sd">        File content as a string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">str</span></div>


<div class="viewcode-block" id="write_string_file"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.write_string_file">[docs]</a><span class="k">def</span> <span class="nf">write_string_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Write a string into a file.</span>
<span class="sd">    Args:</span>
<span class="sd">        file:  File name</span>
<span class="sd">        str:   String to write</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span></div>


<div class="viewcode-block" id="format_text"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.format_text">[docs]</a><span class="k">def</span> <span class="nf">format_text</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Format a given text in multiple lines.</span>
<span class="sd">    Args:</span>
<span class="sd">        txt:  Text to format</span>
<span class="sd">        size: Line size</span>
<span class="sd">    Returns:</span>
<span class="sd">        List of lines.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sepchars</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="se">\t\n\r</span><span class="s1">&#39;</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">sepchars</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">size</span><span class="p">:</span>
        <span class="c1"># Search end of line</span>
        <span class="n">enx</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">enx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">txt</span><span class="p">[</span><span class="n">enx</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sepchars</span><span class="p">):</span>
            <span class="n">enx</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="c1"># Check no separator in the line</span>
        <span class="k">if</span> <span class="n">enx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enx</span> <span class="o">=</span> <span class="n">size</span>
        <span class="c1"># Check for a end of line in the line</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">enx</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enx</span> <span class="o">=</span> <span class="n">x</span>
        <span class="c1"># Append line</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt</span><span class="p">[:</span><span class="n">enx</span><span class="p">])</span>
        <span class="c1"># Remove line from source</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="p">[</span><span class="n">enx</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">sepchars</span><span class="p">)</span>
    <span class="c1"># Add last line</span>
    <span class="k">if</span> <span class="n">txt</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="encode_integer_big_endian_4"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.encode_integer_big_endian_4">[docs]</a><span class="k">def</span> <span class="nf">encode_integer_big_endian_4</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Encode an integer in a byte array using big endian on 4 bytes.</span>
<span class="sd">    Args:</span>
<span class="sd">        value:  Integer value to encode</span>
<span class="sd">        frame:   Target byte array</span>
<span class="sd">        start:  Write start index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">frame</span><span class="p">[</span><span class="n">start</span><span class="p">]</span>     <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
    <span class="n">frame</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
    <span class="n">frame</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span>  <span class="o">&amp;</span> <span class="mh">0xFF</span>
    <span class="n">frame</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>         <span class="o">&amp;</span> <span class="mh">0xFF</span></div>


<div class="viewcode-block" id="decode_integer_big_endian_4"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.decode_integer_big_endian_4">[docs]</a><span class="k">def</span> <span class="nf">decode_integer_big_endian_4</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Encode an integer in a byte array using big endian on 4 bytes.</span>
<span class="sd">    Args:</span>
<span class="sd">        frame:  Source byte array</span>
<span class="sd">        start:  Read start index</span>
<span class="sd">    Returns:</span>
<span class="sd">        Decoded integer value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">frame</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span></div>


<div class="viewcode-block" id="open_utf8"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.open_utf8">[docs]</a><span class="k">def</span> <span class="nf">open_utf8</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Open a stream for read or write with UTF-8 encoding.</span>

<span class="sd">    Args:</span>
<span class="sd">        file:  File to open</span>
<span class="sd">        mode:  Open mode</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">encd</span> <span class="o">=</span> <span class="s1">&#39;utf-8-sig&#39;</span> <span class="k">if</span> <span class="n">mode</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;utf-8&#39;</span>
    <span class="k">return</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encd</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="list_module_public_functions"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.list_module_public_functions">[docs]</a><span class="k">def</span> <span class="nf">list_module_public_functions</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">excepted</span><span class="o">=</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot; Build the list of all public functions of a module.</span>

<span class="sd">    Args:</span>
<span class="sd">        mod:  Module to parse</span>
<span class="sd">        excepted:  List of function names to not include. Default is none.</span>
<span class="sd">    Returns:</span>
<span class="sd">        List of public functions declared in this module</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmodule</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="n">mod</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">excepted</span><span class="p">]</span></div>


<div class="viewcode-block" id="get_module_element_from_path"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.get_module_element_from_path">[docs]</a><span class="k">def</span> <span class="nf">get_module_element_from_path</span><span class="p">(</span><span class="n">opath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Retrieve an element from a python module using its path &lt;package&gt;.&lt;module&gt;.&lt;object&gt;.</span>

<span class="sd">    This can be for example a global function or a class.</span>

<span class="sd">    Args:</span>
<span class="sd">        opath:  Object path</span>
<span class="sd">    Returns:</span>
<span class="sd">        Module object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">module</span><span class="p">,</span> <span class="n">oname</span> <span class="o">=</span> <span class="n">opath</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">oname</span><span class="p">)</span></div>


<span class="c1">#-----------------------------------------------------------------------------</span>
<span class="c1"># Checking of object types</span>
<span class="c1">#-----------------------------------------------------------------------------</span>

<span class="c1"># Determine list of types representing the different python scalar types</span>
<span class="n">BOOL_TYPES</span>    <span class="o">=</span> <span class="p">{</span><span class="nb">bool</span><span class="p">}</span>
<span class="n">INTEGER_TYPES</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">}</span>
<span class="n">FLOAT_TYPES</span>   <span class="o">=</span> <span class="p">{</span><span class="nb">float</span><span class="p">}</span>
<span class="n">STRING_TYPES</span>  <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">}</span>

<span class="c1"># Add Python2 specific unicode if any</span>
<span class="k">if</span> <span class="n">IS_PYTHON_2</span><span class="p">:</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">long</span><span class="p">)</span>
    <span class="n">STRING_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">unicode</span><span class="p">)</span>

<span class="c1"># Add numpy types if any</span>
<span class="k">if</span> <span class="n">IS_NUMPY_AVAILABLE</span><span class="p">:</span>
    <span class="n">BOOL_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
    <span class="n">BOOL_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>

    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">intc</span><span class="p">)</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span>

    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>
    <span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span>

    <span class="n">FLOAT_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
    <span class="n">FLOAT_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
    <span class="n">FLOAT_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">FLOAT_TYPES</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="c1"># Build all number type sets</span>
<span class="n">INTEGER_TYPES</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">INTEGER_TYPES</span><span class="p">)</span>
<span class="n">FLOAT_TYPES</span>   <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">FLOAT_TYPES</span><span class="p">)</span>
<span class="n">BOOL_TYPES</span>    <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">BOOL_TYPES</span><span class="p">)</span>
<span class="n">NUMBER_TYPES</span>  <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">INTEGER_TYPES</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">FLOAT_TYPES</span><span class="p">))</span>
<span class="n">STRING_TYPES</span>  <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">STRING_TYPES</span><span class="p">)</span>
<span class="n">BASIC_TYPES</span>   <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">NUMBER_TYPES</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">BOOL_TYPES</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">STRING_TYPES</span><span class="p">))</span>


<div class="viewcode-block" id="is_bool"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_bool">[docs]</a><span class="k">def</span> <span class="nf">is_bool</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check if a value is a boolean, including numpy variants if any.</span>

<span class="sd">    Args:</span>
<span class="sd">        val: Value to check</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if value is a boolean.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">BOOL_TYPES</span></div>

<span class="k">if</span> <span class="n">IS_NUMPY_AVAILABLE</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">is_int</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is an integer, including numpy variants if any.</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is an integer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">INTEGER_TYPES</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">is_float</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is a float, including numpy variants if any.</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is a float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">FLOAT_TYPES</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">is_number</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is a number, including numpy variants if any.</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is a number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">NUMBER_TYPES</span><span class="p">)</span> <span class="ow">or</span> <span class="n">numpy</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">is_array</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is an array (list or tuple).</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is an array (list or tuple)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">or</span> \
               <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

<div class="viewcode-block" id="is_int"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_int">[docs]</a>    <span class="k">def</span> <span class="nf">is_int</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is an integer, including numpy variants if any.</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is an integer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">INTEGER_TYPES</span></div>


<div class="viewcode-block" id="is_float"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_float">[docs]</a>    <span class="k">def</span> <span class="nf">is_float</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is a float, including numpy variants if any.</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is a float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">FLOAT_TYPES</span></div>


<div class="viewcode-block" id="is_number"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_number">[docs]</a>    <span class="k">def</span> <span class="nf">is_number</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is a number, including numpy variants if any.</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is a number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">NUMBER_TYPES</span></div>


<div class="viewcode-block" id="is_array"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_array">[docs]</a>    <span class="k">def</span> <span class="nf">is_array</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is an array (list or tuple).</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is an array (list or tuple)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span></div>


<span class="k">if</span> <span class="n">IS_PANDA_AVAILABLE</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">is_panda_series</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is a panda serie.</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if value is an panda serie</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">PandaSeries</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

<div class="viewcode-block" id="is_panda_series"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_panda_series">[docs]</a>    <span class="k">def</span> <span class="nf">is_panda_series</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check if a value is a panda serie.</span>

<span class="sd">        Args:</span>
<span class="sd">            val: Value to check</span>
<span class="sd">        Returns:</span>
<span class="sd">            False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="is_int_value"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_int_value">[docs]</a><span class="k">def</span> <span class="nf">is_int_value</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">xv</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check if a value is an integer equal to an expected value.</span>
<span class="sd">    Allows to check integer value equality even if == operator is overloaded</span>

<span class="sd">    Args:</span>
<span class="sd">        val:  Value to check</span>
<span class="sd">        xv:   Expected integer value</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if value is an integer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">xv</span><span class="p">)</span></div>


<div class="viewcode-block" id="is_string"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_string">[docs]</a><span class="k">def</span> <span class="nf">is_string</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check if a value is a string or a variant.</span>

<span class="sd">    Args:</span>
<span class="sd">        val: Value to check</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if value is a string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">STRING_TYPES</span></div>


<div class="viewcode-block" id="is_iterable"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_iterable">[docs]</a><span class="k">def</span> <span class="nf">is_iterable</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check if a value is iterable, but not a string.</span>

<span class="sd">    Args:</span>
<span class="sd">        val: Value to check</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if value is iterable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_string</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div>


<div class="viewcode-block" id="is_int_array"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_int_array">[docs]</a><span class="k">def</span> <span class="nf">is_int_array</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check that a value is an array of integers.</span>

<span class="sd">    Args:</span>
<span class="sd">        val: Value to check</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if value is an array where all elements are integers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">is_array</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="n">is_int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">))</span></div>


<div class="viewcode-block" id="is_array_of_type"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_array_of_type">[docs]</a><span class="k">def</span> <span class="nf">is_array_of_type</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">typ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check that a value is an array with all elements instances of a given type.</span>

<span class="sd">    Args:</span>
<span class="sd">        val: Value to check</span>
<span class="sd">        typ: Expected element type</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if value is an array with all elements with expected type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">is_array</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">typ</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">val</span><span class="p">))</span></div>


<div class="viewcode-block" id="is_in"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_in">[docs]</a><span class="k">def</span> <span class="nf">is_in</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">lvals</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Replace the standard &#39;in&#39; operator but uses &#39;is&#39; to check membership.</span>

<span class="sd">    This method is mandatory if element to check overloads operator &#39;==&#39;.</span>

<span class="sd">    Args:</span>
<span class="sd">        val:   Value to check</span>
<span class="sd">        lvals: List of candidate values</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if value is in the list of values (presence checked with &#39;is&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">lvals</span><span class="p">)</span></div>


<span class="c1">#-----------------------------------------------------------------------------</span>
<span class="c1"># String conversion functions</span>
<span class="c1">#-----------------------------------------------------------------------------</span>

<span class="c1"># Dictionary of special characters conversion</span>
<span class="n">_FROM_SPECIAL_CHARS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\f</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">}</span>

<span class="c1"># Dictionary of special characters conversion</span>
<span class="n">_TO_SPECIAL_CHARS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">t&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">r&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\f</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">f&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\b</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">b&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\\&quot;</span><span class="s2">&quot;</span><span class="p">}</span>

<span class="c1"># Set of symbol characters</span>
<span class="n">_SYMBOL_CHARS</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="s2">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_&quot;</span><span class="p">)</span>

<span class="c1"># Set of digit characters</span>
<span class="n">_DIGIT_CHARS</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="s2">&quot;0123456789&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="is_symbol_char"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_symbol_char">[docs]</a><span class="k">def</span> <span class="nf">is_symbol_char</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check whether a character can be used in a symbol.</span>

<span class="sd">    Args:</span>
<span class="sd">        c: Character</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if character in 0..9, a..z, A..Z, _ or .</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># return ((c &gt;= &#39;a&#39;) and (c &lt;= &#39;z&#39;)) or ((c &gt;= &#39;A&#39;) and (c &lt;= &#39;Z&#39;)) or ((c &gt;= &#39;0&#39;) and (c &lt;= &#39;9&#39;)) or (c == &#39;_&#39;)</span>
    <span class="c1"># Following is 25% faster</span>
    <span class="k">return</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">_SYMBOL_CHARS</span></div>


<div class="viewcode-block" id="to_printable_string"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.to_printable_string">[docs]</a><span class="k">def</span> <span class="nf">to_printable_string</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Build a printable string from raw string (add escape sequences and quotes if necessary).</span>

<span class="sd">    Args:</span>
<span class="sd">        id: Identifier string</span>
<span class="sd">    Returns:</span>
<span class="sd">        Unicode CPO identifier string, including double quotes and escape sequences if needed if not only chars and integers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check empty string</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;&quot;&quot;&#39;</span>
    <span class="c1"># Check if string can be used as it is</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">all</span><span class="p">((</span><span class="n">c</span> <span class="ow">in</span> <span class="n">_SYMBOL_CHARS</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">id</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">_DIGIT_CHARS</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">make_unicode</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="c1"># Build result string</span>
    <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_TO_SPECIAL_CHARS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">id</span><span class="p">)</span> <span class="o">+</span> <span class="sa">u</span><span class="s1">&#39;&quot;&#39;</span></div>


<span class="k">def</span> <span class="nf">to_internal_string</span><span class="p">(</span><span class="n">strg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Convert a string (without enclosing quotes) into internal string (interpret escape sequences).</span>

<span class="sd">    Args:</span>
<span class="sd">        strg: String to convert</span>
<span class="sd">    Returns:</span>
<span class="sd">        Raw string corresponding to source</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">beg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">strg</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">beg</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">strg</span><span class="p">[</span><span class="n">beg</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">beg</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">_FROM_SPECIAL_CHARS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">strg</span><span class="p">[</span><span class="n">beg</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Unknown special character &#39;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">strg</span><span class="p">[</span><span class="n">beg</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">beg</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>


<div class="viewcode-block" id="to_internal_string"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.to_internal_string">[docs]</a><span class="k">def</span> <span class="nf">to_internal_string</span><span class="p">(</span><span class="n">strg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Convert a string (without enclosing quotes) into internal string (interpret escape sequences).</span>

<span class="sd">    Args:</span>
<span class="sd">        strg: String to convert</span>
<span class="sd">    Returns:</span>
<span class="sd">        Raw string corresponding to source</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">slen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">strg</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">slen</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">strg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">_FROM_SPECIAL_CHARS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">strg</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s2">&quot;Unknown special character &#39;</span><span class="se">\\</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">strg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>


<span class="k">if</span> <span class="n">IS_PYTHON_2</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">make_unicode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Convert a string in unicode.</span>

<span class="sd">        Args:</span>
<span class="sd">            s: String to convert</span>
<span class="sd">        Returns:</span>
<span class="sd">            String in unicode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">s</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="n">unicode</span> <span class="k">else</span> <span class="n">unicode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
<div class="viewcode-block" id="make_unicode"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.make_unicode">[docs]</a>    <span class="k">def</span> <span class="nf">make_unicode</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Convert a string in unicode.</span>

<span class="sd">        Args:</span>
<span class="sd">            s: String to convert</span>
<span class="sd">        Returns:</span>
<span class="sd">            String in unicode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="int_to_base"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.int_to_base">[docs]</a><span class="k">def</span> <span class="nf">int_to_base</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">bdgts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Convert an integer into a string with a given base.</span>

<span class="sd">    Args:</span>
<span class="sd">        val:   Integer value to convert</span>
<span class="sd">        bdgts: List of base digits</span>
<span class="sd">    Returns:</span>
<span class="sd">        String corresponding to the integer</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check zero</span>
    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bdgts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Check negative number</span>
    <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">isneg</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">val</span> <span class="o">=</span> <span class="o">-</span><span class="n">val</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">isneg</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Fill list of digits</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">blen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdgts</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bdgts</span><span class="p">[</span><span class="n">val</span> <span class="o">%</span> <span class="n">blen</span><span class="p">])</span>
        <span class="n">val</span> <span class="o">//=</span> <span class="n">blen</span>
    <span class="c1"># Add negative sign if necessary</span>
    <span class="k">if</span> <span class="n">isneg</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="c1"># Return</span>
    <span class="n">res</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>


<div class="viewcode-block" id="is_exe_file"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.is_exe_file">[docs]</a><span class="k">def</span> <span class="nf">is_exe_file</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check that a file exists and is executable.</span>

<span class="sd">    Args:</span>
<span class="sd">        f:  File name</span>
<span class="sd">    Returns:</span>
<span class="sd">        True if file exists and is executable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">X_OK</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_system_path"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.get_system_path">[docs]</a><span class="k">def</span> <span class="nf">get_system_path</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Get the system path as a list of files</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of names in the system path</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;PATH&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">pathsep</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[]</span></div>



<div class="viewcode-block" id="search_exec_file"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.search_exec_file">[docs]</a><span class="k">def</span> <span class="nf">search_exec_file</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Search the first occurrence of an executable file in a given path.</span>

<span class="sd">    Args:</span>
<span class="sd">        f:    Executable file name</span>
<span class="sd">        path: Path where search the file</span>
<span class="sd">    Returns:</span>
<span class="sd">        Full path of the first executable file found, None if not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if given file is directly executable</span>
    <span class="k">if</span> <span class="n">is_exe_file</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span>

    <span class="c1"># Search first executable in the path</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_exe_file</span><span class="p">(</span><span class="n">nf</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">nf</span>
    <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="parse_json_string"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.parse_json_string">[docs]</a><span class="k">def</span> <span class="nf">parse_json_string</span><span class="p">(</span><span class="n">jstr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Parse a JSON string.</span>

<span class="sd">    Args:</span>
<span class="sd">        jstr: String containing JSON document</span>
<span class="sd">    Returns:</span>
<span class="sd">        Python representation of JSON document</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">jstr</span><span class="p">,</span> <span class="n">parse_constant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="encode_csv_string"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.encode_csv_string">[docs]</a><span class="k">def</span> <span class="nf">encode_csv_string</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Encode a string to be used in CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        str:  String to encode</span>
<span class="sd">    Returns:</span>
<span class="sd">        Encoded string, including starting and ending double quote</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&quot;&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>


<div class="viewcode-block" id="compare_natural"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.compare_natural">[docs]</a><span class="k">def</span> <span class="nf">compare_natural</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Compare two strings in natural order (for numbers that are inside).</span>

<span class="sd">    Args:</span>
<span class="sd">        s1:  First string</span>
<span class="sd">        s2:  Second string</span>
<span class="sd">    Returns:</span>
<span class="sd">        integer &lt;0 if s1 &lt; s2, 0 if s1 == s2, &gt;0 if s1 &gt; s2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check null strings</span>
    <span class="k">if</span> <span class="n">s1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">s2</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">s2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>

    <span class="c1"># Skip all identical characters</span>
    <span class="n">len1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
    <span class="n">len2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len2</span> <span class="ow">and</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Check end of string</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">len1</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="n">len2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">len1</span> <span class="o">-</span> <span class="n">len2</span>

    <span class="c1"># Check digit in first string</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">c1</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="c1"># Check digit in first string only</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">c2</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s1</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>

        <span class="c1"># Scan all integer digits</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">x1</span> <span class="o">&lt;</span> <span class="n">len1</span> <span class="ow">and</span> <span class="n">s1</span><span class="p">[</span><span class="n">x1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="n">x1</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">x2</span> <span class="o">&lt;</span> <span class="n">len2</span> <span class="ow">and</span> <span class="n">s2</span><span class="p">[</span><span class="n">x2</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="n">x2</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Longer integer wins, first digit otherwise</span>
        <span class="k">return</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span> <span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span> <span class="k">else</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span>

    <span class="c1"># Check digit in second string only</span>
    <span class="k">if</span> <span class="n">c2</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">s2</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>

    <span class="c1"># No digits</span>
    <span class="k">return</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_module_version"><a class="viewcode-back" href="../../../docplex.cp.utils.py.html#docplex.cp.utils.get_module_version">[docs]</a><span class="k">def</span> <span class="nf">get_module_version</span><span class="p">(</span><span class="n">mname</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Get the version of a Python module</span>

<span class="sd">    Args:</span>
<span class="sd">        mname:  Module name</span>
<span class="sd">    Returns:</span>
<span class="sd">        Version of the module, None if not installed, &quot;Unknown&quot; if not set in the module</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">mname</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">__version__</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Unknown&quot;</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<span class="c1">#-----------------------------------------------------------------------------</span>
<span class="c1"># Zip iterator functions to scan lists simultaneously</span>
<span class="c1">#-----------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">itertools</span>
<span class="k">if</span> <span class="n">IS_PYTHON_2</span><span class="p">:</span>
    <span class="nb">zip</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">izip</span>
    <span class="n">zip_longest</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">izip_longest</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># For Python 3.</span>
    <span class="nb">zip</span> <span class="o">=</span> <span class="nb">zip</span>
    <span class="n">zip_longest</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">zip_longest</span>


<span class="c1">#-----------------------------------------------------------------------------</span>
<span class="c1"># Reload function</span>
<span class="c1">#-----------------------------------------------------------------------------</span>

<span class="k">if</span> <span class="n">IS_PYTHON_2</span><span class="p">:</span>
    <span class="k">pass</span> <span class="c1"># reload is builtin</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span>  <span class="o">&lt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">imp</span>
        <span class="n">reload</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">reload</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">importlib</span>
        <span class="n">reload</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">reload</span>


<span class="c1">#-----------------------------------------------------------------------------</span>
<span class="c1"># Retrieve builtin functions that are overwritten</span>
<span class="c1">#-----------------------------------------------------------------------------</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">__builtin__</span> <span class="k">as</span> <span class="nn">builtin</span>  <span class="c1"># Python 2</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">builtins</span> <span class="k">as</span> <span class="nn">builtin</span>     <span class="c1"># Python 3</span>

<span class="n">builtin_min</span>   <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">min</span>
<span class="n">builtin_max</span>   <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">max</span>
<span class="n">builtin_sum</span>   <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">sum</span>
<span class="n">builtin_abs</span>   <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">abs</span>
<span class="n">builtin_range</span> <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">range</span>
<span class="n">builtin_all</span>   <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">all</span>
<span class="n">builtin_any</span>   <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">any</span>


<span class="c1">#-----------------------------------------------------------------------------</span>
<span class="c1"># Range iterator</span>
<span class="c1">#-----------------------------------------------------------------------------</span>

<span class="k">if</span> <span class="n">IS_PYTHON_2</span><span class="p">:</span>
    <span class="n">xrange</span> <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">xrange</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">xrange</span> <span class="o">=</span> <span class="n">builtin</span><span class="o">.</span><span class="n">range</span>


<span class="c1">#-----------------------------------------------------------------------------</span>
<span class="c1"># Set warning filter to default (print warnings)</span>
<span class="c1">#-----------------------------------------------------------------------------</span>

<span class="c1"># import warnings</span>
<span class="c1"># warnings.simplefilter(&quot;default&quot;, DeprecationWarning)</span>
<span class="c1"># warnings.simplefilter(&quot;default&quot;, PendingDeprecationWarning)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DOcplex.CP: Constraint Programming Modeling for Python V2.18 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, IBM.
    </div>
  </body>
</html>